['JP 5973106 B1 2016.8.23(57)
【特許請求の範囲】
【請求項１】第１蓄電部と、前記第１蓄電部が充放電する電流の値である第１電流値を検出する第１センサを有する第１蓄電モジュールと、第２蓄電部と、前記第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、前記第１蓄電部、前記第２蓄電部と、前記第１蓄電部と前記第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路と、前記充放電回路を制御する制御部を有する回路モジュールを含み、前記制御部は、 10前記駆動部に対する前記第１蓄電部および前記第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を取得し、前記第１蓄電部と前記駆動部の間の充放電における、前記第１電流値と前記第３電流値を比較する第１操作と、前記第２蓄電部と前記駆動部の間の充放電における、前記第２電流値と前記第３電流値を比較する第２操作との少なくとも一方と、前記第２蓄電部と前記駆動部に対する前記第１蓄電部の同時放電における、前記第１電流値と前記第２電流値、前記第１電流値と前記第３電流値のそれぞれを比較する第３操作を行い、前記第１操作と前記第２操作の少なくとも一方と、前記第３操作によって前記第１センサ、前記第２センサおよび前記第３電流値を検出する第３センサの少なくとも１つの状態 20(2) JP 5973106 B1 2016.8.23を判定することを特徴とする電源装置。
【請求項２】前記制御部は、前記第３操作においては、前記第１蓄電部が前記駆動部に対する要求電力に依存せずに一定電力を出力し、前記第２蓄電部が前記一定電力と前記要求電力の差分で充電されるよう前記充放電回路を制御する請求項１に記載の電源装置。
【請求項３】前記第３操作における前記第１センサは、前記一定電力を検出し、前記第３操作における前記制御部は、前記第１電流値のうち前記要求電力に相当する値 10と前記第３電流値、前記第１電流値のうち前記一定電力と前記要求電力の差分に相当する値と前記第２電流値のそれぞれを比較する請求項２に記載の電源装置。
【請求項４】前記制御部は、前記第２蓄電部の充電率を取得し、前記第２蓄電部の充電率に基づいて前記一定電力を設定する請求項２または３に記載の電源装置。
【請求項５】前記制御部は、前記第２蓄電部の充電率が小さいほど前記一定電力が大きくなるように設定する 20請求項２から４のいずれか１項に記載の電源装置。
【請求項６】前記制御部は、前記第１操作、前記第２操作および前記３操作においては、比較される電流値が、等価又は相関関係を有するか否かを判定する請求項１から５のいずれか１項に記載の電源装置。
【請求項７】前記相関関係は、電流値が比較される複数のセンサの間における前記充放電回路の昇降圧率に基づく請求項６に記載の電源装置。
【請求項８】 30前記第２蓄電部は、前記第１蓄電部と比して、エネルギー密度が劣り、出力密度が優れる請求項１から７のいずれか１項に記載の電源装置。
【請求項９】前記第１蓄電部は、前記第２蓄電部と比して、電池容量が大きい請求項１から８のいずれか１項に記載の電源装置。
【請求項１０】請求項１から９のいずれか１項に記載の電源装置を有する輸送機器。
【請求項１１】第１蓄電部と、前記第１蓄電部が充放電する電流の値である第１電流値を検出する第１ 40センサを有する第１蓄電モジュールと、第２蓄電部と、前記第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、前記第１蓄電部、前記第２蓄電部と、前記第１蓄電部と前記第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路とを備える電源装置において、前記第１センサ、前記第２センサ、および、前記駆動部に対する前記第１蓄電部および前記第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を検出する第３センサの少なくとも１つの状態を判定する方法であって、前記第１蓄電部と前記駆動部の間の充放電における、前記第１電流値と前記第３電流値を比較する第１操作と、前記第２蓄電部と前記駆動部の間の充放電における、前記第２電 50(3) JP 5973106 B1 2016.8.23流値と前記第３電流値を比較する第２操作との少なくとも一方を行うステップと、前記第２蓄電部と前記駆動部に対する前記第１蓄電部の同時放電における、前記第１電流値と前記第２電流値、前記第１電流値と前記第３電流値のそれぞれを比較する第３操作を行うステップと、前記第１操作と前記第２操作の少なくとも一方と、前記第３操作によって前記第１センサ、前記第２センサおよび前記第３電流値を検出する第３センサの少なくとも１つの状態を判定するステップとを含む判定方法。
【請求項１２】第１蓄電部と、前記第１蓄電部が充放電する電流の値である第１電流値を検出する第１ 10センサを有する第１蓄電モジュールと、第２蓄電部と、前記第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、前記第１蓄電部、前記第２蓄電部と、前記第１蓄電部と前記第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路とを含む電源装置において、前記第１センサ、前記第２センサ、および、前記駆動部に対する前記第１蓄電部および前記第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を検出する第３センサの少なくとも１つの状態を判定するためのプログラムであって、前記第１蓄電部と前記駆動部の間の充放電における、前記第１電流値と前記第３電流値 20を比較する第１操作と、前記第２蓄電部と前記駆動部の間の充放電における、前記第２電流値と前記第３電流値を比較する第２操作との少なくとも一方を行うステップと、前記第２蓄電部と前記駆動部に対する前記第１蓄電部の同時放電における、前記第１電流値と前記第２電流値、前記第１電流値と前記第３電流値のそれぞれを比較する第３操作を行うステップと、前記第１操作と前記第２操作の少なくとも一方と、前記第３操作によって前記第１センサ、前記第２センサおよび前記第３電流値を検出する第３センサの少なくとも１つの状態を判定するステップとをコンピュータに実行させるためのプログラム。
【発明の詳細な説明】 30
【技術分野】
【０００１】本発明は、電源装置、該電源装置を有する輸送機器、電流値を検出するセンサの状態を判定する判定方法、および該状態を判定するためのプログラムに関する。
【背景技術】
【０００２】バッテリ側の電流センサの仮故障が検知されたら、コンバータが一定電力を出力するように制御し、その際のバッテリ側の電流センサとリアクトル側の電流センサを比較して、バッテリ側の電流センサの故障を確定する技術が知られている。［先行技術文献］ 40［特許文献］［特許文献１］特開２０１０−０５７３４２号公報
【発明の概要】
【発明が解決しようとする課題】
【０００３】複数の蓄電部のそれぞれの電流センサおよび駆動部側の電流センサの状態を効率的に判定することができないという課題があった。
【課題を解決するための手段】
【０００４】本発明の第１の態様における電源装置は、第１蓄電部と、第１蓄電部が充放電する電流 50(4) JP 5973106 B1 2016.8.23の値である第１電流値を検出する第１センサを有する第１蓄電モジュールと、第２蓄電部と、第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、第１蓄電部、第２蓄電部と、第１蓄電部と第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路と、充放電回路を制御する制御部を有する回路モジュールを含み、制御部は、駆動部に対する第１蓄電部および第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を取得し、第１蓄電部と駆動部の間の充放電における、第１電流値と第３電流値を比較する第１操作と、第２蓄電部と駆動部の間の充放電における、第２電流値と第３電流値を比較する第２操作との少なくとも一方と、第２蓄電部と駆動部に対する第１蓄電部の同時放電における、第１電流値と第２電流値、第１電流値と第３電流値のそれぞれを比較する第３操作を行い、第１ 10操作と第２操作の少なくとも一方と、第３操作によって第１センサ、第２センサおよび第３電流値を検出する第３センサの少なくとも１つの状態を判定する。
【０００５】本発明の第２の態様における輸送機器は、上記の電源装置を有する。
【０００６】本発明の第３の態様における方法は、第１蓄電部と、第１蓄電部が充放電する電流の値である第１電流値を検出する第１センサを有する第１蓄電モジュールと、第２蓄電部と、第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、第１蓄電部、第２蓄電部と、第１蓄電部と第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路とを備える電源装置にお 20いて、第１センサ、第２センサ、および、駆動部に対する第１蓄電部および第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を検出する第３センサの少なくとも１つの状態を判定する方法であって、第１蓄電部と駆動部の間の充放電における、第１電流値と第３電流値を比較する第１操作と、第２蓄電部と駆動部の間の充放電における、第２電流値と第３電流値を比較する第２操作との少なくとも一方を行うステップと、第２蓄電部と駆動部に対する第１蓄電部の同時放電における、第１電流値と第２電流値、第１電流値と第３電流値のそれぞれを比較する第３操作を行うステップと、第１操作と第２操作の少なくとも一方と、第３操作によって第１センサ、第２センサおよび第３電流値を検出する第３センサの少なくとも１つの状態を判定するステップとを含む。
【０００７】 30本発明の第４の態様におけるプログラムは、第１蓄電部と、第１蓄電部が充放電する電流の値である第１電流値を検出する第１センサを有する第１蓄電モジュールと、第２蓄電部と、第２蓄電部が充放電する電流の値である第２電流値を検出する第２センサを有する第２蓄電モジュールと、第１蓄電部、第２蓄電部と、第１蓄電部と第２蓄電部の少なくとも一方の電力を用いて駆動される駆動部の間の充放電を担う充放電回路とを含む電源装置において、第１センサ、第２センサ、および、駆動部に対する第１蓄電部および第２蓄電部の少なくとも一方の充放電の電流の値である第３電流値を検出する第３センサの少なくとも１つの状態を判定するためのプログラムであって、第１蓄電部と駆動部の間の充放電における、第１電流値と第３電流値を比較する第１操作と、第２蓄電部と駆動部の間の充放電における、第２電流値と第３電流値を比較する第２操作との少なくとも一方を行うス 40テップと、第２蓄電部と駆動部に対する第１蓄電部の同時放電における、第１電流値と第２電流値、第１電流値と第３電流値のそれぞれを比較する第３操作を行うステップと、第１操作と第２操作の少なくとも一方と、第３操作によって第１センサ、第２センサおよび第３電流値を検出する第３センサの少なくとも１つの状態を判定するステップとをコンピュータに実行させる。
【０００８】なお、上記の発明の概要は、本発明の必要な特徴の全てを列挙したものではない。また、これらの特徴群のサブコンビネーションもまた、発明となりうる。
【図面の簡単な説明】
【０００９】 50(5) JP 5973106 B1 2016.8.23
【図１】本実施形態に係る輸送機器のブロック図である。
【図２】単一の蓄電池を用いた場合による電力出力と、２つの蓄電池を用いた場合による電力出力とを比較するための図である。
【図３】第１蓄電池１１１と第２蓄電池１２１との間でのみ電荷の授受が行われている状態を示す図である。
【図４】第１蓄電池１１１とＰＤＵ１４１との間でのみ電荷の授受が行われている状態を示す図である。
【図５】第２蓄電池１２１とＰＤＵ１４１との間でのみ電荷の授受が行われている状態を示す図である。
【図６】第１蓄電池１１１、第２蓄電池１２１およびＰＤＵ１４１の間で電荷の授受が行 10われている状態を示す図である。
【図７】各電流センサの状態と、第１蓄電池１１１、各電流センサの電流値の判定結果の関係を表すテーブルを示す図である。
【図８】強制放電パターンを含む輸送機器１０の駆動オペレーションの一例を示す図である。
【図９】要求電力に応じて第１蓄電池１１１および第２蓄電池１２１のそれぞれにおける電力の入出力を、第２蓄電池１２１のＳＯＣ毎に示す図である。
【図１０】第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の状態を判定するまでのフロー図である。
【発明を実施するための形態】 20
【００１０】以下、発明の実施の形態を通じて本発明を説明するが、以下の実施形態は特許請求の範囲にかかる発明を限定するものではない。また、実施形態の中で説明されている特徴の組み合わせの全てが発明の解決手段に必須であるとは限らない。
【００１１】図１は、本実施形態に係る輸送機器１０のブロック図である。本実施形態に係る輸送機器は、例えば電動自動車である。以下においては、本実施形態に係る蓄電装置１００が電動自動車に搭載されて利用される場合を想定して説明する。なお、蓄電装置１００は、電源装置の一例である。
【００１２】 30輸送機器１０は、搭載された蓄電装置１００から供給される駆動電力を、駆動モジュール１４０が備えるパワードライブユニットであるＰＤＵ１４１が受け、ＰＤＵ１４１がモータジェネレータ（ＭＧ１４４）を回転駆動させることにより走行する。
【００１３】ＰＤＵ１４１は、蓄電装置１００と、主正母線ＭＰＬおよび主負母線ＭＮＬとで接続されている。平滑コンデンサＣは、主正母線ＭＰＬと主負母線ＭＮＬとの間に接続されており、導通する電力の高周波成分を低減する。駆動モジュール１４０が備える第３電圧センサ１４２は、主正母線ＭＰＬと主負母線ＭＮＬとの間の電圧Ｖｈを検出し、検出された電圧Ｖｈは、ＰＤＵ１４１の制御に利用される。駆動モジュール１４０が備えるＰＤＵ側電流センサ１４３は、ＰＤＵ１４１に対して入出力される電流Ｉ を検出し、検出値をＰＤ 40３Ｕ１４１へ出力する。このように、ＰＤＵ側電流センサ１４３は、ＭＧ１４４が充放電する電流の値である第３電流値を検出する。ＰＤＵ側電流センサ１４３による電流の検出値は、ＰＤＵ１４１の制御に利用される。
【００１４】ＰＤＵ１４１は、主正母線ＭＰＬおよび主負母線ＭＮＬから供給される駆動電力（直流電力）を交流電力に変換してＭＧ１４４へ出力する。ＭＧ１４４は、例えば、三相交流回転電機を含む。ＭＧ１４４は、動力伝達機構および駆動軸を介して車輪を回転させる。また、ＰＤＵ１４１は、車輪の減速時においてＭＧ１４４が発電する交流電力を直流電力に変換し、回生電力として主正母線ＭＰＬおよび主負母線ＭＮＬへ出力する。
【００１５】 50(6) JP 5973106 B1 2016.8.23蓄電装置１００が備える第１蓄電池１１１および第２蓄電池１２１は、ＭＧ１４４が発電する回生電力と、外部電源１５３からの外部電力とによって充電される。また、第１蓄電池１１１と第２蓄電池１２１の少なくとも一方の電力は、ＭＧ１４４を駆動する駆動電力としてＰＤＵ１４１に供給される。
【００１６】充電コンバータ１５１は、主正母線ＭＰＬおよび主負母線ＭＮＬと受電部１５２との間に設けられる。そして、充電コンバータ１５１は、受電部１５２を介して外部電源１５３（例えば家庭用ＡＣ電源）から供給される交流電力を直流電力に変換して主正母線ＭＰＬおよび主負母線ＭＮＬへ出力する。受電部１５２は、外部電源１５３から供給される交流電力を入力するための入力端子である。なお、充電コンバータ１５１は、主正母線ＭＰＬ 10および主負母線ＭＮＬに代えて、あるいは追加して、正極線ＰＬ１および負極線ＮＬ１に接続されていても良く、正極線ＰＬ２および負極線ＮＬ２に接続されていても良い。
【００１７】蓄電装置１００は、第１蓄電モジュール１０１、第２蓄電モジュール１０２および充放電回路モジュール１０３を含む。第１蓄電モジュール１０１は、第１蓄電池１１１、第１電圧センサ１１２、第１電流センサ１１３、および第１スイッチ１１４を有する。第２蓄電モジュール１０２は、第１蓄電モジュール１０１と同様の構成であり、第２蓄電池１２１、第２電圧センサ１２２、第２電流センサ１２３、および第２スイッチ１２４を有する。充放電回路モジュール１０３は、第１蓄電池１１１と第２蓄電池１２１の間の充放電を担う。充放電回路モジュール１０３は、制御部としての電池ＥＣＵ１３０と、充放電回路 20として機能しうる第１ＶＣＵ１３１、第２ＶＣＵ１３２、および第３スイッチ１３３とを有する。
【００１８】本実施形態において第１蓄電部として機能する第１蓄電池１１１、および第２蓄電部として機能する第２蓄電池１２１は、充放電可能な直流電源であり、たとえば、リチウムイオン電池やニッケル水素電池、ナトリウムイオン電池、リチウム硫黄電池などの二次電池を含む。他にも、コンデンサ、キャパシタなどの充放電が可能な素子であっても良い。ただし、第１蓄電池１１１と第２蓄電池１２１は、互いに特性が異なる電池である。具体的には、第１蓄電池１１１は第２蓄電池１２１より単位質量あたりの貯蔵電力である質量エネルギー密度が大きい、いわゆる高容量型バッテリである。一方、第２蓄電池１２１は第 30１蓄電池１１１より単位質量あたりの出力電力である質量出力密度が大きい、いわゆる高出力型バッテリである。第２蓄電池１２１は第１蓄電池１１１より単位容積あたりの出力電力である容積出力密度が大きくて良く、第１蓄電池１１１は第２蓄電池１２１より単位容積あたりの貯蔵電力である容積エネルギー密度が大きくて良い。このように、単位質量または単位容積あたりに第２蓄電池１２１から取り出せる電力は、単位質量または単位容積あたりに第１蓄電池１１１から取り出せる電力より大きい。一方、単位質量または単位容積あたりに第１蓄電池１１１が貯蔵できる電力は、単位質量または単位容積あたりに第２蓄電池１２１が貯蔵できる電力より大きい。このように、第２蓄電池１２１は、第１蓄電池１１１と比して、エネルギー密度が劣り、出力密度が優れる。また、第１蓄電池１１１は、第２蓄電池１２１と比して、大きい電池容量を有する。 40
【００１９】第１蓄電池１１１は、正極線ＰＬ１および負極線ＮＬ１を介して第１ＶＣＵ１３１に接続されている。第１電圧センサ１１２は、正極線ＰＬ１と負極線ＮＬ１との間の電圧すなわち第１蓄電池１１１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。１第１電流センサ１１３は、第１蓄電池１１１に対して入出力される電流Ｉ を検出し、そ１の検出値を電池ＥＣＵ１３０へ出力する。このように、第１電流センサ１１３は、第１蓄電池１１１が充放電する電流の値である第１電流値を検出する。
【００２０】第１スイッチ１１４は、正極線ＰＬ１と負極線ＮＬ１の電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。 50１(7) JP 5973106 B1 2016.8.23
【００２１】第２蓄電池１２１は、正極線ＰＬ２および負極線ＮＬ２を介して第２ＶＣＵ１３２に接続されている。第２電圧センサ１２２は、正極線ＰＬ２と負極線ＮＬ２との間の電圧すなわち第２蓄電池１２１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。２第２電流センサ１２３は、第２蓄電池１２１に対して入出力される電流Ｉ を検出し、そ２の検出値を電池ＥＣＵ１３０へ出力する。このように、第２電流センサ１２３は、第２蓄電池１２１が充放電する電流の値である第２電流値を検出する。
【００２２】第２スイッチ１２４は、正極線ＰＬ２と負極線ＮＬ２の電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。 10２
【００２３】なお、第１電流センサ１１３および第２電流センサ１２３は、それぞれ対応する蓄電池から出力される電流（放電電流）を正値として検出し、入力される電流（充電電流および回生電流）を負値として検出する。図１では、それぞれ正極線の電流を検出する構成として示すが、負極線の電流を検出するように構成しても良い。
【００２４】第１ＶＣＵ１３１は、正極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ を受けて、正１極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。第２ＶＣＵ１３２は、正極線ＰＬ２および負極線ＮＬ２と、接続正極線Ｂ 20ＰＬおよび接続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ２を受けて、正極線ＰＬ２および負極線ＮＬ２と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。
【００２５】接続正極線ＢＰＬは、主正母線ＭＰＬと接続され、接続負極線ＢＮＬは、主負母線ＭＮＬに接続される。その接続部には、第３スイッチ１３３が設けられている。第３スイッチ１３３は、接続正極線ＢＰＬと主正母線ＭＰＬ、および接続負極線ＢＮＬと主負母線ＭＮＬの電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受け３て、開状態と閉状態を切り替える。
【００２６】 30以上の構成においては、第１スイッチ１１４と第３スイッチ１３３を閉状態、第２スイッチ１２４を開状態とした場合には、第１蓄電池１１１の電力がＰＤＵ１４１へ供給される。また、第２スイッチ１２４と第３スイッチ１３３を閉状態、第１スイッチ１１４を開状態とした場合には、第２蓄電池１２１の電力がＰＤＵ１４１へ供給される。また、第１スイッチ１１４と第２スイッチ１２４と第３スイッチ１３３を閉状態とした場合には、第１蓄電池１１１の電力と第２蓄電池１２１の電力が共にＰＤＵ１４１へ供給される。ただし、第１蓄電池１１１の電力と第２蓄電池１２１の電力を共にＰＤＵ１４１へ供給する場合には、供給電圧が同じになるように、第１ＶＣＵ１３１および第２ＶＣＵ１３２によって電圧変換が成される。なお、ＰＤＵ１４１から回生電力が供給される場合、または外部電源１５３から外部電力が供給される場合には、電力の流れは上記の各場合における逆向 40きとなる。
【００２７】また、本実施形態においては、それぞれの蓄電池に電圧変換ユニットであるＶＣＵを設けるいわゆる２ＶＣＵ方式を採用するが、一方の蓄電池の出力電圧に対して他方の蓄電池の出力電圧を調整する観点からは、いずれかに一つのＶＣＵを設けるいわゆる１ＶＣＵ方式を採用しても良い。１ＶＣＵ方式であれば、ＶＣＵを設置するスペースの削減に寄与する。また、コストの削減、重量の削減にも寄与する。この場合には、ＰＤＵ１４１へ供給される電圧は、ＶＣＵが設けられない蓄電池の出力電圧となるが、この制約が不都合である場合には２ＶＣＵ方式を採用すれば良い。
【００２８】 50(8) JP 5973106 B1 2016.8.23なお、コンバータは、大別すると昇圧型、降圧型、昇降圧型に分類されるが、第１ＶＣＵ１３１、第２ＶＣＵ１３２は、いずれの型のコンバータも採用し得る。また、第１ＶＣＵ１３１、第２ＶＣＵ１３２に採用するコンバータの型を異ならせても良い。第１蓄電池１１１および第２蓄電池１２１とコンバータの型を適宜組み合わせることにより、要求仕様を満たす全体としてあたかも一つのバッテリとして利用することができる。
【００２９】第１スイッチ１１４と第２スイッチ１２４を閉状態、第３スイッチ１３３を開状態とした場合には、第１蓄電池１１１と第２蓄電池１２１の間で充放電が行われる。この蓄電池部間充放電は、電池ＥＣＵ１３０からの制御信号ＣＶ によって決定される第１ＶＣＵ１１３１の変換電圧値と、制御信号ＣＶ によって決定される第２ＶＣＵ１３２の変換電圧値 10２との差に応じて、電力の流れが定まる。したがって、電池ＥＣＵ１３０は、変換電圧値を指示する制御信号ＣＶ およびＣＶ をそれぞれのＶＣＵに送信することにより、どちら１ ２の蓄電池を電力の供給側とし、どちらの蓄電池を電力の受容側とするか制御することができる。なお、第１ＶＣＵ１３１と第２ＶＣＵ１３２の一方のハイサイドスイッチを「閉」かつローサイドスイッチを「開」に固定することで電圧変換を停止し、蓄電池の出力電圧をそのまま出力するいわゆる直結モードで制御して、他方の変換電圧値を変更するように制御しても良い。このとき、電池ＥＣＵ１３０は、Ｖ とＩ を監視すれば、第１蓄電池１ １１１１における充放電量を把握することができ、Ｖ とＩ を監視すれば、第２蓄電池１２ ２２１における充放電量を把握することができる。
【００３０】 20電池ＥＣＵ１３０の動作について更に説明する。電池ＥＣＵ１３０は、充放電回路モジュール１０３の各部、第１蓄電モジュール１０１および第２蓄電モジュール１０２を制御する。また、電池ＥＣＵ１３０は、第１スイッチ１１４、第２スイッチ１２４、第３スイッチ１３３を状況に応じて開閉すべく、開閉指示信号ＣＷ 、ＣＷ 、ＣＷ をそれぞれ１ ２ ３に向けて送信する。また、電池ＥＣＵ１３０は、第１ＶＣＵ１３１、第２ＶＣＵ１３２の変換電圧を調整すべく、制御信号ＣＶ 、ＣＶ をそれぞれに向けて送信する。１ ２
【００３１】電池ＥＣＵ１３０は、第１電流センサ１１３からＩ を取得する。また、電池ＥＣＵ１１３０は、第２電流センサ１２３からＩ を取得する。また、電池ＥＣＵ１３０は、ＣＡＮ２を通じてＰＤＵ１４１と通信する。電池ＥＣＵ１３０は、ＰＤＵ側電流センサ１４３によ 30り検出されたＩ を、ＣＡＮを通じてＰＤＵ１４１から取得する。また、電池ＥＣＵ１３３０は、取得したＩ 、Ｉ およびＩ に基づいて、第１ＶＣＵ１３１、第２ＶＣＵ１３２１ ２ ３を制御する。また、電池ＥＣＵ１３０は、取得したＩ およびＩ に基づいて、第１蓄電１ ２池１１１のＳＯＣおよび第２蓄電池１２１のＳＯＣを算出する。また、電池ＥＣＵ１３０は、取得したＩ 、Ｉ およびＩ に基づいて、第１電流センサ１１３、第２電流センサ１ ２ ３１２３およびＰＤＵ側電流センサ１４３の少なくとも１つの状態を判定する。
【００３２】具体的には、電池ＥＣＵ１３０は、第１蓄電池１１１とＭＧ１４４の間の充放電における、Ｉ とＩ を比較する第１操作と、第２蓄電池１２１とＭＧ１４４の間の充放電にお１ ３ける、Ｉ とＩ を比較する第２操作との少なくとも一方を行うことが可能である。また 40２ ３、電池ＥＣＵ１３０は、第２蓄電池１２１とＭＧ１４４に対する第１蓄電池１１１の同時放電における、Ｉ とＩ 、Ｉ とＩ のそれぞれを比較する第３操作を行うことが可能１ ２ １ ３である。そして、電池ＥＣＵ１３０は、第１操作と第２操作の少なくとも一方と、第３操作によって、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の少なくとも１つの状態を判定する。電池ＥＣＵ１３０によれば、第２蓄電池１２１とＭＧ１４４に対する第１蓄電池１１１の同時放電時の電流値を用いて比較するので、電流センサの状態を効率的に検出できる。さらに、第１〜第３操作はいずれもＭＧ１４４に対する充放電を含むため、駆動モジュール１４０によって駆動する、例えば車両の走行中においても、電流センサの状態を検出できる。
【００３３】 50(9) JP 5973106 B1 2016.8.23なお、駆動モジュール１４０は、ＭＧ１４４に対する要求電力を出力する。電池ＥＣＵ１３０は、第３操作においては、第１蓄電池１１１が要求電力に依存せずに一定電力を出力し、第２蓄電池１２１が一定電力と要求電力の差分で充電されるよう、第１ＶＣＵ１３１および第２ＶＣＵ１３２の少なくとも一方を制御する。これにより、要求電力が一定電力をより小さい場合、第２蓄電池１２１とＭＧ１４４に対する、第１蓄電池１１１の同時放電が生じる。
【００３４】第３操作において、第１電流センサ１１３は、第１蓄電池１１１が出力する一定電力を検出する。また、第３操作において、電池ＥＣＵ１３０は、Ｉ のうち要求電力に相当す１る値とＩ 、Ｉ のうち一定電力と要求電力の差分に相当する値とＩ のそれぞれを比較 10３ １ ２する。
【００３５】なお、電池ＥＣＵ１３０は、第２蓄電池１２１のＳＯＣを取得する。電池ＥＣＵ１３０は、第２蓄電池１２１のＳＯＣに基づいて、一定電力を設定してよい。電池ＥＣＵ１３０は、第２蓄電池１２１のＳＯＣが小さいほど一定電力が大きくなるように設定してよい。
【００３６】なお、電池ＥＣＵ１３０は、第１操作および第２操作の少なくとも一方と第３操作とにおいて比較される電流値が、等価又は相関関係を有するか否かを判定する。ここで、相関関係は、電流値が比較される電流センサの間における第１ＶＣＵ１３１および第２ＶＣＵ１３２の昇降圧率に基づいてよい。これにより、電池ＥＣＵ１３０は、充放電経路中に電 20圧変換回路が存在する場合でも、電圧変換回路による昇降圧率を考慮して、各電流センサの電流値の相関関係を有するか否かを適切に判定できる。
【００３７】なお、電池ＥＣＵ１３０は一種のコンピュータである。電池ＥＣＵ１３０は、例えばＭＰＵによって構成され、例えばＭＰＵの内部記憶部に格納されたプログラムを実行し、当該プログラムに従って蓄電装置１００の全体を制御する。電池ＥＣＵ１３０により実行されるプログラムは、記録媒体１９０から、蓄電装置１００内の電池ＥＣＵ１３０に供給される。なお、記録媒体１９０は、コンピュータにより読み出し可能な媒体の一例である。電池ＥＣＵ１３０内においてプログラムまたはコンピュータ命令が格納される任意の媒体を、電池ＥＣＵ１３０用のプログラムを格納する媒体とみなすことができる。 30
【００３８】上記のように、本実施形態における蓄電装置１００は、互いに特性が異なる２つの蓄電池を備える。互いに特性が異なる複数の蓄電池を用いるシステムは、それぞれの蓄電池の特性や状態に応じて、要求される電力の供給に対してどのように応えるか、細かく制御する必要がある。そこでまず、単一の蓄電池を用いた場合による電力出力と、特性が異なる複数の蓄電池を用いた場合による電力出力の違いについて説明する。
【００３９】図２は、単一の蓄電池を用いた場合による電力出力と、特性が異なる２つの蓄電池を用いた場合による電力出力とを比較するための図である。横軸は時間経過を表わし、縦軸は電力出力を表わす。電力出力が負の領域は、例えば回生電力によって電力受容がなされる 40ことを表わす。
【００４０】実線で示されるＳＢは、蓄電装置が一つの蓄電池によって構成される場合の、出力電力の変化を表わす。蓄電装置が一つの蓄電池のみを備える場合には、負荷側から要求される電力をその能力の範囲において要求されるままに出力し、入力される電力をそのまま受け入れる。したがって、短時間で大きな出入力を行う場合もあり、蓄電池が急激に劣化するなどの問題もある。
【００４１】蓄電装置が特性の異なる２つの蓄電池によって構成される場合には、それぞれの特性に応じて出入力を分担することができる。点線で表わされるＯＢは、高出力型バッテリの出 50(10) JP 5973106 B1 2016.8.23力電力の変化を表わし、二重線で表わされるＶＢは、高容量型バッテリの出力電力の変化を表わしている。各時間において、ＯＢの値とＶＢの値を足し合わせるとＳＢの値となる。すなわち、負荷側から要求される電力を、高容量型バッテリと高容量型バッテリで分担している様子を表わしている。
【００４２】一般的に高容量型バッテリは、高出入力および出入力の瞬間的な変動に対して劣化が進行するので、劣化の進行が抑制される範囲で出入力が行われるように制御されることが好ましい。したがって、ＯＢとＶＢの変化からわかるように、負荷側から大きな出入力が要求される場合には、原則として高出力型バッテリ（ＯＢ）が担い、高出力型バッテリでも応えられない場合に、高容量型バッテリ（ＶＢ）が補助する制御が行われる。また、高容 10量型バッテリは、あまり高くない値で継続的に出力する場合に適しており、この場合は、高出力型バッテリの出力は抑えられる。また、高容量型バッテリは高いレートの充電に相当する回生電力を受け入れた場合に劣化しやすいという特性を有するので、回生電力はできる限り高出力型バッテリで受け入れる制御が行われる。なお、回生電力が高出力型バッテリで受け入れられる容量を上回る場合には、高容量型バッテリで受入れる以外に、ブレーキを動作させて回生電力の発生を低減しても良い。この場合、高容量型バッテリの劣化を抑制できる。
【００４３】また、高容量型バッテリと高出力型バッテリは、それぞれＳＯＣに基づく劣化影響度も大きく異なる。高容量型バッテリは、ＳＯＣが変動しても、劣化影響度が大きく変動する 20ことはない。換言すれば、ＳＯＣがいかなる値であっても劣化の進行に大きな影響を与えることはない。一方、高出力型バッテリは、ＳＯＣが変動すると、劣化影響度もその値に応じて大きく変動する。より詳述すると、ＳＯＣが３０〜７０％の中央域では、高出力型バッテリの劣化影響度は小さいが、この中央域から離れるに従って、劣化影響度は大きくなる。すなわち、中央域から離れるほど劣化が進む。したがって、高容量型バッテリのＳＯＣが、０〜３０％の低域や７０〜１００％の高域に属さないように、高容量型バッテリと高出力型バッテリの充放電量を調整することが好ましい。
【００４４】このように特性の異なる複数の蓄電池を利用することにより、それぞれの蓄電池の劣化を抑制しつつ、負荷側からのさまざまな出力要求に応えることができる。そのためには、 30それぞれの蓄電池が充放電する電流および蓄電池と駆動モジュールとの間を流れる電流を正確に把握する必要がある。しかし、電流センサが故障すると、制御精度が低下したり、蓄電池の劣化が促進するおそれがある。したがって、各電流センサの状態を正確に検出する必要がある。なお、本実施形態において、「電流センサの故障」とは、電流センサの機能が正常に働かなくなることを意味する。例えば、電流センサの故障とは、上貼り付き故障、中間張り付き故障や下張り付き故障などにより、例えば電流センサの精度が低下することや、異常値を検出することや電流センサに動作不良が生じることを含む概念である。
【００４５】そこで、輸送機器１０における第１電流センサ１１３、第２電流センサ１２３及び第３ＰＤＵ側電流センサ１４３の状態を検出するための動作を、第１蓄電池１１１、第２蓄電 40池１２１およびＰＤＵ１４１の間における電荷の授受パターン毎に説明する。
【００４６】図３は、第１蓄電池１１１と第２蓄電池１２１との間でのみ電荷の授受が行われている状態を示す図である。この電荷の授受パターンを、パターン１と呼ぶ場合がある。図３は特に、第１蓄電池１１１が放電し、第２蓄電池１２１が充電している状態を示す。
【００４７】ここで、第１ＶＣＵ１３１の電圧変換比の逆数をβ 、第２ＶＣＵ１３２の電圧変換比１の逆数をβ 、第１電流センサ１１３で検出される電流値である第１電流値をＩ 、第２２ １電流センサ１２３で検出される電流値である第２電流値をＩ とする。もし、Ｉ ＝β２ ２ １×β ×Ｉ である場合は、第１電流センサ１１３および第２電流センサ１２３がいずれ 50２ １(11) JP 5973106 B1 2016.8.23も正常であると判断できる。一方、Ｉ ≠β ×β ×Ｉ である場合は、第１電流セン２ １ ２ １サ１１３および第２電流センサ１２３の少なくとも一方が故障していると判断できる。
【００４８】なお、第１電流センサ１１３および第２電流センサ１２３が共に正常な場合でも、実際には導通損などによりＩ とβ ×β ×Ｉ とが厳密には一致しない場合がある。その２ １ ２ １ため、Ｉ とβ ×β ×Ｉ とが若干の誤差を許容した等価又は相関関係にあれば、第２ １ ２ １１電流センサ１１３および第２電流センサ１２３がいずれも正常であると判断する。例えば、Ｉ とβ ×β ×Ｉ との差が予め定められた値より小さい場合は、第１電流セン２ １ ２ １サ１１３および第２電流センサ１２３がいずれも正常であると判断する。本実施形態において等号または不等号を含む式で２つの電流値が比較される場合に、等号は、比較される 10電流値が若干の誤差を許容した等価又は相関関係にあることを意味し、不等号は、比較される電流値が若干の誤差を許容した等価または相関関係にはないことを意味する。
【００４９】図４は、第１蓄電池１１１とＰＤＵ１４１との間でのみ電荷の授受が行われている状態を示す図である。この電荷の授受パターンを、パターン２と呼ぶ場合がある。図４は特に、第１蓄電池１１１が放電して、第１蓄電池１１１からの電荷がＰＤＵ１４１に流入している状態を示す。
【００５０】ここで、ＰＤＵ側電流センサ１４３で検出される電流値である第３電流値をＩ とする３。もし、Ｉ ＝β ×Ｉ を満たす場合は、第１電流センサ１１３およびＰＤＵ側電流セ 20３ １ １ンサ１４３がいずれも正常であると判断できる。一方、Ｉ ≠β ×Ｉ である場合は、３ １ １第１電流センサ１１３およびＰＤＵ側電流センサ１４３の少なくとも一方が故障していると判断できる。
【００５１】図５は、第２蓄電池１２１とＰＤＵ１４１との間でのみ電荷の授受が行われている状態を示す図である。この電荷の授受パターンを、パターン３と呼ぶ場合がある。図５は特に、第２蓄電池１２１が放電して、第２蓄電池１２１からの電荷がＰＤＵ１４１に流入している状態を示す。
【００５２】もし、Ｉ ＝β ×Ｉ を満たす場合は、第２電流センサ１２３およびＰＤＵ側電流セ 30３ ２ ２ンサ１４３がいずれも正常であると判断できる。一方、Ｉ ≠β ×Ｉ である場合は、３ ２ ２第２電流センサ１２３およびＰＤＵ側電流センサ１４３の少なくとも一方が故障していると判断できる。
【００５３】図６は、第１蓄電池１１１、第２蓄電池１２１およびＰＤＵ１４１の間で電荷の授受が行われている状態を示す図である。図６は特に、第１蓄電池１１１が放電して、第１蓄電池１１１からの電荷がＰＤＵ１４１および第２蓄電池１２１に流入している状態を示す。この状態では、駆動モジュール１４０が要求する電力エネルギー以上の電力エネルギーが第１蓄電池１１１から取り出されて、そのうちの一部が第２蓄電池１２１に供給される。そのため、この電荷の授受パターンを、第１蓄電池１１１の強制放電パターンと呼ぶ場合 40がある。強制放電パターンにおいては、上述したパターン１およびパターン２の両方の電荷授受パターンが生じる。
【００５４】ここで、第１蓄電池１１１からの電流がＰＤＵ１４１に分配される割合をαとする。この場合、もし、Ｉ ＝α×β ×Ｉ を満たす場合は、第１電流センサ１１３およびＰＤ３ １ １Ｕ側電流センサ１４３がいずれも正常であると判断できる。一方、Ｉ ≠α×β ×Ｉ３ １ １である場合は、第１電流センサ１１３およびＰＤＵ側電流センサ１４３の少なくとも一方が故障していると判断できる。また、Ｉ ＝（１−α）×β ×β ×Ｉ を満たす場合２ １ ２ １は、第１電流センサ１１３および第２電流センサ１２３がいずれも正常であると判断できる。一方、Ｉ ≠（１−α）×β ×β ×Ｉ である場合は、第１電流センサ１１３お 50２ １ ２ １(12) JP 5973106 B1 2016.8.23よび第２電流センサ１２３の少なくとも一方が故障していると判断できる。
【００５５】図７は、各電流センサの状態と、各電流センサの電流値の判定結果の関係を表すテーブルを示す図である。例えば、図７に示されるように、第１電流センサ１１３の故障は、パターン１による第１蓄電池１１１のＩ と第２蓄電池１２１のＩ との比較結果、または１ ２、Ｉ とＰＤＵ１４１のＩ との比較結果により、検出できる。また、第２電流センサ１１ ３２３の故障は、Ｉ とＩ との比較結果、または、Ｉ とＩ との比較結果により、検出１ ２ ２ ３できる。また、ＰＤＵ側電流センサ１４３の故障は、Ｉ とＩ との比較結果、または、１ ３Ｉ とＩ との比較結果により、検出できる。２ ３
【００５６】 10例えば、パターン１の比較においてＩ ≠β ×β ×Ｉ であった場合について具体２ １ ２ １的に説明する。この場合、第１電流センサ１１３および第２電流センサ１２３の少なくとも一方が故障していると判断できるが、第１電流センサ１１３および第２電流センサ１２３のどちらが故障しているか、または、両方が故障しているかまでは、確定できない。しかし、第２電流センサ１２３が故障しているか否かは、パターン３によっても判断できる。例えばパターン３の比較においてＩ ＝β ×Ｉ であれば、第２電流センサ１２３お３ ２ ２よびＰＤＵ側電流センサ１４３が正常であると判断できるので、第１電流センサ１１３のみが故障していると確定できる。
【００５７】一方、パターン３の比較においてＩ ≠β ×Ｉ であった場合は依然として、第１電 20３ ２ ２流センサ１１３および第２電流センサ１２３のどちらが故障しているか、または、両方が故障しているかは確定できない。しかし、第１電流センサ１１３が故障しているか否かは、パターン２によっても判断できる。パターン２の比較により、Ｉ ＝β ×Ｉ であれ３ １ １ば、第１電流センサ１１３およびＰＤＵ側電流センサ１４３が正常であると判断できるので、第２電流センサ１２３のみが故障していると確定できる。このように、各電流センサの故障を検出することが可能なパターンが２つ存在するので、１つの電流センサが故障した場合には、その電流センサを特定することができる。
【００５８】なお、図６に関連して説明した強制放電パターンによれば、パターン１の判定とパターン２の判定とを行うことができる。したがって、強制放電パターンが生じているとき得ら 30れる電流値を比較することで、電流センサの状態を効率的に判定することが可能になる。
【００５９】図８は、強制放電パターンを含む輸送機器１０の駆動オペレーションの一例を示す図である。図８には、輸送機器１０の速度と、第１蓄電池１１１のＳＯＣであるＳＯＣ と、１第２蓄電池１２１のＳＯＣであるＳＯＣ が示されている。２
【００６０】第２蓄電池１２１のＳＯＣが予め定められた閾値ＳＯＣ を上回っている場合、電池ｔｈＥＣＵ１３０は、駆動モジュール１４０への駆動電力が第２蓄電池１２１から供給されるように、第２ＶＣＵ１３２を制御する。図８に示されるように、輸送機器１０の発進時および加速走行時の初期においては、第２蓄電池１２１のＳＯＣが閾値ＳＯＣ を上回っ 40ｔｈており、かつ、要求電力は第２蓄電池１２１から出力することが許容される出力許容電力以下である。そのため、電池ＥＣＵ１３０は、駆動モジュール１４０からの要求電力を全て第２蓄電池１２１から供給するように、第２ＶＣＵ１３２を制御する。この場合、上述したパターン３の状態が生じる。電池ＥＣＵ１３０は、この状態における第２電流センサ１２３およびＰＤＵ側電流センサ１４３のそれぞれからの電流値を取得して、電流センサの状態の判定に用いる。
【００６１】第２蓄電池１２１のＳＯＣが閾値ＳＯＣ 以下になると、電池ＥＣＵ１３０は、第１ｔｈＶＣＵ１３１を制御して、第１蓄電池１１１から電力の出力を開始させる。この場合、電池ＥＣＵ１３０は、第２蓄電池１２１のＳＯＣに応じた所定値の電力が第１蓄電池１１１ 50(13) JP 5973106 B1 2016.8.23から供給されるように、第１ＶＣＵ１３１を制御する。このとき、駆動モジュール１４０からの要求電力よりも、第１蓄電池１１１からの所定値の電力が不足する場合、図８に示されるように不足分の電力が第２蓄電池１２１から出力されるように、第２ＶＣＵ１３２を制御する。
【００６２】図８に示されるように、輸送機器１０が定速走行に入り、要求電力が低下すると、第１蓄電池１１１からの所定値の電力に余剰が生じる。電池ＥＣＵ１３０は、この余剰分の電力が第２蓄電池１２１に供給されるように、第２ＶＣＵ１３２を制御する。この場合に、上述した第１蓄電池１１１の強制放電パターンが生じる。電池ＥＣＵ１３０は、この状態における第１電流センサ１１３、第２電流センサ１２３及びＰＤＵ側電流センサ１４３か 10らの電流値を取得して、各電流センサの状態を判断に用いる。具体的な判断フローについては、後述する。
【００６３】図８に示されるように、輸送機器１０がパワー加速に入り、要求電力が更に大きくなり、第１蓄電池１１１からの所定値の電力および第２蓄電池１２１の出力許容電力の合計を要求電力が超えるようになると、電池ＥＣＵ１３０は、第２蓄電池１２１から出力許容電力が供給されるように第２ＶＣＵ１３２を制御するとともに、要求電力に対する更なる不足電力が第１蓄電池１１１から供給されるように、第１ＶＣＵ１３１を制御する。
【００６４】また、図８に示されるように、輸送機器１０の減速時には、ＭＧ１４４で生じた回生電 20力が駆動モジュール１４０から蓄電装置１００側に出力される。電池ＥＣＵ１３０は、回生電力が第２蓄電池１２１に供給されるように第１ＶＣＵ１３１を制御する。第２蓄電池１２１に入力することが許容される許容入力電力を回生電力が超える場合、電池ＥＣＵ１３０は、余剰分の電力が第１蓄電池１１１に供給されるように、第１ＶＣＵ１３１を制御する。
【００６５】図９は、第１蓄電池１１１および第２蓄電池１２１のそれぞれにおける電力の入出力を、第２蓄電池１２１のＳＯＣ毎に示す図である。電池ＥＣＵ１３０は、図９に示される情報に基づいて、第１蓄電池１１１および第２蓄電池１２１のそれぞれへの入出力電力を決定して、決定した入出力電力が生じるように、第１ＶＣＵ１３１および第２ＶＣＵ１３２ 30を制御する。
【００６６】まず、回生電力が生じている場合を説明する。電池ＥＣＵ１３０は、第２蓄電池１２１のＳＯＣに関係なく、回生電力の受け入れ先として、第２蓄電池１２１を選択する。電池ＥＣＵ１３０は、回生電力に応じた量の電力が第２蓄電池１２１に入力されるように、第２ＶＣＵ１３２を制御する。回生電力が大きく、第２蓄電池１２１の入力許容電力に対して回生電力に余剰分が生じる場合は、電池ＥＣＵ１３０は、余剰分が第１蓄電池１１１に入力されるように、第１ＶＣＵ１３１を制御する。
【００６７】次に、第２蓄電池１２１のＳＯＣが閾値ＳＯＣ 以上の場合について説明する。上述 40ｔｈしたように、駆動モジュール１４０からの要求電力が第２蓄電池１２１からの出力許容電力以下であれば、電池ＥＣＵ１３０は、要求電力を全て第２蓄電池１２１から出力するように、第２ＶＣＵ１３２を制御する。要求電力が出力許容電力を超える場合は、要求電力に対する不足分の電力が第１蓄電池１１１から出力されるように、第１ＶＣＵ１３１を制御する。
【００６８】次に、第２蓄電池１２１のＳＯＣが目標値ＳＯＣ 以上かつ閾値ＳＯＣ 未満の場ｔｇ ｔｈ合について説明する。ここで目標値ＳＯＣ は、閾値ＳＯＣ より小さい予め定めらｔｇ ｔｈれた値である。この場合においては、要求電力に対して第１蓄電池１１１から優先的に供給される。この場合、電池ＥＣＵ１３０は、第１蓄電池１１１からの出力電力が、第２蓄 50(14) JP 5973106 B1 2016.8.23電池１２１のＳＯＣに応じた所定値になるように、第１ＶＣＵ１３１を制御する。この場合に、駆動モジュール１４０からの要求電力より第１蓄電池１１１からの所定値の電力が大きくなる場合がある。このとき、電池ＥＣＵ１３０は、余剰分の電力が第２蓄電池１２１に入力されるように、第２ＶＣＵ１３２を制御する。この場合に、第１蓄電池１１１からの強制放電パターンが生じる。したがって、第２蓄電池１２１のＳＯＣが目標値ＳＯＣ以上かつ閾値ＳＯＣ 未満の場合、第１蓄電池１１１からの電流がＰＤＵ１４１にｔｇ ｔｈ分配される割合αは、第２蓄電池１２１のＳＯＣと要求電力によって決定される。
【００６９】一方、第１蓄電池１１１からの所定値の電力より要求電力が大きい場合は、電池ＥＣＵ１３０は、不足分の電力が第２蓄電池１２１から出力されるように、第２ＶＣＵ１３２を 10制御する。また、上述したように、要求電力が、第１蓄電池１１１からの所定値の電力と第２蓄電池１２１の出力許容電力の合計を超える場合は、電池ＥＣＵ１３０は、不足分の電力が第１蓄電池１１１から更に出力されるように、第１ＶＣＵ１３１を制御する。
【００７０】次に、ＳＯＣが目標値ＳＯＣ 未満の場合について説明する。この場合においては、ｔｇ第２蓄電池１２１のＳＯＣが目標値ＳＯＣ 以上かつ閾値ＳＯＣ 未満の場合と同様ｔｇ ｔｈに、要求電力に対して第１蓄電池１１１から優先的に供給される。この場合、電池ＥＣＵ１３０は、第１蓄電池１１１からの出力電力が一定値になるように、第１ＶＣＵ１３１を制御する。この場合に、駆動モジュール１４０からの要求電力より第１蓄電池１１１からの一定値の電力が大きくなる場合がある。このとき、電池ＥＣＵ１３０は、余剰分の電力 20が第２蓄電池１２１に入力されるように、第２ＶＣＵ１３２を制御する。この場合にも、第１蓄電池１１１からの強制放電パターンが生じる。したがって、第２蓄電池１２１のＳＯＣが目標値未満の場合、αは、第１蓄電池１１１からの一定値の出力電力と要求電力とによって決定される。
【００７１】一方、第１蓄電池１１１からの一定値の電力より要求電力が大きい場合は、電池ＥＣＵ１３０は、不足分の電力が第１蓄電池１１１から出力されるように、第２ＶＣＵ１３２を制御する。電池ＥＣＵ１３０は、第１蓄電池１１１から出力することが許容される出力許容電力を要求電力が超える場合に限り、第２蓄電池１２１から不足分の電力が出力されるように、第２ＶＣＵ１３２を制御する。 30
【００７２】以上に説明したように、輸送機器１０の走行時に、駆動モジュール１４０からの要求電力と第２蓄電池１２１のＳＯＣが所定の条件を満たした場合に、上述した第１蓄電池１１１の強制放電パターンが生じる。電池ＥＣＵ１３０は、強制放電パターンが生じている場合の電流センサによる電流の検出値を用いて、電流センサの故障を効率的に判定できる。
【００７３】図１０は、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の状態を判定するまでのフロー図である。本フローは、電池ＥＣＵ１３０において定期的に実行されて良い。また、本フローは、輸送機器１０の制御部からの指示に基づいて電池ＥＣＵ１３０において開始されて良い。 40
【００７４】ステップＳ１００１において、電池ＥＣＵ１３０は、図５等に関連して説明したパターン３の状態におけるＩ およびＩ を取得する。ステップＳ１００３において、電池ＥＣ２ ３Ｕ１３０は、Ｉ ≠β ×Ｉ であるか否かを判断する。ステップＳ１００３の判定が偽３ ２ ２（ＮＯ）の場合、電池ＥＣＵ１３０は、第２電流センサ１２３およびＰＤＵ側電流センサ１４３が正常であると判定する（ステップＳ１００５）。
【００７５】続いて、ステップＳ１００７において、電池ＥＣＵ１３０は、図６等に関連して説明した強制放電パターンの状態におけるＩ およびＩ を取得する。そして、ステップＳ１０１ ２０９において、電池ＥＣＵ１３０は、（１−α）×β ×β ×Ｉ ≠Ｉ であるかを判 50１ ２ １ ２(15) JP 5973106 B1 2016.8.23断する。ステップＳ１００９の判定が偽の場合、電池ＥＣＵ１３０は、第１電流センサ１１３が正常であると判定する（ステップＳ１０１１）。そして、ステップＳ１０１３において、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の全電流センサが正常であると確定して、本フローを終了する。
【００７６】ステップＳ１００９における判断が真（ＹＥＳ）の場合、電池ＥＣＵ１３０は、第１電流センサ１１３が故障していると判断する（ステップＳ１０１７）。これにより、ステップＳ１０１９において、第１電流センサ１１３のみが故障していると確定して、本フローを終了する。
【００７７】 10ステップＳ１００３における判断が真の場合、電池ＥＣＵ１３０は、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の少なくとも一方が故障していると判定する（ステップＳ１０２１）。
【００７８】続いて、ステップＳ１０２３において、電池ＥＣＵ１３０は、図６等に関連して説明した強制放電パターンの状態におけるＩ およびＩ を取得する。そして、ステップＳ１０１ ２２５において、電池ＥＣＵ１３０は、（１−α）×β ×β ×Ｉ ≠Ｉ であるかを判１ ２ １ ２断する。ステップＳ１０２５の判断が偽の場合、電池ＥＣＵ１３０は、ＰＤＵ側電流センサ１４３が故障していると判定する（ステップＳ１０２７）。これにより、ステップＳ１０２９において、電池ＥＣＵ１３０は、ＰＤＵ側電流センサ１４３のみが故障していると 20確定して、本フローを終了する。
【００７９】ステップＳ１０２５の判断が真の場合、電池ＥＣＵ１３０は、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の少なくとも１つが故障していると判定する（ステップＳ１０３１）。そして、ステップＳ１０３３において、α×β ×１Ｉ ≠Ｉ であるかを判断する。ステップＳ１０３３の判断が真の場合、電池ＥＣＵ１３１ ３０は、電池ＥＣＵ１３０は、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の少なくとも１つが故障しているとの判定を維持する（ステップＳ１０３５）。これにより、電池ＥＣＵ１３０は、故障した電流センサが不確定であると判定して、本フローを終了する。なお、ステップＳ１０３７において、電池ＥＣＵ１３０は、 30故障した電流センサが不確定である旨を、輸送機器１０の制御装置に出力してよい。
【００８０】ステップＳ１０３３の判断が偽の場合、電池ＥＣＵ１３０は、第２電流センサ１２３が故障していると判定する（ステップＳ１０４１）。これにより、ステップＳ１０４３において、第２電流センサ１２３が故障していることを確定して、本フローを終了する。
【００８１】以上に説明したように、輸送機器１０によれば、第１蓄電池１１１が第２蓄電池１２１およびＭＧ１４４に対する同時放電時の電流値を用いるので、第１電流センサ１１３、第２電流センサ１２３およびＰＤＵ側電流センサ１４３の状態を速やかに検出できる。そのため、各電流センサの状態検出を高頻度に行うことが可能になる。また、各電流センサの 40状態の検出精度を高めることができる。また、電流センサで検出された電流値の比較に基づいて電流センサの状態を判定するので、電流センサの状態を検出するための特別な回路や手段を要しない。また、特別な充放電パターンを要することなく電流センサの状態を判定できる。そのため、輸送機器１０の動作中に、電流センサの状態を判定できる。
【００８２】なお、輸送機器は、電動自動車に限られない。輸送機器は、電源装置および内燃機関を備えるハイブリッド自動車、電車などの車両であってよい。輸送機器は、車両に限られず、電源装置を備える航空機や船舶など、陸上、空中、水上又は水中を移動して物体を輸送する様々な機器を含む。輸送機器とは、電源装置を備える様々な輸送用機器を含む概念である。 50(16) JP 5973106 B1 2016.8.23
【００８３】以上、本発明を実施の形態を用いて説明したが、本発明の技術的範囲は上記実施の形態に記載の範囲には限定されない。上記実施の形態に、多様な変更または改良を加えることが可能であることが当業者に明らかである。その様な変更または改良を加えた形態も本発明の技術的範囲に含まれ得ることが、特許請求の範囲の記載から明らかである。
【００８４】特許請求の範囲、明細書、および図面中において示した装置、システム、プログラム、および方法における動作、手順、ステップ、および段階等の各処理の実行順序は、特段「より前に」、「先立って」等と明示しておらず、また、前の処理の出力を後の処理で用いるのでない限り、任意の順序で実現しうることに留意すべきである。特許請求の範囲、明 10細書、および図面中の動作フローに関して、便宜上「まず、」、「次に、」等を用いて説明したとしても、この順で実施することが必須であることを意味するものではない。
【符号の説明】
【００８５】１０ 輸送機器、１００ 蓄電装置、１０１ 第１蓄電モジュール、１０２ 第２蓄電モジュール、１０３ 充放電回路モジュール、１１１ 第１蓄電池、１１２ 第１電圧センサ、１１３ 第１電流センサ、１１４ 第１スイッチ、１２１ 第２蓄電池、１２２ 第２電圧センサ、１２３ 第２電流センサ、１２４ 第２スイッチ、１３０ 電池ＥＣＵ、１３１ 第１ＶＣＵ、１３２ 第２ＶＣＵ、１３３ 第３スイッチ、１４０ 駆動モジュール、１４２ 第３電圧センサ、１４１ ＰＤＵ、１４３ ＰＤＵ側電流センサ、１４４ 20ＭＧ、１５１ 充電コンバータ、１５２ 受電部、１５３ 外部電源、１９０ 記録媒体
【要約】
【課題】複数の電流センサの状態を効率的に判定する。
【解決手段】電源装置は、第１蓄電部と、第１蓄電部の充放電の第１電流値を検出する第１センサと、第２蓄電部と、第２蓄電部の充放電の第２電流値を検出する第２センサと、第１蓄電部、第２蓄電部と、第１蓄電部と第２蓄電部の少なくとも一方の電力で駆動される駆動部の間の充放電を担う充放電回路を制御する制御部を有する回路モジュールを含み、制御部は、第１蓄電部と駆動部の間の充放電における第１電流値と駆動部の第３電流値を比較する操作と、第２蓄電部と駆動部の間の充放電における、第２電流値と第３電流値 30を比較する操作との少なくとも一方と、第２蓄電部と駆動部に対する第１蓄電部の放電における、第１電流値と第２電流値、第１電流値と第３電流値のそれぞれを比較する操作を行い、第１センサ、第２センサおよび第３電流値を検出する第３センサの少なくとも１つの状態を判定する。
【選択図】図６(17) JP 5973106 B1 2016.8.23
【図１】 
【図２】
【図３】 
【図４】(18) JP 5973106 B1 2016.8.23
【図５】 
【図６】
【図７】
【図８】 
【図９】(19) JP 5973106 B1 2016.8.23
【図１０】(20) JP 5973106 B1 2016.8.23フロントページの続き審査官 古河 雅輝(56)参考文献 特開２００７−０９９０３３（ＪＰ，Ａ）国際公開第２０１０／１２２７６６（ＷＯ，Ａ１）特開２０１３−２５００７８（ＪＰ，Ａ）特開２０１３−０９０４７４（ＪＰ，Ａ）特開２０１３−２３５６８９（ＪＰ，Ａ）10(58)調査した分野(Int.Cl.，ＤＢ名)Ｂ６０Ｌ １／００− ３／１２Ｂ６０Ｌ ７／００−１３／００Ｂ６０Ｌ １５／００−１５／４２Ｂ６０Ｗ １０／００Ｂ６０Ｗ ３０／００−５０／１６Ｈ０１Ｍ １０／４２−１０／４８Ｈ０２Ｊ ７／００− ７／１２Ｈ０２Ｊ ７／３４− ７／３６']