['JP 5980458 B1 2016.8.31(57)
【特許請求の範囲】
【請求項１】第１蓄電部と、第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路と、前記充放電回路を制御する制御部とを含み、前記制御部は、前記第１蓄電部と前記第２蓄電部の少なくとも一方を対象蓄電部とし、前記対象蓄電部の充電率と開放端電圧である対象ＳＯＣと対象ＯＣＶを取得し、 10前記第１蓄電部と前記第２蓄電部の間の電荷移動を用いて、前記対象ＳＯＣと前記対象ＯＣＶを含むデータを、前記データの集合である収集済データのＳＯＣに対する離散状態と前記対象ＳＯＣに基づく評価関数より導出される順序で収集し、複数の前記データに基づき、前記対象蓄電部のＳＯＣとＯＣＶの相関情報を推定することを特徴とする電源装置。
【請求項２】前記制御部は、前記収集済データに基づき収集していない前記データの集合である未収集データを導出し、前記評価関数は、前記未収集データに含まれるＳＯＣである未収集ＳＯＣを収集した場合の前記離散状態に基づく 20(2) JP 5980458 B1 2016.8.31請求項１に記載の電源装置。
【請求項３】前記評価関数は、前記未収集ＳＯＣを収集した場合の前記離散状態の変化量に基づく請求項２に記載の電源装置。
【請求項４】前記評価関数は、収集した場合の前記離散状態が大きくなる前記未収集ＳＯＣを含むデータほど、高く評価する請求項２または３に記載の電源装置。
【請求項５】前記評価関数は、前記未収集ＳＯＣと前記対象ＳＯＣの差分から算出される前記電荷移 10動に要する時間を含む操作時間にさらに基づく請求項２から４のいずれか一項に記載の電源装置。
【請求項６】前記操作時間は、前記電荷移動の後において前記対象蓄電部の電圧の時間変化が安定するまでに要する時間を含む請求項５に記載の電源装置。
【請求項７】前記評価関数は、前記操作時間が短い前記未収集ＳＯＣを含むデータほど、高く評価する請求項５または６に記載の電源装置。 20
【請求項８】前記評価関数は、前記操作時間より前記離散状態を強く評価する請求項５から７のいずれか１項に記載の電源装置。
【請求項９】前記制御部は、前記対象蓄電部の複数の劣化状態において同一のＳＯＣに対するＯＣＶの差分が閾値以下となるＳＯＣである基準ＳＯＣの範囲に前記対象蓄電部のＳＯＣが含まれる、または、前記基準ＳＯＣに対応するＯＣＶである基準ＯＣＶの範囲に前記対象蓄電部のＳＯＣが含まれるときからの前記対象蓄電部への電荷移動量に基づいて、前記対象ＳＯＣを取得する請求項１から８のいずれか１項に記載の電源装置。 30
【請求項１０】前記制御部は、前記対象蓄電部の複数の劣化状態において同一のＳＯＣに対するＯＣＶの差分が閾値以下となるＳＯＣである基準ＳＯＣと、前記基準ＳＯＣに対応するＯＣＶである基準ＯＣＶが、前記対象ＳＯＣと前記対象ＯＣＶとして含まれるように、前記データを収集する請求項１から９のいずれか１項に記載の電源装置。
【請求項１１】前記制御部は、前記電荷移動を行う前の前記対象蓄電部のＳＯＣが前記基準ＳＯＣの範囲に含まれない場合、または、前記電荷移動を行う前の前記対象蓄電部のＯＣＶが前記基準ＯＣＶの範囲に含まれない場合、前記電荷移動に先立ち、前記対象蓄電部のＳＯＣが前 40記基準ＳＯＣの範囲に含まれる、または、前記対象蓄電部のＯＣＶが前記基準ＯＣＶの範囲に含まれるよう、前記第１蓄電部と前記第２蓄電部との間の充放電を行う請求項９または１０に記載の電源装置。
【請求項１２】前記制御部は、前記第１蓄電部と前記第２蓄電部の少なくとも一方の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報を予め記憶する記憶部を備え、前記制御部は、前記記憶部が記憶している前記対象蓄電部の前記複数の劣化状態におけるＳＯＣとＯＣＶの相関情報のうち、前記対象ＳＯＣと前記対象ＯＣＶを含む前記複数のデータに対する適合度がより高い相関情報を、前記推定する前記相関情報として、より優先して選択する 50(3) JP 5980458 B1 2016.8.31請求項１から１１のいずれか１項に記載の電源装置。
【請求項１３】前記制御部は、前記対象ＳＯＣと前記対象ＯＣＶを含む前記複数のデータに対する近似曲線または近似直線に基づき、前記相関情報を推定する請求項１から１１のいずれか１項に記載の電源装置。
【請求項１４】前記第１蓄電部と前記第２蓄電部の少なくとも一方は、駆動部に電力を供給し、前記充放電回路は、前記第１蓄電部、前記第２蓄電部、および前記駆動部の間の充放電を担い、前記制御部は、前記電荷移動を行う間、前記第１蓄電部と前記第２蓄電部が、前記駆動 10部との間で充放電を行わないよう前記充放電回路を制御する請求項１から１３のいずれか１項に記載の電源装置。
【請求項１５】前記制御部は、前記第１蓄電部及び前記第２蓄電部のうち既に前記相関情報が推定された蓄電部のＳＯＣの問合せを受けた場合に、前記相関情報が推定された蓄電部のＯＣＶと、推定した前記相関情報とに基づいて、前記相関情報が推定された蓄電部のＳＯＣを算出して応答する請求項１から１４のいずれか１項に記載の電源装置。
【請求項１６】前記第１蓄電部は、前記第２蓄電部と比して、エネルギー密度が劣り、出力密度が優れ 20る請求項１から１５のいずれか１項に記載の電源装置。
【請求項１７】前記制御部は、前記第２蓄電部より前記第１蓄電部を前記対象蓄電部として優先して選択する請求項１６に記載の電源装置。
【請求項１８】請求項１〜１７のいずれか１項に記載の電源装置を有する輸送機器。
【請求項１９】第１蓄電部と、 30第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路とを含む電源装置の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報を推定する推定方法であって、前記第１蓄電部と前記第２蓄電部の少なくとも一方を対象蓄電部とするステップと、前記対象蓄電部のＳＯＣとＯＣＶである対象ＳＯＣと対象ＯＣＶを取得するステップと、前記第１蓄電部と前記第２蓄電部の間の電荷移動を用いて、前記対象ＳＯＣと前記対象ＯＣＶを含むデータを、前記データの集合である収集済データのＳＯＣに対する離散状態と前記対象ＳＯＣに基づく評価関数より導出される順序で収集するステップと、 40複数の前記データに基づき、前記対象蓄電部のＳＯＣとＯＣＶの相関情報を推定するステップとを含む推定方法。
【請求項２０】第１蓄電部と、第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路とを含む電源装置の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報を推定するためのプログラムであって、前記第１蓄電部と前記第２蓄電部の少なくとも一方を対象蓄電部とするステップと、 50(4) JP 5980458 B1 2016.8.31前記対象蓄電部のＳＯＣとＯＣＶである対象ＳＯＣと対象ＯＣＶを取得するステップと、前記第１蓄電部と前記第２蓄電部の間の電荷移動を用いて、前記対象ＳＯＣと前記対象ＯＣＶを含むデータを、前記データの集合である収集済データのＳＯＣに対する離散状態と前記対象ＳＯＣに基づく評価関数より導出される順序で収集するステップと、複数の前記データに基づき、前記対象蓄電部のＳＯＣとＯＣＶの相関情報を推定するステップとをコンピュータに実行させるためのプログラム。
【発明の詳細な説明】
【技術分野】 10
【０００１】本発明は、電源装置、該電源装置を有する輸送機器、蓄電部の充電率と開放端電圧の相関情報を推定する推定方法、および該相関情報を推定するためのプログラムに関する。
【背景技術】
【０００２】複数の蓄電池を備えるシステムにおいて、その蓄電池間で充放電を行うことにより、ＯＣＶ（Ｏｐｅｎ Ｃｉｒｃｕｉｔ Ｖｏｌｔａｇｅ、開放端電圧）に対するＳＯＣ（Ｓｔａｔｅ Ｏｆ Ｃｈａｒｇｅ、充電率）の関係を把握する技術が知られている。［先行技術文献］［特許文献］ 20［特許文献１］特開２００８―２２００８０号公報
【発明の概要】
【発明が解決しようとする課題】
【０００３】蓄電部のＳＯＣとＯＣＶのより正確な相関情報を効率的に推定することができないという課題があった。
【課題を解決するための手段】
【０００４】本発明の第１の態様における電源装置は、第１蓄電部と、第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部とを含み、制 30御部は、第１蓄電部と第２蓄電部の少なくとも一方を対象蓄電部とし、対象蓄電部の充電率と開放端電圧である対象ＳＯＣと対象ＯＣＶを取得し、第１蓄電部と第２蓄電部の間の電荷移動を用いて、対象ＳＯＣと対象ＯＣＶを含むデータを、データの集合である収集済データのＳＯＣに対する離散状態と対象ＳＯＣに基づく評価関数より導出される順序で収集し、複数のデータに基づき、対象蓄電部のＳＯＣとＯＣＶの相関情報を推定する。
【０００５】本発明の第２の態様における輸送機器は、上記の電源装置を有する。
【０００６】本発明の第３の態様における方法は、第１蓄電部と、第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路とを含む電源装置の充電率と開放端電圧であるＳＯ 40ＣとＯＣＶの相関情報を推定する推定方法であって、第１蓄電部と第２蓄電部の少なくとも一方を対象蓄電部とするステップと、対象蓄電部のＳＯＣとＯＣＶである対象ＳＯＣと対象ＯＣＶを取得するステップと、第１蓄電部と第２蓄電部の間の電荷移動を用いて、対象ＳＯＣと対象ＯＣＶを含むデータを、データの集合である収集済データのＳＯＣに対する離散状態と対象ＳＯＣに基づく評価関数より導出される順序で収集するステップと、複数のデータに基づき、対象蓄電部のＳＯＣとＯＣＶの相関情報を推定するステップとを含む。
【０００７】本発明の第４の態様におけるプログラムは、第１蓄電部と、第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路とを含む電源装置の充電率と開放端電圧であ 50(5) JP 5980458 B1 2016.8.31るＳＯＣとＯＣＶの相関情報を推定するためのプログラムであって、第１蓄電部と第２蓄電部の少なくとも一方を対象蓄電部とするステップと、対象蓄電部のＳＯＣとＯＣＶである対象ＳＯＣと対象ＯＣＶを取得するステップと、第１蓄電部と第２蓄電部の間の電荷移動を用いて、対象ＳＯＣと対象ＯＣＶを含むデータを、データの集合である収集済データのＳＯＣに対する離散状態と対象ＳＯＣに基づく評価関数より導出される順序で収集するステップと、複数のデータに基づき、対象蓄電部のＳＯＣとＯＣＶの相関情報を推定するステップとをコンピュータに実行させる。
【０００８】なお、上記の発明の概要は、本発明の必要な特徴の全てを列挙したものではない。また、これらの特徴群のサブコンビネーションもまた、発明となりうる。 10
【図面の簡単な説明】
【０００９】
【図１】本実施形態に係る輸送機器のブロック図である。
【図２】単一の蓄電池を用いた場合による電力出力と、２つの蓄電池を用いた場合による電力出力とを比較するための図である。
【図３】蓄電池のＳＯＣ−ＯＣＶカーブを説明する図である。
【図４】ＳＯＣ−ＯＣＶカーブを確定するまでの手順を説明する図である。
【図５】平面空間上で座標を確定させるための演算を説明する図である。
【図６】電池ＥＣＵの内部ブロック図である。
【図７】（ＳＯＣ，ＯＣＶ）データとＳＯＣ−ＯＣＶカーブの確度との関係を説明するた 20めの図である。
【図８】ＳＯＣの離散度の算出例を示す。
【図９】電荷移動に要する時間Ｔ を算出するための情報を示す図である。Ｍ
【図１０】ＳＯＣ毎に算出された離散度、操作時間及び評価値の一例を示す。
【図１１】ＳＯＣ−ＯＣＶカーブを確定させるまでのフロー図である。
【図１２】次の取得対象となるＳＯＣを決定するまでのフロー図である。
【発明を実施するための形態】
【００１０】以下、発明の実施の形態を通じて本発明を説明するが、以下の実施形態は特許請求の範囲にかかる発明を限定するものではない。また、実施形態の中で説明されている特徴の組 30み合わせの全てが発明の解決手段に必須であるとは限らない。
【００１１】図１は、本実施形態に係る輸送機器１０のブロック図である。本実施形態に係る輸送機器は、例えば電動自動車である。以下においては、本実施形態に係る蓄電装置１００が電動自動車に搭載されて利用される場合を想定して説明する。なお、蓄電装置１００は、電源装置の一例である。
【００１２】輸送機器１０は、搭載された蓄電装置１００から供給される駆動電力をパワードライブユニットであるＰＤＵ１４１が受け、ＰＤＵ１４１がモータジェネレータＭＧを回転駆動させることにより走行する。 40
【００１３】ＰＤＵ１４１は、蓄電装置１００と、主正母線ＭＰＬおよび主負母線ＭＮＬとで接続されている。平滑コンデンサＣは、主正母線ＭＰＬと主負母線ＭＮＬとの間に接続されており、導通する電力の高周波成分を低減する。第３電圧センサ１４２は、主正母線ＭＰＬと主負母線ＭＮＬとの間の電圧Ｖｈを検出し、検出された電圧Ｖｈは、ＰＤＵ１４１の制御に利用される。
【００１４】ＰＤＵ１４１は、主正母線ＭＰＬおよび主負母線ＭＮＬから供給される駆動電力（直流電力）を交流電力に変換してモータジェネレータＭＧへ出力する。モータジェネレータＭＧは、例えば、三相交流回転電機を含む。モータジェネレータＭＧは、動力伝達機構およ 50(6) JP 5980458 B1 2016.8.31び駆動軸を介して車輪を回転させる。また、ＰＤＵ１４１は、車輪の減速時においてモータジェネレータＭＧが発電する交流電力を直流電力に変換し、回生電力として主正母線ＭＰＬおよび主負母線ＭＮＬへ出力する。
【００１５】蓄電装置１００が備える第１蓄電池１１１および第２蓄電池１２１は、モータジェネレータが発電する回生電力と、外部電源１５３からの外部電力とによって充電される。
【００１６】充電コンバータ１５１は、主正母線ＭＰＬおよび主負母線ＭＮＬと受電部１５２との間に設けられる。そして、充電コンバータ１５１は、受電部１５２を介して外部電源１５３（例えば家庭用ＡＣ電源）から供給される交流電力を直流電力に変換して主正母線ＭＰＬ 10および主負母線ＭＮＬへ出力する。受電部１５２は、外部電源１５３から供給される交流電力を入力するための入力端子である。なお、充電コンバータ１５１は、主正母線ＭＰＬおよび主負母線ＭＮＬに代えて、あるいは追加して、正極線ＰＬ１および負極線ＮＬ１に接続されていても良く、正極線ＰＬ２および負極線ＮＬ２に接続されていても良い。
【００１７】蓄電装置１００は、第１蓄電モジュール１０１、第２蓄電モジュール１０２および充放電回路モジュール１０３を含む。第１蓄電モジュール１０１は、第１蓄電池１１１、第１電圧センサ１１２、第１電流センサ１１３、および第１スイッチ１１４を有する。第２蓄電モジュール１０２は、第１蓄電モジュール１０１と同様の構成であり、第２蓄電池１２１、第２電圧センサ１２２、第２電流センサ１２３、および第２スイッチ１２４を有する 20。充放電回路モジュール１０３は、第１蓄電池１１１と第２蓄電池１２１の間の充放電を担う。充放電回路モジュール１０３は、制御部としての電池ＥＣＵ１３０と、充放電回路として機能しうる第１ＶＣＵ１３１、第２ＶＣＵ１３２、および第３スイッチ１３３とを有する。
【００１８】本実施形態において第１蓄電部として機能する第１蓄電池１１１、および第２蓄電部として機能する第２蓄電池１２１は、充放電可能な直流電源であり、たとえば、リチウムイオン電池やニッケル水素電池、ナトリウムイオン電池、リチウム硫黄電池などの二次電池を含む。他にも、コンデンサ、キャパシタなどの充放電が可能な素子であっても良い。ただし、第１蓄電池１１１と第２蓄電池１２１は、互いに特性が異なる電池である。具体的 30には、第１蓄電池１１１は第２蓄電池１２１より単位質量あたりの出力電力である質量出力密度が大きい、いわゆる高出力型バッテリである。一方、第２蓄電池１２１は第１蓄電池１１１より単位質量あたりの貯蔵電力である質量エネルギー密度が大きい、いわゆる高容量型バッテリである。第１蓄電池１１１は第２蓄電池１２１より単位容積あたりの出力電力である容積出力密度が大きくて良く、第２蓄電池１２１は第１蓄電池１１１より単位容積あたりの貯蔵電力である容積エネルギー密度が大きくて良い。このように、単位質量または単位容積あたりに第１蓄電池１１１から取り出せる電力は、単位質量または単位容積あたりに第２蓄電池１２１から取り出せる電力より大きい。一方、単位質量または単位容積あたりに第１蓄電池１１１が貯蔵する電力は、単位質量または単位容積あたりに第２蓄電池１２１が貯蔵する電力より小さい。このように、第１蓄電池１１１は、第２蓄電池 40１２１と比して、エネルギー密度が劣り、出力密度が優れる。
【００１９】第１蓄電池１１１は、正極線ＰＬ１および負極線ＮＬ１を介して第１ＶＣＵ１３１に接続されている。第１電圧センサ１１２は、正極線ＰＬ１と負極線ＮＬ１との間の電圧すなわち第１蓄電池１１１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。１第１電流センサ１１３は、第１蓄電池１１１に対して入出力される電流Ｉ を検出し、そ１の検出値を電池ＥＣＵ１３０へ出力する。
【００２０】第１スイッチ１１４は、正極線ＰＬ１と負極線ＮＬ１の電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。 50１(7) JP 5980458 B1 2016.8.31第１スイッチ１１４が開状態であるときに第１電圧センサ１１２によって検出されるＶ１は、第１蓄電池１１１におけるＯＣＶであるＯＣＶ となる。１
【００２１】第２蓄電池１２１は、正極線ＰＬ２および負極線ＮＬ２を介して第２ＶＣＵ１３２に接続されている。第２電圧センサ１２２は、正極線ＰＬ２と負極線ＮＬ２との間の電圧すなわち第２蓄電池１２１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。２第２電流センサ１２３は、第２蓄電池１２１に対して入出力される電流Ｉ を検出し、そ２の検出値を電池ＥＣＵ１３０へ出力する。
【００２２】第２スイッチ１２４は、正極線ＰＬ２と負極線ＮＬ２の電路を開閉するスイッチであり 10、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。２第２スイッチ１２４が開状態であるときに第２電圧センサ１２２によって検出されるＶ２は、第２蓄電池１２１におけるＯＣＶであるＯＣＶ となる。２
【００２３】なお、第１電流センサ１１３および第２電流センサ１２３は、それぞれ対応する蓄電池から出力される電流（放電電流）を正値として検出し、入力される電流（充電電流および回生電流）を負値として検出する。図１では、それぞれ正極線の電流を検出する構成として示すが、負極線の電流を検出するように構成しても良い。
【００２４】第１ＶＣＵ１３１は、正極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接 20続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ を受けて、正１極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。第２ＶＣＵ１３２は、正極線ＰＬ２および負極線ＮＬ２と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ２を受けて、正極線ＰＬ２および負極線ＮＬ２と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。
【００２５】接続正極線ＢＰＬは、主正母線ＭＰＬと接続され、接続負極線ＢＮＬは、主負母線ＭＮＬに接続される。その接続部には、第３スイッチ１３３が設けられている。第３スイッチ１３３は、接続正極線ＢＰＬと主正母線ＭＰＬ、および接続負極線ＢＮＬと主負母線ＭＮ 30Ｌの電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受け３て、開状態と閉状態を切り替える。
【００２６】以上の構成においては、第１スイッチ１１４と第３スイッチ１３３を閉状態、第２スイッチ１２４を開状態とした場合には、第１蓄電池１１１の電力がＰＤＵ１４１へ供給される。また、第２スイッチ１２４と第３スイッチ１３３を閉状態、第１スイッチ１１４を開状態とした場合には、第２蓄電池１２１の電力がＰＤＵ１４１へ供給される。また、第１スイッチ１１４と第２スイッチ１２４と第３スイッチ１３３を閉状態とした場合には、第１蓄電池１１１の電力と第２蓄電池１２１の電力が共にＰＤＵ１４１へ供給される。ただし、第１蓄電池１１１の電力と第２蓄電池１２１の電力を共にＰＤＵ１４１へ供給する場 40合には、供給電圧が同じになるように、第１ＶＣＵ１３１および第２ＶＣＵ１３２によって電圧変換が成される。なお、ＰＤＵ１４１から回生電力が供給される場合、または外部電源１５３から外部電力が供給される場合には、電力の流れは上記の各場合における逆向きとなる。
【００２７】また、本実施形態においては、それぞれの蓄電池に電圧変換ユニットであるＶＣＵを設けるいわゆる２ＶＣＵ方式を採用するが、一方の蓄電池の出力電圧に対して他方の蓄電池の出力電圧を調整する観点からは、いずれかに一つのＶＣＵを設けるいわゆる１ＶＣＵ方式を採用しても良い。１ＶＣＵ方式であれば、ＶＣＵを設置するスペースの削減に寄与する。また、コストの削減、重量の削減にも寄与する。この場合には、ＰＤＵ１４１へ供給 50(8) JP 5980458 B1 2016.8.31される電圧は、ＶＣＵが設けられない蓄電池の出力電圧となるが、この制約が不都合である場合には２ＶＣＵ方式を採用すれば良い。
【００２８】なお、コンバータは、大別すると昇圧型、降圧型、昇降圧型に分類されるが、第１ＶＣＵ１３１、第２ＶＣＵ１３２は、いずれの型のコンバータも採用し得る。また、第１ＶＣＵ１３１、第２ＶＣＵ１３２に採用するコンバータの型を異ならせても良い。第１蓄電池１１１および第２蓄電池１２１とコンバータの型を適宜組み合わせることにより、要求仕様を満たす全体としてあたかも一つのバッテリとして利用することができる。
【００２９】第１スイッチ１１４と第２スイッチ１２４を閉状態、第３スイッチ１３３を開状態とし 10た場合には、第１蓄電池１１１と第２蓄電池１２１の間で充放電が行われる。この蓄電池部間充放電は、電池ＥＣＵ１３０からの制御信号ＣＶ によって決定される第１ＶＣＵ１１３１の変換電圧値と、制御信号ＣＶ によって決定される第２ＶＣＵ１３２の変換電圧値２との差に応じて、電力の流れが定まる。したがって、電池ＥＣＵ１３０は、変換電圧値を指示する制御信号ＣＶ およびＣＶ をそれぞれのＶＣＵに送信することにより、どちら１ ２の蓄電池を電力の供給側とし、どちらの蓄電池を電力の受容側とするか制御することができる。なお、第１ＶＣＵ１３１と第２ＶＣＵ１３２の一方のハイサイドスイッチを「閉」かつローサイドスイッチを「開」に固定することで電圧変換を停止し、蓄電池の出力電圧をそのまま出力するいわゆる直結モードで制御して、他方の変換電圧値を変更するように制御しても良い。このとき、電池ＥＣＵ１３０は、Ｖ とＩ を監視すれば、第１蓄電池 20１ １１１１における充放電量を把握することができ、Ｖ とＩ を監視すれば、第２蓄電池１２ ２２１における充放電量を把握することができる。
【００３０】上記のように、本実施形態における蓄電装置１００は、互いに特性が異なる２つの蓄電池を備える。互いに特性が異なる複数の蓄電池を用いるシステムは、それぞれの蓄電池の特性や状態に応じて、要求される電力の供給に対してどのように応えるか、細かく制御する必要がある。そこでまず、単一の蓄電池を用いた場合による電力出力と、特性が異なる複数の蓄電池を用いた場合による電力出力の違いについて説明する。
【００３１】図２は、単一の蓄電池を用いた場合による電力出力と、特性が異なる２つの蓄電池を用 30いた場合による電力出力とを比較するための図である。横軸は時間経過を表わし、縦軸は電力出力を表わす。電力出力が負の領域は、例えば回生電力によって電力受容がなされることを表わす。
【００３２】実線で示されるＳＢは、蓄電装置が一つの蓄電池によって構成される場合の、出力電力の変化を表わす。蓄電装置が一つの蓄電池のみを備える場合には、負荷側から要求される電力をその能力の範囲において要求されるままに出力し、入力される電力をそのまま受け入れる。したがって、短時間で大きな出入力を行う場合もあり、蓄電池が急激に劣化するなどの問題もある。
【００３３】 40蓄電装置が特性の異なる２つの蓄電池によって構成される場合には、それぞれの特性に応じて出入力を分担することができる。点線で表わされるＯＢは、高出力型バッテリの出力電力の変化を表わし、二重線で表わされるＶＢは、高容量型バッテリの出力電力の変化を表わしている。各時間において、ＯＢの値とＶＢの値を足し合わせるとＳＢの値となる。すなわち、負荷側から要求される電力を、高容量型バッテリと高容量型バッテリで分担している様子を表わしている。
【００３４】一般的に高容量型バッテリは、高出入力および出入力の瞬間的な変動に対して劣化が進行するので、劣化の進行が抑制される範囲で出入力が行われるように制御されることが好ましい。したがって、ＯＢとＶＢの変化からわかるように、負荷側から大きな出入力が要 50(9) JP 5980458 B1 2016.8.31求される場合には、原則として高出力型バッテリ（ＯＢ）が担い、高出力型バッテリでも応えられない場合に、高容量型バッテリ（ＶＢ）が補助する制御が行われる。また、高容量型バッテリは、あまり高くない値で継続的に出力する場合に適しており、この場合は、高出力型バッテリの出力は抑えられる。また、高容量型バッテリは高いレートの充電に相当する回生電力を受け入れた場合に劣化しやすいという特性を有するので、回生電力はできる限り高出力型バッテリで受け入れる制御が行われる。なお、回生電力が高出力型バッテリで受け入れられる容量を上回る場合には、高容量型バッテリで受入れる以外に、ブレーキを動作させて回生電力の発生を低減しても良い。この場合、高容量型バッテリの劣化を抑制できる。
【００３５】 10また、高容量型バッテリと高出力型バッテリは、それぞれＳＯＣに基づく劣化影響度も大きく異なる。高容量型バッテリは、ＳＯＣが変動しても、劣化影響度が大きく変動することはない。換言すれば、ＳＯＣがいかなる値であっても劣化の進行に大きな影響を与えることはない。一方、高出力型バッテリは、ＳＯＣが変動すると、劣化影響度もその値に応じて大きく変動する。より詳述すると、ＳＯＣが３０〜７０％の中央域では、高出力型バッテリの劣化影響度は小さいが、この中央域から離れるに従って、劣化影響度は大きくなる。すなわち、中央域から離れるほど劣化が進む。したがって、高容量型バッテリのＳＯＣが、０〜３０％の低域や７０〜１００％の高域に属さないように、高容量型バッテリと高出力型バッテリの充放電量を調整することが好ましい。
【００３６】 20このように特性の異なる複数の蓄電池を利用することにより、それぞれの蓄電池の劣化を抑制しつつ、負荷側からのさまざまな出力要求に応えることができる。ただし、それぞれの蓄電池をどのように使い分け、どのような割合で出入力を混合させるかは、蓄電池の現在の状態を正確に把握して、その状態に応じて適宜変更、修正することが重要である。特に、刻々と変化するＳＯＣの正確な把握は、輸送機器の駆動制御に対して非常に重要である。
【００３７】そこで、蓄電池におけるＳＯＣとＯＣＶとの相関関係について説明する。図３は、ある電池のＳＯＣ−ＯＣＶカーブを示すグラフである。ＳＯＣ−ＯＣＶカーブは、ＳＯＣとＯＣＶの関係である相関情報の一例である。横軸は、ＳＯＣをパーセント（％）で表わし、 30縦軸は、ＯＣＶをボルト（Ｖ）で表わす。
【００３８】グラフ上に描かれる複数のカーブは、それぞれ異なる容量維持率に対するＳＯＣ−ＯＣＶカーブを表わしている。容量維持率は、使用が繰り返されることによる劣化や、経時による劣化の程度を示しており、具体的には、新品時において貯蔵できる電気量（１００％）に対して、満充電でどれだけの電気量を貯蔵できるかをパーセントで表したものである。例えば、使用を繰り返したある時点において満充電まで充電した場合に、初期の貯蔵電気量に対して８０％の電気量しか貯蔵できなくなった蓄電池は、容量維持率８０％の蓄電池である。換言すれば容量維持率がその蓄電池の劣化度合いを示していると言える。
【００３９】 40図３において、実線は容量維持率１００％の、点線は９０％の、一点鎖線は８０％の、二点鎖線は７０％の、破線は６０％のＳＯＣ−ＯＣＶカーブを表わす。なお、容量維持率が１００％でない場合のＳＯＣは、劣化が進んだ状態における満充電の貯蔵電気量を１００％とした場合の充電率である。劣化が進行すると、カーブが全体的に左上方向に遷移する様子がわかる。例えば、ＯＣＶが３．９０Ｖである場合に、容量維持率が９０％の場合のＳＯＣは７０％であるのに対し、容量維持率が７０％の場合のＳＯＣは６０％であると読み取れる。多くの蓄電池が概してこのような傾向の性質を示す。
【００４０】すなわち、蓄電装置が搭載する蓄電池が現時点においてどれくらい劣化が進行しているかにより、同じＯＣＶから推定されるＳＯＣが大きく異なってしまうことになる。つまり 50(10) JP 5980458 B1 2016.8.31、ＯＣＶを測定しても、蓄電池の劣化状態の考慮なしには、正確にＳＯＣを把握できないことになる。
【００４１】そこで、本実施形態における蓄電装置１００は、搭載する第１蓄電池１１１および第２蓄電池１２１のそれぞれに対して、予め定められた条件を満たす時点ごとに、ＳＯＣ−ＯＣＶカーブを確定するための充放電制御を実行する。
【００４２】図４は、ある時点においてＳＯＣ−ＯＣＶカーブを確定するまでの手順を説明するための図である。図３と同じく、横軸は、ＳＯＣをパーセント（％）で表わし、縦軸は、ＯＣＶをボルト（Ｖ）で表わす。また、示されている複数のカーブはそれぞれ、図３で用いた 10線種に従って、モデル化された蓄電池の、各容量維持率に対するＳＯＣ−ＯＣＶカーブを表わす。
【００４３】出願人は、さまざまな蓄電池に対して検討を重ねた成果として、容量維持率が互いに異なるＳＯＣ−ＯＣＶカーブであっても、あるＯＣＶに対するＳＯＣのばらつきが一定の範囲に収まる領域が、多くの蓄電池において存在することを発見した。このような領域を「基準領域」と呼ぶこととする。基準領域は、例えば、ＳＯＣが１００％に近い範囲で見受けられる。これは、蓄電池の満充電電圧におけるＳＯＣを１００％として定義しているため、蓄電池の電圧を満充電電圧の近傍とすれば、容量維持率によらずＳＯＣは１００％の近傍となるからである。図４の例では、ＯＣＶがＶ の範囲（Ｏ ≦Ｖ ＜Ｏ 20Ｒ ｍｉｎ ０ ｍａｘ）において、いずれの容量維持率であっても、残容量がＳ （Ｓ ≦Ｓ ＜ＳＲ ｍｉｎ ０ ｍａｘ）の範囲に収まることを表わしている。Ｖ の範囲のＯＣＶを「基準ＯＣＶ」と呼び、ＳＲの範囲のＳＯＣを「基準ＳＯＣ」と呼ぶこととする。Ｒ
【００４４】基準領域の範囲としては、基準ＯＣＶの範囲として０．１Ｖ（Ｏ とＯ の差ｍａｘ ｍｉｎ）、基準ＳＯＣの範囲として３％（Ｓ とＳ の差）が好ましい。ここでいう基ｍａｘ ｍｉｎ準ＯＣＶの範囲は、単セルにおける電圧の範囲であって良い。基準ＯＣＶの範囲は、蓄電池の公称電圧の３％であって良い。基準領域の範囲は、対象とする蓄電池の特性や、要求される正確性等に応じて、適宜最適化すれば良い。
【００４５】 30本実施形態における蓄電装置１００は、上記の通り、第１蓄電池１１１と第２蓄電池１２１の間で蓄電池部間充放電を行うことができる。すなわち、一方の蓄電池の電力を他方に移すことができる。すると、蓄電池部間充放電を行うことにより、ＳＯＣ−ＯＣＶカーブを確定させたい側の蓄電池のＯＣＶを、その蓄電池における基準ＯＣＶの範囲に移動させることができる。基準ＯＣＶに対応するＳＯＣは、容量維持率に関わらず基準ＳＯＣであるので、その値を例えばＳ とＳ の平均値とすれば、ＳＯＣ−ＯＣＶの２次ｍｉｎ ｍａｘ元平面（ここでは、「ＳＯ平面」と呼ぶ）上の基準領域に、座標Ｓｐ （Ｓｔ ，Ｏｔ０ ０ ０）をプロットすることができる。
【００４６】その後、予め定められた条件、回数にしたがって、蓄電池部間充放電を繰り返す。この 40とき、例えばＳＯＣ−ＯＣＶカーブを確定させたい側の蓄電池が第１蓄電池１１１である場合には、第１電流センサ１１３の電流Ｉ を監視することにより、第１蓄電池１１１の１ＳＯＣの増減分を算出することができる。また、第１スイッチ１１４を開状態にすれば、そのときの第１蓄電池１１１のＯＣＶを検出することもできる。すると、１回の蓄電池部間充放電を行うごとに、ＳＯ平面上に１つの座標Ｓｐをプロットすることができる。図４の例では、基準領域内の座標Ｓｐ を得た後に、蓄電池部間充放電を３回繰り返し、座標０Ｓｐ 、Ｓｐ 、Ｓｐ を得ている。１ ２ ３
【００４７】例えば電池メーカーによって、蓄電池の型番ごとに各容量維持率に対するＳＯＣ−ＯＣＶカーブが参照データとして予め準備されている。図４では、１００％、９０％、８０％ 50(11) JP 5980458 B1 2016.8.31、７０％、６０％のそれぞれにおけるＳＯＣ−ＯＣＶカーブが参照データである。参照データは、例えば５％刻み、あるいは１％刻みなどの、より細かい割合で準備されていると良い。または、容量維持率に対するＳＯＣ−ＯＣＶカーブの変動が大きい範囲では、小さい範囲より細かい割合で参照データを設けていても良く、データ量および参照データを準備に要する手間を削減できる。蓄電装置１００は、具体的には後述するが、この参照データを記憶部に記憶しており、電池ＥＣＵ１３０は、適宜参照することができる。
【００４８】蓄電池部間充放電を繰り返すことにより複数の座標Ｓｐを得たら、電池ＥＣＵ１３０は、これらの座標に対して最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データからマッチング処理により選ぶ。例えば、複数の座標Ｓｐとの偏差が最も小さいＳＯＣ−ＯＣＶカー 10ブを選ぶ。このとき選んだＳＯＣ−ＯＣＶカーブが、その時点における最も確からしいＳＯＣ−ＯＣＶカーブとなる。このようにして、その時点における蓄電池のＳＯＣ−ＯＣＶカーブを推定する。図４の例においては、容量維持率が９０％のＳＯＣ−ＯＣＶカーブである。このＳＯＣ−ＯＣＶカーブを記憶しておくことにより、外部から要求されるＳＯＣの確認に対して、ＯＣＶを計測すれば即座にその時点における高精度なＳＯＣを返すことができる。このように蓄電池部間充放電を行って適宜確定されるＳＯＣ−ＯＣＶカーブは、その時点における現実のＳＯＣ−ＯＣＶカーブをより忠実に表わしたものとなるので、現実のＳＯＣに対して非常に近いＳＯＣを外部からの確認要求に対して返すことができる。
【００４９】 20なお、上記の説明においては、まず基準領域内に座標Ｓｐ が得られるように蓄電池部０間充放電をおこなったが、座標Ｓｐを得る順番はこれに限らない。複数回の蓄電池部間充放電を行った結果、少なくとも１つの座標Ｓｐが基準領域内に含まれていれば、参照データとマッチング処理を行うことができる。一方の蓄電池のＳＯＣとＯＣＶを基準領域にすべく、過度な蓄電部間充放電を必要とする場合は、複数回の蓄電部間充放電によって、複数の座標を得ながらＳＯＣ−ＯＣＶカーブを生成する蓄電池の電圧とＳＯＣを基準領域に移すことが好ましい。そして、複数回の蓄電部間充放電によって得た座標を基準領域に基づいて修正することで、基準領域にＳＯＣ−ＯＣＶカーブを生成する蓄電部の電圧とＳＯＣを基準領域に属するためだけに、過度の蓄電部間充放電を必要としない、正確なＳＯＣ−ＯＣＶカーブを生成できる。 30
【００５０】また、上記の説明においては、最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データから選んだが、まずはそれぞれの座標の偏差が閾値以下となる複数のＳＯＣ−ＯＣＶカーブを選び、その中から他の基準に基づいて一つのＳＯＣ−ＯＣＶカーブを確定させても良い。他の基準としては、新しく取得した座標ほど偏差が小さいなどが挙げられる。この様な構成とすることで、何らかの事情によって途中で蓄電部間充放電を停止しなければならい状態でも、ＳＯＣ−ＯＣＶカーブを特定できる。
【００５１】ここで、蓄電池部間充放電をおこなって次の座標Ｓｐを確定させる手順について説明する。図５は、平面空間上で座標を確定させるための演算を説明する図である。一つ目の× 40印で表わされるＳｐ は、ｎ個目の座標としてＳＯ平面上にプロットされたものであり、ｎ座標値（Ｓｔ ，Ｏｔ ）で表わされる。この後に１回の蓄電池部間充放電を行ってプロｎ ｎットされたｎ＋１個目の座標が、二つ目の×印で表わされるＳｐ である。ｎ＋１
【００５２】それぞれの座標値の差は、ＯＣＶがΔＯＣＶ、ＳＯＣがΔＳＯＣと表わされ、それぞれ正の値の場合もあれば、負の値である場合もある。すなわち、（Ｓｔ ，Ｏｔ ）＝（Ｓｔ ＋ΔＳＯＣ，Ｏｔ ＋ΔＯＣＶ）ｎ＋１ ｎ＋１ ｎ ｎである。ここで、Ｏｔ もＯｔ も、ＯＣＶであるので、これらの値は実測して直ｎ ｎ＋１接得られる。一方ΔＳＯＣは、ΔＳＯＣ＝Ｓｔ −Ｓｔ であり、ｎ＋１ ｎΔＳＯＣ＝ΣＩ／Ｃ 50ｆｕｌｌ(12) JP 5980458 B1 2016.8.31あるいは、ΔＳＯＣ＝ΔＡｈ／Ｃｆｕｌｌによって算出される。ここで、ΣＩは、時刻ｔ からｔ までに電流センサが出力ｎ ｎ＋１する値の総和であり、ΔＡｈは、この間に変化した電気量を表わす。また、Ｃ はｆｕｌｌ、前回のＳＯＣ−ＯＣＶカーブの確定時点における満充電時の電気量である。Ｃｆｕｌｌは、ＳＯＣ−ＯＣＶカーブが確定されるごとにその値が記憶部に格納される。例えばＣｆは、ＳＯＣ−ＯＣＶカーブが確定されると、確定されたＳＯＣ−ＯＣＶカーブに対ｕｌｌ応する容量維持率と初期容量から定まる。
【００５３】なお、以上の説明では主として、ＳＯＣ−ＯＣＶカーブの確定処理を分かり易く説明す 10ることを目的として、二次元平面における座標ＳＰを用いて説明した。座標ＳＰをプロットする、または、座標ＳＰを特定することは、内部処理としては、（ＳＯＣ，ＯＣＶ）のデータを取得して格納することに対応する。また、以上の説明では主として、ＳＯＣ−ＯＣＶカーブの確定処理を分かり易く説明することを目的として、ＳＯＣ毎について１つのＯＣＶを取得する場合を取り上げて説明した。しかし、ＳＯＣ毎に１つまたは複数のＯＣＶを取得して良い。
【００５４】以上説明したＳＯＣ−ＯＣＶカーブの確定までを電池ＥＣＵ１３０がどのようにおこなっているのか、電池ＥＣＵ１３０を機能ブロックで表わして説明する。図６は、電池ＥＣＵ１３０の内部ブロック図を、電池ＥＣＵ１３０用のプログラムを格納する記録媒体２９ 20０とともに示す。
【００５５】図示するように、電池ＥＣＵ１３０は、制御および演算の全体を担う制御演算部２３０、ΔＳＯＣ算出部２３１、計時部２３２、ＢＡＴＴ情報格納部２３３、確定ライン保持部２３４を有する。これらの機能ブロックによりＳＯＣ−ＯＣＶカーブを確定するまでの処理を行う。電池ＥＣＵ１３０は、この他にも主に、ＳＯＣ応答部２３５を有する。
【００５６】制御演算部２３０は、第１蓄電池１１１と第２蓄電池１２１の少なくとも一方を、対象蓄電池とする。対象蓄電池とは、例えばＳＯＣ−ＯＣＶカーブの推定対象となる蓄電池である。制御演算部２３０は、予め定められた選択条件によって、第１蓄電池１１１と第２ 30蓄電池１２１の少なくとも一方を、対象蓄電池として選択して良い。制御演算部２３０は、第１蓄電池１１１と第２蓄電池１２１がＳＯＣ−ＯＣＶカーブの推定対象となる蓄電池に選択された場合に、出力密度がより優れる第１蓄電池１１１を対象蓄電池として選択して良い。制御演算部２３０は、対象蓄電池の充電率と電圧である対象ＳＯＣと対象ＯＣＶを取得し、第１蓄電池１１１と第２蓄電池１２１の間の電荷移動を用いて、対象ＳＯＣと対象ＯＣＶを含むデータを、データの集合である収集済データのＳＯＣに対する離散状態と対象ＳＯＣに基づく評価関数より導出される順序で収集し、当該複数のデータに基づき、対象蓄電部のＳＯＣとＯＣＶの相関情報を推定する。なお、対象ＳＯＣと対象ＯＣＶを含むデータを、（ＳＯＣ，ＯＣＶ）データと呼ぶ場合がある。
【００５７】 40制御演算部２３０は、収集済データに基づき収集していないデータの集合である未収集データを導出する。評価関数は、未収集データに含まれるＳＯＣである未収集ＳＯＣを収集した場合の離散状態に基づく関数であって良い。評価関数は、未収集ＳＯＣを収集した場合の離散状態の変化量に基づく関数であって良い。評価関数は、収集した場合の離散状態が大きくなる未収集ＳＯＣを含むデータほど、高く評価する関数であって良い。評価関数は、未収集ＳＯＣと対象ＳＯＣの差分から算出される電荷移動に要する時間を含む操作時間にさらに基づく関数であって良い。操作時間は、電荷移動の後において対象蓄電部の電圧の時間変化が安定するまでに要する時間を含んで良い。評価関数は、操作時間が短い未収集ＳＯＣを含むデータほど、高く評価する関数であって良い。評価関数は、操作時間より離散状態の変化量を強く評価する関数であって良い。 50(13) JP 5980458 B1 2016.8.31
【００５８】なお、制御演算部２３０は、対象蓄電池の複数の劣化状態において同一のＳＯＣに対するＯＣＶの差分が閾値以下となるＳＯＣである基準ＳＯＣの範囲に対象蓄電池のＳＯＣが含まれるときからの対象蓄電池への電荷移動量に基づいて、対象ＳＯＣを取得して良い。また、制御演算部２３０は、基準ＳＯＣに対応するＯＣＶである基準ＯＣＶの範囲に対象蓄電池のＳＯＣが含まれるときからの対象蓄電池への電荷移動量に基づいて、対象ＳＯＣを取得して良い。制御演算部２３０は、基準ＳＯＣと基準ＯＣＶが、対象ＳＯＣと対象ＯＣＶとして含まれるように、（ＳＯＣ，ＯＣＶ）データを収集して良い。
【００５９】制御演算部２３０は、電荷移動を行う前の対象蓄電池のＳＯＣが基準ＳＯＣの範囲に含 10まれない場合に、電荷移動に先立ち、対象蓄電池のＳＯＣが基準ＳＯＣの範囲に含まれるよう、第１蓄電池１１１と第２蓄電池１２１との間の充放電を行って良い。制御演算部２３０は、電荷移動を行う前の対象蓄電池のＯＣＶが基準ＯＣＶの範囲に含まれない場合に、対象蓄電池のＯＣＶが基準ＯＣＶの範囲に含まれるよう、第１蓄電池１１１と第２蓄電池１２１との間の充放電を行って良い。
【００６０】第１蓄電池１１１と第２蓄電池１２１の少なくとも一方は、モータジェネレータＭＧに電力を供給する。なお、モータジェネレータＭＧは駆動部の一例である。充放電回路モジュール１０３は、第１蓄電池１１１、第２蓄電池１２１、およびモータジェネレータＭＧの間の充放電を担って良い。制御演算部２３０は、電荷移動を行う間、第１蓄電池１１１ 20と第２蓄電池１２１が、駆動部との間で充放電を行わないよう充放電回路モジュール１０３を制御して良い。なお、制御演算部２３０は、第２蓄電池１２１より、エネルギー密度が劣り、出力密度が優れる第１蓄電池１１１を、対象蓄電部として優先して選択して良い。
【００６１】なお、電池ＥＣＵ１３０は一種のコンピュータである。制御演算部２３０は、例えばＭＰＵによって構成され、例えばＭＰＵの内部記憶部に格納されたプログラムを実行し、当該プログラムに従って蓄電装置１００の全体を制御する。電池ＥＣＵ１３０により実行されるプログラムは、記録媒体２９０から電池ＥＣＵ１３０に供給される。なお、記録媒体２９０は、コンピュータにより読み出し可能な媒体の一例である。電池ＥＣＵ１３０内に 30おいてプログラムまたはコンピュータ命令が格納される任意の媒体を、電池ＥＣＵ１３０用のプログラムを格納する媒体とみなすことができる。
【００６２】制御演算部２３０は、充放電回路モジュール１０３を制御する。また、制御演算部２３０は、第１スイッチ１１４、第２スイッチ１２４、第３スイッチ１３３を状況に応じて開閉すべく、開閉指示信号ＣＷ 、ＣＷ 、ＣＷ をそれぞれに向けて送信する。また、第１ ２ ３１ＶＣＵ１３１、第２ＶＣＵ１３２の変換電圧を調整すべく、ＰＷＭ信号である制御信号ＣＶ 、ＣＶ をそれぞれに向けて送信する。ΔＳＯＣ算出部２３１は、第１蓄電池１１１ ２１の（ＳＯＣ，ＯＣＶ）データの取得時には、第１電流センサ１１３からＩ を取得して１、ΔＳＯＣを算出する。同様に、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データの取得時 40には、第２電流センサ１２３からＩ を取得して、ΔＳＯＣを算出する。ΔＳＯＣ算出部２２３１は、算出したΔＳＯＣを制御演算部２３０へ引き渡す。
【００６３】計時部２３２は、蓄電池部間充放電を行った時刻を制御演算部２３０へ引き渡す。制御演算部２３０は、（ＳＯＣ，ＯＣＶ）データが取得された時刻を内部記憶部に記憶しておき、当該（ＳＯＣ，ＯＣＶ）データが取得された時刻から予め定められた経過時間を過ぎた場合に、マッチング処理の対象から除外する。
【００６４】ＢＡＴＴ情報格納部２３３は、上記の参照データを記憶する記憶部である。具体的には、不揮発性のフラッシュメモリ等により構成される。ＢＡＴＴ情報格納部２３３は、参照 50(14) JP 5980458 B1 2016.8.31データを外部機器から取得する。なお、ＢＡＴＴ情報格納部２３３は、参照データを記憶するに限らず、蓄電池に関する様々な情報を記憶しており、必要に応じて制御演算部２３０へ提供する。ＢＡＴＴ情報格納部２３３は、第１蓄電池１１１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報を予め記憶する。ＢＡＴＴ情報格納部２３３は、第２蓄電池１２１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報を予め記憶する。例えば、蓄電装置１００の製造時に、第１蓄電池１１１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報と、第２蓄電池１２１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報とが、ＢＡＴＴ情報格納部２３３に格納される。なお、第１蓄電池１１１および第２蓄電池１２１のうち、ＳＯＣ−ＯＣＶカーブの推定対象とならない蓄電池については、ＢＡＴＴ情報格納部２３３に相関情報が格納されなくても良い。制御演算部２３０は、ＢＡＴＴ情報 10格納部２３３が記憶している対象蓄電池の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報のうち、対象ＳＯＣと対象ＯＣＶを含む複数の（ＳＯＣ，ＯＣＶ）データに対する適合度がより高い相関情報を、推定する相関情報として、より優先して選択して良い。制御演算部２３０は、対象ＳＯＣと対象ＯＣＶを含む複数のデータに対する近似曲線または近似直線に基づき、相関情報を推定して良い。
【００６５】確定ライン保持部２３４は、制御演算部２３０が確定したＳＯＣ−ＯＣＶカーブを記憶する記憶部である。具体的には、不揮発性のフラッシュメモリ等により構成される。記憶部としてＢＡＴＴ情報格納部２３３と一体的に構成されていても良い。
【００６６】 20ＳＯＣ応答部２３５は、確定ライン保持部２３４と接続されている。ＳＯＣ応答部２３５は、外部からＳＯＣの問合せを受けると、ＯＣＶとしてＶ 、Ｖ を取得し、確定ライ１ ２ン保持部２３４に記憶されたＳＯＣ−ＯＣＶカーブを参照して、ＳＯＣを返す。制御演算部２３０により第１蓄電池１１１の相関情報が推定されている場合、ＳＯＣ応答部２３５は、第１蓄電池１１１のＳＯＣの問合せを受けたとき、第１蓄電池１１１のＯＣＶと、制御演算部２３０により推定された相関情報とに基づいて、第１蓄電池１１１のＳＯＣを算出して応答する。制御演算部２３０により第２蓄電池１２１の相関情報が推定されている場合、ＳＯＣ応答部２３５は、第２蓄電池１２１のＳＯＣの問合せを受けたとき、第２蓄電池１２１のＯＣＶと、制御演算部２３０により推定された相関情報とに基づいて、第２蓄電池１２１のＳＯＣを算出して応答する。 30
【００６７】図７は、（ＳＯＣ，ＯＣＶ）データとＳＯＣ−ＯＣＶカーブの確度との関係を説明するための図である。図７において、ＳＯＣ−ＯＣＶカーブ７８０は、容量維持率が８０％の場合のＳＯＣ−ＯＣＶカーブを示す。ＳＯＣ−ＯＣＶカーブ７７０は、容量維持率が７０％の場合のＳＯＣ−ＯＣＶカーブを示す。図示されるように、ＳＯＣが５０％、６０％、９０％および１００％のそれぞれの場合の（ＳＯＣ，ＯＣＶ）データが既に取得済みであるとする。また、現在のＳＯＣは６０％であるとする。
【００６８】ＳＯＣ−ＯＣＶの確定ラインを選択するために、１０％から１００％までの範囲内で１０％刻みのＳＯＣで、（ＳＯＣ，ＯＣＶ）データを取得することが予め定められていると 40する。具体的には、（ＳＯＣ，ＯＣＶ）データの取得対象となるＳＯＣは、１０％、２０％、３０％、４０％、５０％、６０％、７０％、８０％、９０％および１００％である。
【００６９】図示されるように、既に取得されている４点の（ＳＯＣ，ＯＣＶ）データはいずれも、ＳＯＣ−ＯＣＶカーブ７８０およびＳＯＣ−ＯＣＶカーブ７７０の近傍にある。そのため、現時点で収集済みの（ＳＯＣ，ＯＣＶ）データからは、確定ラインを高い確度で選択できない。
【００７０】この場合において、ＳＯＣを８０％にして（ＳＯＣ，ＯＣＶ）データを取得したとする。容量維持率が７０％であったと仮定し、符号７０３で示される（ＳＯＣ，ＯＣＶ）デー 50(15) JP 5980458 B1 2016.8.31タが取得されたとする。符号７０３で示される点は、ＳＯＣ−ＯＣＶカーブ７８０の近傍にも位置する。そのため、収集済みの５点の（ＳＯＣ，ＯＣＶ）データからは、現在のＳＯＣ−ＯＣＶカーブを高い確度で選択できない。
【００７１】一方、容量維持率が８０％であったと仮定し、符号７０４で示される（ＳＯＣ，ＯＣＶ）データが取得されたとする。この場合でも、符号７０３で示される点は、ＳＯＣ−ＯＣＶカーブ７７０の近傍にも位置する。そのため、この場合でも、収集済みの５点の（ＳＯＣ，ＯＣＶ）データからは、現在のＳＯＣ−ＯＣＶカーブを高い確度で選択できない。つまり、ＳＯＣが８０％の場合の（ＳＯＣ，ＯＣＶ）データを取得したとしても、現在のＳＯＣ−ＯＣＶカーブを高い確度で選択できない可能性が高い。 10
【００７２】これに対し、ＳＯＣを４０％にして（ＳＯＣ，ＯＣＶ）データを取得した場合について説明する。容量維持率が７０％であったと仮定し、符号７０１で示される（ＳＯＣ，ＯＣＶ）データが取得されたとする。符号７０１で示される点は、ＳＯＣ−ＯＣＶカーブ７７０の近傍に位置し、ＳＯＣ−ＯＣＶカーブ７８０からは離れている。そのため、収集済みの５点の（ＳＯＣ，ＯＣＶ）データから、現在のＳＯＣ−ＯＣＶカーブとして、ＳＯＣ−ＯＣＶカーブ７７０を高い確度で選択できる。
【００７３】また、容量維持率が８０％であったと仮定し、符号７０２で示される（ＳＯＣ，ＯＣＶ）データが取得されたとする。符号７０２で示される点は、ＳＯＣ−ＯＣＶカーブ７８０ 20の近傍に位置し、ＳＯＣ−ＯＣＶカーブ７７０からは離れている。そのため、この場合でも、収集済みの５点の（ＳＯＣ，ＯＣＶ）データから、現在のＳＯＣ−ＯＣＶカーブとして、ＳＯＣ−ＯＣＶカーブ７８０を高い確度で選択できる。つまり、ＳＯＣが４０％の場合の（ＳＯＣ，ＯＣＶ）データを取得することで、ＳＯＣが８０％の場合の（ＳＯＣ，ＯＣＶ）データを取得した場合と比べて、現在のＳＯＣ−ＯＣＶカーブを高い確度で選択できる可能性が高まる。
【００７４】したがって、ＳＯＣを４０％にして（ＳＯＣ，ＯＣＶ）データを取得することで、ＳＯＣ−ＯＣＶカーブを確定するのに有用なデータを取得できる可能性が高まる。そのため、１０％から１００％までの全てのＳＯＣで（ＳＯＣ，ＯＣＶ）データを取得しなくても、 30十分な確度でＳＯＣ−ＯＣＶカーブを確定できる場合がある。このように、次のデータの取得対象となるＳＯＣである取得対象ＳＯＣを４０％にすることで、取得対象ＳＯＣを８０％にする場合より、ＳＯＣ−ＯＣＶカーブを効率的に確定できる場合がある。
【００７５】発明者らが検討を重ねた結果、多くの蓄電部において取得済みの（ＳＯＣ，ＯＣＶ）データがＳＯＣに対してより離散した状態になるようにすることで、より正確なＳＯＣ−ＯＣＶカーブを効率的に確定できるようになることが期待できる。従って、制御演算部２３０は、ＳＯＣの離散度に基づいて、次に（ＳＯＣ，ＯＣＶ）データを取得するべきＳＯＣを決定する。
【００７６】 40図８は、ＳＯＣの離散度の算出例を示す。制御演算部２３０は、収集済みデータのＳＯＣの範囲を、データを取得済みであるＳＯＣの数で除算することにより、離散度を算出する。制御演算部２３０は、収集済みデータのＳＯＣの範囲を、（収集済みデータ中のＳＯＣの最大値−収集済みデータのＳＯＣの最小値＋１０％）により算出する。なお、これにより算出された離散度は、値が小さいほど、データの離散度合いが大きいことを示す。
【００７７】例えば、図８に示す状態において、ＳＯＣが８０％における（ＳＯＣ，ＯＣＶ）データを取得した場合、離散度は８．３３と算出される。同様に、ＳＯＣが４０％における（ＳＯＣ，ＯＣＶ）データを取得した場合、離散度は７．１４と算出される。ＳＯＣが３０％における（ＳＯＣ，ＯＣＶ）データを取得した場合、離散度は６．２５と算出される。ま 50(16) JP 5980458 B1 2016.8.31た、ＳＯＣが１０％における（ＳＯＣ，ＯＣＶ）データを取得した場合、離散度は５．００と算出される。
【００７８】データの離散度合いの観点からは、ＳＯＣが１０％におけるデータを取得することが最も望ましい。しかし、ＳＯＣが１０％におけるデータを取得するためには、ＳＯＣを現在の６０％から１０％になるまで蓄電池部間充放電を行う必要がある。そのため、他のＳＯＣのデータを取得する場合と比べて、データを取得するまでにかかる時間が長くなる。また、蓄電池間で大量の電荷移動を繰り返すことは好ましくない場合がある。そこで、制御演算部２３０は、離散度に加えて、電荷移動に要する時間を含む操作時間をさらに考慮して、次の取得対象のＳＯＣを選択する。 10
【００７９】図９は、電荷移動に要する時間Ｔ を算出するための情報を示す図である。横軸は、ＳＭＯＣをパーセント（％）で表わし、縦軸は、時間Ｔ を表わす。マッピング線７００は、ＭＳＯＣが６０％の状態から、蓄電池部間充放電によってＳＯＣが横軸で示す値になるまでに要する時間を示す。図示されるように、Ｔ は、電荷移動の前後のＳＯＣの差の大きさＭであるΔＳＯＣに略比例する。一例として、ΔＳＯＣの大きさが１０％の場合の時間ＴＭは、少なくとも数分以上、多くの場合に１０分以上であり得る。ＢＡＴＴ情報格納部２３３は、マッピング線７００を示す情報として、ΔＳＯＣを時間Ｔ にマッピングするマッＭピングテーブルＭを格納して良い。
【００８０】 20制御演算部２３０は、ＢＡＴＴ情報格納部２３３が格納するマッピングテーブルを参照して、ΔＳＯＣから時間Ｔ を算出する。例えば、制御演算部２３０は、現在のＳＯＣがＭ６０％の状態から、蓄電池部間充放電によってＳＯＣが４０％になるまでに要する時間Ｔを、ΔＳＯＣである２０％と、マッピングテーブルＭとを用いて算出する。ＭΔ２０
【００８１】操作時間には、電荷の移動に要する時間に加えて、取得対象のＳＯＣに到達してから（ＳＯＣ，ＯＣＶ）データを取得するのに要する時間Ｔ が含まれる。Ｔ は、ＳＯＣがデｄ ｄータの取得対象のＳＯＣである取得対象ＳＯＣｔに到達したタイミングから、１回のＯＣＶの計測値を取得するまでに要する時間である。Ｔ には、蓄電池の端子電圧の時間変化ｄが安定するのを待つ時間が含まれる。蓄電池の充放電後の開路状態における端子電圧は、 30多くの場合、時間と共に比較的ゆっくりと変化し、端子電圧の時間変化が実質的に無視できるようになるまでには一定の時間を要する。そのため、制御演算部２３０は、蓄電池の端子電圧の時間変化が安定する時間の経過を待って、端子電圧の計測値を取得する。
【００８２】よって、ＳＯＣが取得対象ＳＯＣｔに到達したタイミングから、１回のＯＣＶの計測値を取得するまでには、少なくともＴ の時間を要する。したがって、制御演算部２３０はｄ、操作時間Ｔ を、Ｔ ＝Ｔ ＋Ｔ により算出する。制御演算部２３０は、（ＳＯＣ，ｔ ｔ Ｍ ｄＯＣＶ）データを取得していない各ＳＯＣについて、操作時間Ｔ を算出する。ｔ
【００８３】以上に説明したように、制御演算部２３０は、ＳＯＣ毎に離散度および操作時間を算出 40する。そして、制御演算部２３０は、ＳＯＣ毎の離散度および操作時間から、評価関数を用いて、ＳＯＣ毎に評価値を算出する。評価値は、次の取得対象のＳＯＣを選択するために用いられる。
【００８４】図１０は、ＳＯＣ毎に算出された離散度、操作時間及び評価値の一例を示す。制御演算部２３０は、離散度および操作時間について、それぞれの最大値で除算することで、規格化する。そして、制御演算部２３０は、規格化した離散度及び規格化した操作時間を、離散度及び操作時間をパラメータとして持つ評価関数に入力して、評価値を算出する。
【００８５】一例として、評価関数は重み付け加算を行う関数であって良い。例えば、規格化した離 50(17) JP 5980458 B1 2016.8.31散度を＜ｗ＞、規格化した操作時間を＜Ｔｔ＞とする場合に、評価関数は、α×＜Ｔｔ＞＋β×＜ｗ＞により評価値を出力する関数であって良い。
【００８６】図１０は、α＝０．４、β＝０．６の場合の評価関数により得られた評価値を示す。制御演算部２３０は、算出した評価値から、次の取得対象のＳＯＣを選択する。図８に関連して説明した離散度は、値が小さいほど、データの離散度合いが大きいことを示す。また、図９に関連して説明した操作時間は、値が小さいほど、より速やかにデータを取得できることを示す。そのため、制御演算部２３０は、より小さい評価値が算出されたＳＯＣを、より優先して、次の取得対象ＳＯＣとして選択する。図１０の例では、最も小さい評価値が算出された４０％を、次の取得対象ＳＯＣとして選択する。 10
【００８７】なお、βは、αより大きいことが望ましい。すなわち、評価値における離散度の重みを、操作時間の重みより大きくすることが望ましい。これにより、頻繁な蓄電部間の電荷移動により生じる損失を抑えつつ、より確度が高いＳＯＣ−ＯＣＶカーブを選択することができるデータを速やかにかつ必要十分に取得できることが期待できる。
【００８８】図１１は、ＳＯＣ−ＯＣＶカーブを確定させるまでのフロー図である。フローは、電池ＥＣＵ１３０がＳＯＣ−ＯＣＶカーブを確定させる指示を輸送機器１０の制御部から受け取った時点から開始する。なお、ここでは、第１蓄電池１１１を対象蓄電部として選択して、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定させる場合について説明する。 20
【００８９】制御演算部２３０は、ステップＳ１０１において、第１蓄電池１１１のＯＣＶが取得可能か否かを判断する。例えば、ＰＤＵ１４１が電力の供給を要求している場合には、当該要求を優先して第１スイッチ１１４および第３スイッチ１３３を閉状態にするので、ＯＣＶの取得はできないと判断する。この場合は、取得できる状態になるまで待機する。
【００９０】ＯＣＶの取得が可能と判断したら、制御演算部２３０は、ステップＳ１０２へ進み、開閉指示信号ＣＷ を第１スイッチ１１４へ送信して開状態とする。そして、第１電圧セン１サ１１２からＶ を取得し、当該電圧値を初期ＯＣＶであるＯ とする。制御演算部２３１ ００は、ステップＳ１０３で、取得したＯ が、基準ＯＣＶの範囲に含まれるか否かを判断 30０する。具体的には、制御演算部２３０は、ＢＡＴＴ情報格納部２３３から第１蓄電池１１１の参照情報を取得し、基準ＯＣＶの範囲Ｏ 〜Ｏ を参照する。そして、Ｏｍｉｎ ｍａｘ ｍ≦Ｏ ＜Ｏ の関係を満たすか否かを判断する。ｉｎ ０ ｍａｘ
【００９１】取得したＯ が基準開放電圧の範囲に含まれないと判断したら、ステップＳ１０４へ進０み、制御演算部２３０は、蓄電池部間充放電を実行する。具体的には、制御演算部２３０は、開閉指示信号ＣＷ 、ＣＷ 、ＣＷ をそれぞれのスイッチに向けて送信して、第１１ ２ ３スイッチ１１４と第２スイッチ１２４を閉状態、第３スイッチ１３３を開状態とする。そして、制御信号ＣＶ 、ＣＶ をそれぞれのＶＣＵに向けて送信して、第２ＶＣＵ１３２１ ２の変換電圧値を第１ＶＣＵ１３１の変換電圧値よりも高く設定する。すると、第２蓄電池 40１２１は放電状態となり、第１蓄電池１１１は充電状態となるので、一定の電荷が第２蓄電池１２１から第１蓄電池１１１へ移動する。制御演算部２３０は、移動させる電荷の電気量を、各スイッチの開閉時間を調整したり、各ＶＣＵの変換電圧値を調整したりすることによって変更し得る。また、制御演算部２３０は、取得したＯ と基準ＯＣＶの範囲Ｏ０〜Ｏ との差に応じて、移動させる電荷の電気量を決定しても良い。ｍｉｎ ｍａｘ
【００９２】なお、２つのＶＣＵを用いて蓄電池部間充放電を実行する場合には、一方のＶＣＵのみをＰＷＭ制御し、他方のＶＣＵは直結制御を行っても良い。直結制御は、ＤＣ／ＤＣコンバータのハイサイドスイッチのみを閉状態とし、昇降圧せずに電流を通過させる制御である。直結制御を行う場合に制御信号ＣＶ 、ＣＶ は、変換電圧の指令値として「０」が 50１ ２(18) JP 5980458 B1 2016.8.31指定される。
【００９３】ステップＳ１０４で蓄電池部間充放電が完了すると、再びステップＳ１０１へ戻り、ステップＳ１０３の条件を満たすまで、このループを繰り返す。ステップＳ１０３の条件を満たしたら、ステップＳ１０５へ進む。
【００９４】ステップＳ１０５では、制御演算部２３０は、（ＳＯＣ ，ＯＣＶ）のデータをｆｕｌｌ内部記憶部に格納する。ここで、ＳＯＣ は、１００％のＳＯＣに対応する値であｆｕｌｌる。ＳＯＣ を１００％として良い。また、ＳＯＣ を、Ｓ 以上Ｓｆｕｌｌ ｆｕｌｌ ｍｉｎ ｍ以下の値として良い。例えば、ＳＯＣ ＝（Ｓ ＋Ｓ ）／２として 10ａｘ ｆｕｌｌ ｍｉｎ ｍａｘ良い。
【００９５】ステップＳ１０７からは、蓄電池部間充放電を繰り返して（ＳＯＣ，ＯＣＶ）データを取得する処理である。制御演算部２３０は、ステップＳ１０７で、ＯＣＶの取得が可能か否かを判断する。この判断は、ステップＳ１０１の判断と同様である。ＯＣＶの取得が可能でない場合は、可能となるまで待機する。ＯＣＶの取得が可能であればステップＳ１０８へ進み、次の取得対象となるＳＯＣを決定して、ステップＳ１０９において、（ＳＯＣ，ＯＣＶ）のデータを取得する。なお、ステップＳ１０８における処理については後述する。
【００９６】 20制御演算部２３０は、ステップＳ１１０へ進み、取得対象の全ＳＯＣにおいてＯＣＶのデータを取得したか否かを判断する。まだ取得していないと判断したら、ステップＳ１１１へ進む。
【００９７】ステップＳ１１１は、次の（ＳＯＣ，ＯＣＶ）データを取得する処理を開始する時点で実行される。ステップＳ１１１では、取得対象の全ＳＯＣにおけるデータを、決められた時間以内に取得できたか否かを判断する。例えば、制御演算部２３０は、ステップＳ１０５で格納されたデータの取得時刻から、予め定められた規定時間が経過したか否かを判断する。規定時間は、例えば７日が設定される。規定時間は、走行距離、環境温度、ＳＯＣ−ＯＣＶカーブに要求される精度等に応じて変更し得る。制御演算部２３０は、規定時間 30が経過していないと判断したら、ステップＳ１０７へ戻り、取得対象のＳＯＣにおけるデータを順次に取得する。規定時間を経過したと判断したら、ステップＳ１０１間で戻る。この場合は、それまで取得した（ＳＯＣ，ＯＣＶ）データを破棄する。このように古いデータを破棄することで、異なる劣化状態で取得されたデータでＳＯＣ−ＯＣＶカーブが確定されなくなるので、確定されるＳＯＣ−ＯＣＶカーブの精度が向上する。
【００９８】ステップＳ１１０で、取得対象の全ＳＯＣにおいてデータを取得したと判断したら、ステップＳ１１２へ進み、制御演算部２３０は、取得した複数のデータからＳＯＣ−ＯＣＶカーブを確定する。具体的には、制御演算部２３０は、ＢＡＴＴ情報格納部２３３から第１蓄電池１１１の参照データを読み出し、それぞれの容量維持率に対するＳＯＣ−ＯＣＶ 40カーブの中から、取得した複数のデータと最も一致度が高くなるものを選ぶ。そして、このように選んだＳＯＣ−ＯＣＶカーブを確定されたＳＯＣ−ＯＣＶカーブとして、確定ライン保持部２３４へ記憶する。制御演算部２３０は、確定したＳＯＣ−ＯＣＶカーブを確定ライン保持部２３４へ記憶したら、一連の処理を終了する。
【００９９】図１２は、次の取得対象となるＳＯＣを決定するまでのフロー図である。図１２に示すフローは、図１１のフローにおけるステップＳ１０８に適用される。
【０１００】ステップＳ３０１において、制御演算部２３０は、第１蓄電池１１１の現在のＳＯＣであるＳＯＣ を取得する。Ｓ３１１からＳ３１９までの処理は、ｉに関する繰り返し処理 50ｎ(19) JP 5980458 B1 2016.8.31を行って、取得対象の各ＳＯＣについての（ＳＯＣ，ＯＣＶ）データを取得するのに要する所要時間Ｔ を算出する処理である。説明を簡単にするため、このフロー図におけるｉｉは、取得対象のＳＯＣを示す。ｉの意味を分かり易く示すことを目的として、ｉ（ＳＯＣ）と記す場合がある。Ｓ３１１からＳ３１９までの繰り返し処理は、１０％から１００％の範囲内のＳＯＣについて１０％刻みで定めたＳＯＣにおけるデータを取得する場合を示す。
【０１０１】ステップＳ３１３において、制御演算部２３０は、現在のＳＯＣ とｉ（ＳＯＣ）とのｎ差であるΔＳＯＣを算出する。具体的には、制御演算部２３０は、ΔＳＯＣ＝ｉ（ＳＯＣ）−ＳＯＣ により、ΔＳＯＣを算出する。ステップＳ３１５において、制御演算部２３ 10ｎ０は、操作時間Ｔ を算出する。具体的には、図９等に関連して説明したように、制御ｔｉ演算部２３０は、マッピングテーブルＭを参照して算出した電荷移動時間Ｍ（ΔＳＯＣ）と、）データを取得するのに要する時間Ｔ との和によって、操作時間Ｔ を算出するｄ ｔｉ。
【０１０２】ステップＳ３１７において、制御演算部２３０は、ｉ（ＳＯＣ）でのＯＣＶ測定を行ったと過程した場合に得られる測定済みＳＯＣの離散度を算出する。例えば、図８等に関連して説明したように、制御演算部２３０は、ＯＣＶ測定を行ったと過程した場合に得られる（ＳＯＣ，ＯＣＶ）データの数を、測定済みＳＯＣの範囲で除算することによって、ＳＯＣの離散度を算出する。 20
【０１０３】ステップＳ３１１からステップＳ３１９までの繰り返し処理が終了すると、ステップＳ３３１において、制御演算部２３０は、算出した各操作時間を規格化する。例えば、制御演算部２３０は、算出した各操作時間を、操作時間の最大値で規格化する。
【０１０４】ステップＳ３３３において、制御演算部２３０は、算出した各離散度を規格化する。例えば、制御演算部２３０は、算出した各離散度を、離散度の最大値で規格化する。
【０１０５】ステップＳ３３５において、制御演算部２３０は、規格化した操作時間及び規格化した離散度を用いて、未取得ＳＯＣについて評価値を算出する。例えば、図１０等に関連して 30説明したように、制御演算部２３０は、規格化した操作時間及び規格化した離散度に評価関数を適用して、評価値を算出する。
【０１０６】ステップＳ３３１において、制御演算部２３０は、次の取得対象となるＳＯＣを決定する。具体的には、制御演算部２３０は、Ｓ３３５で算出した評価値に基づいて、次の取得対象となるＳＯＣを決定する。より具体的には、制御演算部２３０は、最小の評価値が算出されたＳＯＣを、次の取得対象となるＳＯＣとして決定する。Ｓ３３７の後、図１１のフローにおけるステップＳ１０９に進む。
【０１０７】図１０、図１２等に関連して説明したように、制御演算部２３０は、取得対象の複数の 40ＳＯＣのうち、評価値が最小となるＳＯＣを、次の取得対象となるＳＯＣとして決定する。これにより、ＳＯＣ−ＯＣＶカーブの確度を高めることができる（ＳＯＣ，ＯＣＶ）データを速やかに取得できる。
【０１０８】なお、図８等に関連して、ＳＯＣの離散度の一例として、収集済みデータのＳＯＣの範囲を、データを取得済みであるＳＯＣの数で除算したものを取り上げて説明した。ＳＯＣの離散度は、これに限られない。ＳＯＣの離散度を、データを取得済みのＳＯＣの分散、データを取得済みのＳＯＣの密度、データを取得済みのＳＯＣの座標において隣接するＳＯＣとの間の差など、ＳＯＣの離散度合いを表す様々なパラメータを用いて算出して良い。 50(20) JP 5980458 B1 2016.8.31
【０１０９】また、次の取得対象ＳＯＣを選択する場合に、取得対象として予め定められたＳＯＣのうち、データが取得されていない全てのＳＯＣの中から、次に取得するべきＳＯＣを選択するものとして説明した。しかし、取得対象として予め定められたＳＯＣのうち、データが取得されていない一部のＳＯＣの中から、次に取得するべきＳＯＣを選択しても良い。例えば、次に取得するべきＳＯＣの範囲が、特定の範囲内に限定されていて良い。例えば、次に取得するべきＳＯＣの範囲が、予め定められた値未満に限定されていて良い。一例として、図８に示す状況において、取得対象として予め定められたＳＯＣのうち、４０％未満のＳＯＣの中から、次に取得するべきＳＯＣを選択しても良い。この場合、例えば図１０に示される評価値に基づいて、次の取得対象ＳＯＣとして３０％が選択されて良い。 10
【０１１０】以上のフローにおいては、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定する手順を説明したが、第２蓄電池１２１を対象蓄電池として選択して第２蓄電池１２１のＳＯＣ−ＯＣＶカーブを確定する手順も同様である。それぞれの蓄電池のＳＯＣ−ＯＣＶカーブが確定されれば、確定ライン保持部２３４は、２つのＳＯＣ−ＯＣＶカーブが記憶することになる。また、一方の蓄電池のＳＯＣ−ＯＣＶカーブを確定させた後に、他方の蓄電池のＳＯＣ−ＯＣＶカーブを確定させても良いし、蓄電池部間充放電のたびにそれぞれの蓄電池で（ＳＯＣ，ＯＣＶ）データを取得すれば、２つのＳＯＣ−ＯＣＶカーブを並行して確定させることもできる。なお、順に確定させる場合には、高容量型バッテリより、高出力型バッテリのＳＯＣ−ＯＣＶカーブを優先的に確定させると良い。また、ＳＯＣ−ＯＣＶ 20カーブの更新頻度も、高出力型バッテリの方を多くすると良い。これは前述したように、高出力型バッテリがＳＯＣに対する劣化影響度の変動が、高容量型バッテリと比べて大きいため、高出力型バッテリの劣化を抑制しつつ充放電を行うためにはより精度の高いＳＯＣ−ＯＣＶカーブを常時有しておく必要があるからである。加えて、その特性上、一定電力を継続的に充放電する高容量型バッテリのＳＯＣは、電流積算法などによっても推定可能だが、大電力の充放電を瞬間的に行う高出力型バッテリは、電流積算法よりもＳＯＣ−ＯＣＶカーブを用いた方が、精度よくＳＯＣを推定可能だからである。
【０１１１】上記の実施形態おいては、ＯＣＶが基準ＯＣＶに含まれるように調整して（ＳＯＣ，ＯＣＶ）データを取得したが、ＳＯＣが基準ＳＯＣ含まれるように調整して（ＳＯＣ，ＯＣ 30Ｖ）データを取得しても良い。この場合は、ＳＯＣがＳ の範囲（Ｓ 〜Ｓ ）Ｒ ｍｉｎ ｍａｘに収まるように、蓄電池部間充放電で移動する電荷の電気量をＣ に基づいて定めｆｕｌｌれば良い。
【０１１２】また、上記に実施形態おいては、基準領域に少なくとも一つの（ＳＯＣ，ＯＣＶ）データが含まれるように調整したが、そのような調整を行うことなく、基準領域に含まれない複数の（ＳＯＣ，ＯＣＶ）データを集めて、そのデータ群に最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データから選択して確定しても良い。この場合は、基準領域に（ＳＯＣ，ＯＣＶ）データが含まれる場合に対して精度は落ちるが、より簡易にＳＯＣ−ＯＣＶカーブを確定させることができる。 40
【０１１３】また、上記の実施形態においては、ＢＡＴＴ情報格納部２３３にそれぞれの蓄電池の参照データを記憶させ、この参照データの各ＳＯＣ−ＯＣＶカーブとマッチング処理を行うことにより、現時点におけるＳＯＣ−ＯＣＶカーブを確定させている。しかし、参照データを参照することなく、複数の（ＳＯＣ，ＯＣＶ）データから近似曲線または近似直線を算出し、当該近似曲線または近似直線をＳＯＣ−ＯＣＶカーブとして確定させても良い。近似曲線または近似直線は、最小二乗法などに基づくフィッティングによって算出されて良い。なお、ＳＯＣ毎にＯＣＶの平均値を算出し、算出したＯＣＶの平均値に基づいて、近似曲線または近似直線を算出しても良い。ＳＯＣ−ＯＣＶ平面における座標（ＳＯＣ，ＯＣＶの平均値）の点について、隣接するＳＯＣ同士を直線で結ぶことによって各区間の 50(21) JP 5980458 B1 2016.8.31近似直線を算出して良い。座標（ＳＯＣ，ＯＣＶの平均値）が３点以上の場合は、近似直線の集合としての折れ線が算出される。参照データにおける各容量維持率のＳＯＣ−ＯＣＶカーブは、例えば電池メーカーが準備する、その型の蓄電池の代表データであるので、信頼性は高い。しかしながら、個々の製品のばらつきまでは対応していないので、そのばらつきは誤差となってしまう。しかし、実測された（ＳＯＣ，ＯＣＶ）データから近似曲線または近似直線を算出すれば、個々のばらつきまで吸収した、生のＳＯＣ−ＯＣＶカーブであると言える。したがって、より精度の高いＳＯＣ−ＯＣＶカーブとして利用できる可能性がある。また、蓄電池の種類によっては、基準領域が存在しない場合もあり得るが、このような場合であっては、実測された（ＳＯＣ，ＯＣＶ）データから算出された近似曲線または近似直線と参照データを併用して、ＳＯＣ−ＯＣＶカーブを確定することがで 10きる。具体的には、参照データに含まれる各容量維持率のＳＯＣ−ＯＣＶカーブの中で、実測された（ＳＯＣ，ＯＣＶ）データから算出された近似曲線または近似直線と最も近い形状を有するものを、ＳＯＣ−ＯＣＶカーブとして確定する。
【０１１４】参照データからＳＯＣ−ＯＣＶカーブを選択して確定する場合は、容量維持率と対応付けられているので、その時点における蓄電池の劣化進行度合を併せて把握することができる。一方で、実測した（ＳＯＣ，ＯＣＶ）データから近似曲線または近似直線を算出する場合は、精度が上がる期待はあるものの、劣化進行度合は把握できない。したがって、システムが要求する事情に合わせて、ＳＯＣ−ＯＣＶカーブの確定方法を選択できるようにしても良い。また、例えば取得した（ＳＯＣ，ＯＣＶ）データのエラーチェックをおこな 20うために、両者を併用しても良い。
【０１１５】また、上記の実施形態においては、特に図１１に関連して説明したように、予め定められた座標数が決められた時間以内に取得できない場合は、すべての（ＳＯＣ，ＯＣＶ）データを破棄して最初から処理をしなおす手順を説明した。しかし、古い（ＳＯＣ，ＯＣＶ）データから個別に除外して、マッチング処理に利用する複数の（ＳＯＣ，ＯＣＶ）データを、一定時間以内に取得されたものに限るようにしても良い。また、マッチング処理に利用する（ＳＯＣ，ＯＣＶ）データを選択する基準は、その（ＳＯＣ，ＯＣＶ）データが取得された時刻に限らない。例えば、蓄電池部間充放電において、移動させる電荷の電気量の積算量が予め定められた電気量を超えた場合には、古い（ＳＯＣ，ＯＣＶ）データか 30ら順に除外しても良い。この場合、次の積算量は、２番目に古い（ＳＯＣ，ＯＣＶ）データを取得した時点からの積算量に更新する。なお、基準とする電気量は、走行距離、環境温度、ＳＯＣ−ＯＣＶカーブに要求される精度等に応じて変更しても良い。
【０１１６】なお、輸送機器は、電動自動車に限られない。輸送機器は、電源装置および内燃機関を備えるハイブリッド自動車、電車などの車両であってよい。輸送機器は、車両に限られず、電源装置を備える航空機や船舶など、陸上、空中、水上又は水中を移動して物体を輸送する様々な機器を含む。輸送機器とは、電源装置を備える様々な輸送用機器を含む概念である。
【０１１７】 40以上、本発明を実施の形態を用いて説明したが、本発明の技術的範囲は上記実施の形態に記載の範囲には限定されない。上記実施の形態に、多様な変更または改良を加えることが可能であることが当業者に明らかである。その様な変更または改良を加えた形態も本発明の技術的範囲に含まれ得ることが、特許請求の範囲の記載から明らかである。
【０１１８】特許請求の範囲、明細書、および図面中において示した装置、システム、プログラム、および方法における動作、手順、ステップ、および段階等の各処理の実行順序は、特段「より前に」、「先立って」等と明示しておらず、また、前の処理の出力を後の処理で用いるのでない限り、任意の順序で実現しうることに留意すべきである。特許請求の範囲、明細書、および図面中の動作フローに関して、便宜上「まず、」、「次に、」等を用いて説 50(22) JP 5980458 B1 2016.8.31明したとしても、この順で実施することが必須であることを意味するものではない。
【符号の説明】
【０１１９】１０ 輸送機器、１００ 蓄電装置、１０１ 第１蓄電モジュール、１０２ 第２蓄電モジュール、１０３ 充放電回路モジュール、１１１ 第１蓄電池、１１２ 第１電圧センサ、１１３ 第１電流センサ、１１４ 第１スイッチ、１２１ 第２蓄電池、１２２ 第２電圧センサ、１２３ 第２電流センサ、１２４ 第２スイッチ、１３０ 電池ＥＣＵ、１３１ 第１ＶＣＵ、１３２ 第２ＶＣＵ、１３３ 第３スイッチ、１４２ 第３電圧センサ、１４１ ＰＤＵ、１５１ 充電コンバータ、１５２ 受電部、１５３ 外部電源、２３０ 制御演算部、２３１ ΔＳＯＣ算出部、２３２ 計時部、２３３ ＢＡＴＴ情報 10格納部、２３４ 確定ライン保持部、２３５ ＳＯＣ応答部、２９０ 記録媒体、７００マッピング線、７０１、７０２，７０３、７０４ 符号、７７０、７８０ ＳＯＣ−ＯＣＶカーブ
【要約】
【課題】蓄電部のＳＯＣとＯＣＶのより正確な相関情報を効率的に推定すること。
【解決手段】電源装置は、第１蓄電部と、第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部とを含み、制御部は、第１蓄電部と第２蓄電部の少なくとも一方を対象蓄電部とし、対象蓄電部の充電率と開放端電圧である対象ＳＯＣと対象ＯＣＶを取得し、第１蓄電部と第２蓄電部の間の電荷移動を用いて、対象ＳＯＣと対象ＯＣＶを含むデータを、データの集合である収集済データのＳＯＣに 20対する離散状態と対象ＳＯＣに基づく評価関数より導出される順序で収集し、複数のデータに基づき、対象蓄電部のＳＯＣとＯＣＶの相関情報を推定する。
【選択図】図８
【図１】 
【図２】
【図３】(23) JP 5980458 B1 2016.8.31
【図４】 
【図６】
【図５】
【図７】 
【図８】(24) JP 5980458 B1 2016.8.31
【図９】 
【図１１】
【図１０】
【図１２】(25) JP 5980458 B1 2016.8.31フロントページの続き(56)参考文献 特開２０１２−２３４７００（ＪＰ，Ａ）特開２００８−２２００８０（ＪＰ，Ａ）特開２０１０−１７８４３２（ＪＰ，Ａ）特開２００５−２６９７６０（ＪＰ，Ａ）特開２００９−５４５８（ＪＰ，Ａ）国際公開第２０１１／０９００２０（ＷＯ，Ａ１）(58)調査した分野(Int.Cl.，ＤＢ名) 10Ｇ０１Ｒ ３１／３６Ｂ６０Ｒ １６／０３３Ｈ０２Ｊ ７／００Ｈ０１Ｍ １０／４４Ｈ０１Ｍ １０／４８']