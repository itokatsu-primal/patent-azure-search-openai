['JP 5980457 B1 2016.8.31(57)
【特許請求の範囲】
【請求項１】第１蓄電部と、前記第１蓄電部と比して、エネルギー密度が優れ、出力密度が劣る第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路と、前記充放電回路を制御する制御部を有する回路モジュールを含み、前記制御部は、前記第１蓄電部の充電率と開放端電圧である第１ＳＯＣと第１ＯＣＶの組合せである第１データと、前記第２蓄電部の充電率と開放端電圧である第２ＳＯＣと第２ＯＣＶの組合せである第２データを前記第１蓄電部と前記第２蓄電部の間の複数回の電荷移動のそれぞ 10れの前後で取得し、基準データを含む前記第１データの集合から、前記第１蓄電部のＳＯＣとＯＣＶの相関情報である第１相関を推定する第１操作を実行し、前記制御部が記憶している複数の記憶済データと前記第２データの集合の比較に基づいて、前記第２蓄電部のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行することを特徴とする電源装置。
【請求項２】前記基準データは、前記第１蓄電部の複数の劣化状態において同一のＯＣＶに対するＳＯＣの偏差が閾値以下である第１データである 20(2) JP 5980457 B1 2016.8.31請求項１に記載の電源装置。
【請求項３】前記制御部は、前記第２蓄電部の劣化状態と前記記憶済データを対応付けて記憶しており、前記第２蓄電部の現在の劣化状態を推定し、前記複数の記憶済データのうち前記現在の劣化状態より進行した劣化状態が対応付けられた記憶済データのみと前記第２データの集合を比較する請求項１又は２に記載の電源装置。
【請求項４】前記制御部は、推定した前記第２相関に基づいて前記現在の劣化状態を決定する 10請求項３に記載の電源装置。
【請求項５】制御部は、前記第２相関を前回推定した時刻から前記第２蓄電部が充放電した電流の累積値に基づいて、前記複数の記憶済データのうち複数の前記第２データの集合と比較する記憶済データを選択する請求項１から４のいずれか１項に記載の電源装置。
【請求項６】前記制御部は、前記電流の累積値に対応する劣化状態より予め定められた値以上進行した劣化状態が対応付けられた前記記憶済データを除外して、複数の前記第２データの集合と比較する前記記憶済データを選択する 20請求項５に記載の電源装置。
【請求項７】前記制御部は、前記第１データの集合に対する近似曲線または近似直線に基づき、前記第１相関を生成する請求項１から６のいずれか１項に記載の電源装置。
【請求項８】前記制御部は、前記複数の記憶済データのうち、前記第２データの集合に対する適合度がより高い記憶済データをより優先して選択して、前記第２相関を生成する請求項７に記載の電源装置。
【請求項９】 30前記制御部は、前記第１蓄電部の複数の劣化状態において同一のＳＯＣに対するＯＣＶの差分が閾値以下となるＳＯＣである基準ＳＯＣの範囲に前記第１蓄電部のＳＯＣが含まれる、または、前記基準ＳＯＣに対応するＯＣＶである基準ＯＣＶの範囲に前記第１蓄電部のＳＯＣが含まれるときからの前記第１蓄電部への電荷移動量に基づいて、前記電荷移動の後の前記第１ＳＯＣを取得する請求項１から８のいずれか１項に記載の電源装置。
【請求項１０】前記制御部は、前記電荷移動を行う前の前記第１蓄電部のＳＯＣが前記基準ＳＯＣの範囲に含まれない場合、または、前記電荷移動を行う前の前記第１蓄電部のＯＣＶが前記基準ＯＣＶの範囲に含まれない場合、前記電荷移動に先立ち、前記第１蓄電部のＳＯＣが前 40記基準ＳＯＣの範囲に含まれる、または、前記第１蓄電部のＯＣＶが前記基準ＯＣＶの範囲に含まれるよう、前記第１蓄電部と前記第２蓄電部との間の充放電を行う請求項９に記載の電源装置。
【請求項１１】前記第１蓄電部と前記第２蓄電部の少なくとも一方は、駆動部に電力を供給し、前記充放電回路は、前記第１蓄電部、前記第２蓄電部、および前記駆動部の間の充放電を担い、前記制御部は、前記電荷移動を行う間、前記第１蓄電部と前記第２蓄電部が、前記駆動部との間で充放電を行わないよう前記充放電回路を制御する請求項１から１０のいずれか１項に記載の電源装置。 50(3) JP 5980457 B1 2016.8.31
【請求項１２】前記制御部は、前記第１蓄電部のＳＯＣの問合せを受けた場合に、前記第１蓄電部のＯＣＶと、前記第１相関とに基づいて、前記第１蓄電部のＳＯＣを算出して応答し、前記第２蓄電部のＳＯＣの問合せを受けた場合に、前記第２蓄電部のＯＣＶと前記第２相関とに基づいて、前記第２蓄電部のＳＯＣを算出して応答する請求項１から１１のいずれか１項に記載の電源装置。
【請求項１３】前記第１蓄電部は、前記第２蓄電部と比して、電池容量が大きい請求項１から１２のいずれか１項に記載の電源装置。
【請求項１４】 10請求項１から１３のいずれか１項に記載の電源装置を有する輸送機器。
【請求項１５】第１蓄電部と、前記第１蓄電部と比して、エネルギー密度が優れ、出力密度が劣る第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路と、前記充放電回路を制御する制御部を有する回路モジュールとを含む電源装置における、前記第１蓄電部の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報と前記第２蓄電部のＳＯＣとＯＣＶの相関情報とを推定する推定方法であって、前記第１蓄電部のＳＯＣとＯＣＶである第１ＳＯＣと第１ＯＣＶの組合せである第１データと、前記第２蓄電部のＳＯＣとＯＣＶである第２ＳＯＣと第２ＯＣＶの組合せである 20第２データを前記第１蓄電部と前記第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得するステップと、基準データを含む前記第１データの集合から、前記第１蓄電部のＳＯＣとＯＣＶの前記相関情報である第１相関をする第１操作を実行するステップと、前記制御部が記憶している複数の記憶済データと前記第２データの集合の比較に基づいて、前記第２蓄電部のＳＯＣとＯＣＶの前記相関情報である第２相関を推定する第２操作を実行するステップとを含む推定方法。
【請求項１６】第１蓄電部と、 30前記第１蓄電部と比して、エネルギー密度が優れ、出力密度が劣る第２蓄電部と、前記第１蓄電部と前記第２蓄電部の間の充放電を担う充放電回路と、前記充放電回路を制御する制御部とを有する回路モジュールを含む電源装置における、前記第１蓄電部の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報と前記第２蓄電部のＳＯＣとＯＣＶの相関情報とを推定するためのプログラムであって、前記第１蓄電部のＳＯＣとＯＣＶである第１ＳＯＣと第１ＯＣＶの組合せである第１データと、前記第２蓄電部のＳＯＣとＯＣＶである第２ＳＯＣと第２ＯＣＶの組合せである第２データを前記第１蓄電部と前記第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得するステップと、基準データを含む前記第１データの集合から、前記第１蓄電部のＳＯＣとＯＣＶの前記 40相関情報である第１相関をする第１操作を実行するステップと、前記制御部が記憶している複数の記憶済データと前記第２データの集合の比較に基づいて、前記第２蓄電部のＳＯＣとＯＣＶの前記相関情報である第２相関を推定する第２操作を実行するステップとをコンピュータに実行させるためのプログラム。
【発明の詳細な説明】
【技術分野】
【０００１】本発明は、電源装置、該電源装置を有する輸送機器、蓄電部の充電率と開放端電圧の相関情報を推定する推定方法、および該相関情報を推定するためのプログラムに関する。 50(4) JP 5980457 B1 2016.8.31
【背景技術】
【０００２】複数の蓄電池を備えるシステムにおいて、その蓄電池間で充放電を行うことにより、ＳＯＣ（Ｓｔａｔｅ Ｏｆ Ｃｈａｒｇｅ、充電率）を把握する技術が知られている。［先行技術文献］［特許文献］［特許文献１］特開２００８―２２００８０号公報
【発明の概要】
【発明が解決しようとする課題】
【０００３】 10ところでＳＯＣの把握は、蓄電部のＳＯＣとＯＣＶの相関情報と測定したＯＣＶを用いて行うことが一般的である。この蓄電部のＳＯＣとＯＣＶの相関情報は、予め設定されるか、またはＳＯＣ把握に精度を高めるべく、何らかのパラメータに基づいて推定される。しかし、蓄電部のＳＯＣとＯＣＶの相関情報を効率的に推定することができないという課題があった。
【課題を解決するための手段】
【０００４】本発明の第１の態様における電源装置は、第１蓄電部と、第１蓄電部と比してエネルギー密度が優れ出力密度が劣る第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部を有する回路モジュールを含み、制御部は、 20第１蓄電部の充電率と開放端電圧である第１ＳＯＣと第１ＯＣＶの組合せである第１データと、第２蓄電部の充電率と開放端電圧である第２ＳＯＣと第２ＯＣＶの組合せである第２データを第１蓄電部と第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得し、基準データを含む第１データの集合から、第１蓄電部のＳＯＣとＯＣＶの相関情報である第１相関を推定する第１操作を実行し、制御部が記憶している複数の記憶済データと第２データの集合の比較に基づいて、第２蓄電部のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行する。
【０００５】本発明の第２の態様における輸送機器は、上記の電源装置を有する。
【０００６】 30本発明の第３の態様における方法は、第１蓄電部と、第１蓄電部と比して、エネルギー密度が優れ、出力密度が劣る第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部を有する回路モジュールとを含む電源装置における、第１蓄電部の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報と第２蓄電部のＳＯＣとＯＣＶの相関情報とを推定する推定方法であって、第１蓄電部のＳＯＣとＯＣＶである第１ＳＯＣと第１ＯＣＶの組合せである第１データと、第２蓄電部のＳＯＣとＯＣＶである第２ＳＯＣと第２ＯＣＶの組合せである第２データを第１蓄電部と第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得するステップと、基準データを含む第１データの集合から、第１蓄電部のＳＯＣとＯＣＶの相関情報である第１相関をする第１操作を実行するステップと、制御部が記憶している複数の記憶済データと第２データの集合 40の比較に基づいて、第２蓄電部のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行するステップとを含む。
【０００７】本発明の第４の態様におけるプログラムは、第１蓄電部と、第１蓄電部と比して、エネルギー密度が優れ、出力密度が劣る第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部とを有する回路モジュールを含む電源装置における、第１蓄電部の充電率と開放端電圧であるＳＯＣとＯＣＶの相関情報と第２蓄電部のＳＯＣとＯＣＶの相関情報とを推定するためのプログラムであって、第１蓄電部のＳＯＣとＯＣＶである第１ＳＯＣと第１ＯＣＶの組合せである第１データと、第２蓄電部のＳＯＣとＯＣＶである第２ＳＯＣと第２ＯＣＶの組合せである第２データを第１蓄電 50(5) JP 5980457 B1 2016.8.31部と第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得するステップと、基準データを含む第１データの集合から、第１蓄電部のＳＯＣとＯＣＶの相関情報である第１相関をする第１操作を実行するステップと、制御部が記憶している複数の記憶済データと第２データの集合の比較に基づいて、第２蓄電部のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行するステップとをコンピュータに実行させる。
【０００８】なお、上記の発明の概要は、本発明の必要な特徴の全てを列挙したものではない。また、これらの特徴群のサブコンビネーションもまた、発明となりうる。
【図面の簡単な説明】
【０００９】 10
【図１】本実施形態に係る輸送機器のブロック図である。
【図２】単一の蓄電池を用いた場合による電力出力と、２つの蓄電池を用いた場合による電力出力とを比較するための図である。
【図３】蓄電池のＳＯＣ−ＯＣＶカーブを説明する図である。
【図４】ＳＯＣ−ＯＣＶカーブを確定するまでの手順を説明する図である。
【図５】平面空間上で座標を確定させるための演算を説明する図である。
【図６】電池ＥＣＵ１３０の内部ブロック図を、電池ＥＣＵ１３０用のプログラムを格納する記録媒体２９０とともに示す。
【図７】蓄電池部間充放電を行う毎に第１蓄電池１１１及び第２蓄電池１２１のそれぞれの（ＳＯＣ，ＯＣＶ）データが取得される様子を示す。 20
【図８】収集した第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データから、第１蓄電池１１１の現在のＳＯＣ−ＯＣＶカーブを確定する処理を説明するための図である。
【図９】第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データに対するマッチング対象のＳＯＣ−ＯＣＶカーブを選択する処理を説明する図である。
【図１０】収集した第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データから、第２蓄電池１２１の現在のＳＯＣ−ＯＣＶカーブを確定する処理を説明するための図である。
【図１１】ＳＯＣ−ＯＣＶカーブを確定させるまでのフロー図である。
【図１２】第１蓄電池１１１および第２蓄電池１２１の少なくとも一方の（ＳＯＣ，ＯＣＶ）データを取得するためのフロー図である。
【図１３】複数の（ＳＯＣ，ＯＣＶ）データからＳＯＣ−ＯＣＶカーブを確定するための 30フロー図である。
【発明を実施するための形態】
【００１０】以下、発明の実施の形態を通じて本発明を説明するが、以下の実施形態は特許請求の範囲にかかる発明を限定するものではない。また、実施形態の中で説明されている特徴の組み合わせの全てが発明の解決手段に必須であるとは限らない。
【００１１】図１は、本実施形態に係る輸送機器１０のブロック図である。本実施形態に係る輸送機器は、例えば電動自動車である。以下においては、本実施形態に係る蓄電装置１００が電動自動車に搭載されて利用される場合を想定して説明する。なお、蓄電装置１００は、電 40源装置の一例である。
【００１２】輸送機器１０は、搭載された蓄電装置１００から供給される駆動電力をパワードライブユニットであるＰＤＵ１４１が受け、ＰＤＵ１４１がモータジェネレータＭＧを回転駆動させることにより走行する。
【００１３】ＰＤＵ１４１は、蓄電装置１００と、主正母線ＭＰＬおよび主負母線ＭＮＬとで接続されている。平滑コンデンサＣは、主正母線ＭＰＬと主負母線ＭＮＬとの間に接続されており、導通する電力の高周波成分を低減する。第３電圧センサ１４２は、主正母線ＭＰＬと主負母線ＭＮＬとの間の電圧Ｖｈを検出し、検出された電圧Ｖｈは、ＰＤＵ１４１の制御 50(6) JP 5980457 B1 2016.8.31に利用される。
【００１４】ＰＤＵ１４１は、主正母線ＭＰＬおよび主負母線ＭＮＬから供給される駆動電力（直流電力）を交流電力に変換してモータジェネレータＭＧへ出力する。モータジェネレータＭＧは、例えば、三相交流回転電機を含む。モータジェネレータＭＧは、動力伝達機構および駆動軸を介して車輪を回転させる。また、ＰＤＵ１４１は、車輪の減速時においてモータジェネレータＭＧが発電する交流電力を直流電力に変換し、回生電力として主正母線ＭＰＬおよび主負母線ＭＮＬへ出力する。
【００１５】蓄電装置１００が備える第１蓄電池１１１および第２蓄電池１２１は、モータジェネレ 10ータが発電する回生電力と、外部電源１５３からの外部電力とによって充電される。
【００１６】充電コンバータ１５１は、主正母線ＭＰＬおよび主負母線ＭＮＬと受電部１５２との間に設けられる。そして、充電コンバータ１５１は、受電部１５２を介して外部電源１５３（例えば家庭用ＡＣ電源）から供給される交流電力を直流電力に変換して主正母線ＭＰＬおよび主負母線ＭＮＬへ出力する。受電部１５２は、外部電源１５３から供給される交流電力を入力するための入力端子である。なお、充電コンバータ１５１は、主正母線ＭＰＬおよび主負母線ＭＮＬに代えて、あるいは追加して、正極線ＰＬ１および負極線ＮＬ１に接続されていても良く、正極線ＰＬ２および負極線ＮＬ２に接続されていても良い。
【００１７】 20蓄電装置１００は、第１蓄電モジュール１０１、第２蓄電モジュール１０２および充放電回路モジュール１０３を含む。第１蓄電モジュール１０１は、第１蓄電池１１１、第１電圧センサ１１２、第１電流センサ１１３、および第１スイッチ１１４を有する。第２蓄電モジュール１０２は、第１蓄電モジュール１０１と同様の構成であり、第２蓄電池１２１、第２電圧センサ１２２、第２電流センサ１２３、および第２スイッチ１２４を有する。充放電回路モジュール１０３は、第１蓄電池１１１と第２蓄電池１２１の間の充放電を担う。充放電回路モジュール１０３は、制御部としての電池ＥＣＵ１３０と、充放電回路として機能しうる第１ＶＣＵ１３１、第２ＶＣＵ１３２、および第３スイッチ１３３とを有する。
【００１８】 30本実施形態において第１蓄電部として機能する第１蓄電池１１１、および第２蓄電部として機能する第２蓄電池１２１は、充放電可能な直流電源であり、たとえば、リチウムイオン電池やニッケル水素電池、ナトリウムイオン電池、リチウム硫黄電池などの二次電池を含む。他にも、コンデンサ、キャパシタなどの充放電が可能な素子であっても良い。ただし、第１蓄電池１１１と第２蓄電池１２１は、互いに特性が異なる電池である。具体的には、第１蓄電池１１１は第２蓄電池１２１より単位質量あたりの出力電力である質量出力密度が大きい、いわゆる高出力型バッテリである。一方、第２蓄電池１２１は第１蓄電池１１１より単位質量あたりの貯蔵電力である質量エネルギー密度が大きい、いわゆる高容量型バッテリである。第１蓄電池１１１は第２蓄電池１２１より単位容積あたりの出力電力である容積出力密度が大きくて良く、第２蓄電池１２１は第１蓄電池１１１より単位 40容積あたりの貯蔵電力である容積エネルギー密度が大きくて良い。このように、単位質量または単位容積あたりに第１蓄電池１１１から取り出せる電力は、単位質量または単位容積あたりに第２蓄電池１２１から取り出せる電力より大きい。一方、単位質量または単位容積あたりに第２蓄電池１２１が貯蔵できる電力は、単位質量または単位容積あたりに第１蓄電池１１１が貯蔵できる電力より大きい。このように、第１蓄電池１１１は、第２蓄電池１２１と比して、エネルギー密度が劣り、出力密度が優れる。また、第２蓄電池１２１は、第１蓄電池１１１と比して、大きい電池容量を有してよい。
【００１９】第１蓄電池１１１は、正極線ＰＬ１および負極線ＮＬ１を介して第１ＶＣＵ１３１に接続されている。第１電圧センサ１１２は、正極線ＰＬ１と負極線ＮＬ１との間の電圧すな 50(7) JP 5980457 B1 2016.8.31わち第１蓄電池１１１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。１第１電流センサ１１３は、第１蓄電池１１１に対して入出力される電流Ｉ を検出し、そ１の検出値を電池ＥＣＵ１３０へ出力する。
【００２０】第１スイッチ１１４は、正極線ＰＬ１と負極線ＮＬ１の電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。１第１スイッチ１１４が開状態であるときに第１電圧センサ１１２によって検出されるＶ１は、第１蓄電池１１１におけるＯＣＶであるＯＣＶ となる。１
【００２１】第２蓄電池１２１は、正極線ＰＬ２および負極線ＮＬ２を介して第２ＶＣＵ１３２に接 10続されている。第２電圧センサ１２２は、正極線ＰＬ２と負極線ＮＬ２との間の電圧すなわち第２蓄電池１２１の電圧Ｖ を検出し、その検出値を電池ＥＣＵ１３０へ出力する。２第２電流センサ１２３は、第２蓄電池１２１に対して入出力される電流Ｉ を検出し、そ２の検出値を電池ＥＣＵ１３０へ出力する。
【００２２】第２スイッチ１２４は、正極線ＰＬ２と負極線ＮＬ２の電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受けて、開状態と閉状態を切り替える。２第２スイッチ１２４が開状態であるときに第２電圧センサ１２２によって検出されるＶ２は、第２蓄電池１２１におけるＯＣＶであるＯＣＶ となる。２
【００２３】 20なお、第１電流センサ１１３および第２電流センサ１２３は、それぞれ対応する蓄電池から出力される電流（放電電流）を正値として検出し、入力される電流（充電電流および回生電流）を負値として検出する。図１では、それぞれ正極線の電流を検出する構成として示すが、負極線の電流を検出するように構成しても良い。
【００２４】第１ＶＣＵ１３１は、正極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ を受けて、正１極線ＰＬ１および負極線ＮＬ１と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。第２ＶＣＵ１３２は、正極線ＰＬ２および負極線ＮＬ２と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間に設けられ、電池ＥＣＵ１３０からの制御信号ＣＶ 30２を受けて、正極線ＰＬ２および負極線ＮＬ２と、接続正極線ＢＰＬおよび接続負極線ＢＮＬとの間で電圧変換を行う。
【００２５】接続正極線ＢＰＬは、主正母線ＭＰＬと接続され、接続負極線ＢＮＬは、主負母線ＭＮＬに接続される。その接続部には、第３スイッチ１３３が設けられている。第３スイッチ１３３は、接続正極線ＢＰＬと主正母線ＭＰＬ、および接続負極線ＢＮＬと主負母線ＭＮＬの電路を開閉するスイッチであり、電池ＥＣＵ１３０からの開閉指示信号ＣＷ を受け３て、開状態と閉状態を切り替える。
【００２６】以上の構成においては、第１スイッチ１１４と第３スイッチ１３３を閉状態、第２スイ 40ッチ１２４を開状態とした場合には、第１蓄電池１１１の電力がＰＤＵ１４１へ供給される。また、第２スイッチ１２４と第３スイッチ１３３を閉状態、第１スイッチ１１４を開状態とした場合には、第２蓄電池１２１の電力がＰＤＵ１４１へ供給される。また、第１スイッチ１１４と第２スイッチ１２４と第３スイッチ１３３を閉状態とした場合には、第１蓄電池１１１の電力と第２蓄電池１２１の電力が共にＰＤＵ１４１へ供給される。ただし、第１蓄電池１１１の電力と第２蓄電池１２１の電力を共にＰＤＵ１４１へ供給する場合には、供給電圧が同じになるように、第１ＶＣＵ１３１および第２ＶＣＵ１３２によって電圧変換が成される。なお、ＰＤＵ１４１から回生電力が供給される場合、または外部電源１５３から外部電力が供給される場合には、電力の流れは上記の各場合における逆向きとなる。 50(8) JP 5980457 B1 2016.8.31
【００２７】また、本実施形態においては、それぞれの蓄電池に電圧変換ユニットであるＶＣＵを設けるいわゆる２ＶＣＵ方式を採用するが、一方の蓄電池の出力電圧に対して他方の蓄電池の出力電圧を調整する観点からは、いずれかに一つのＶＣＵを設けるいわゆる１ＶＣＵ方式を採用しても良い。１ＶＣＵ方式であれば、ＶＣＵを設置するスペースの削減に寄与する。また、コストの削減、重量の削減にも寄与する。この場合には、ＰＤＵ１４１へ供給される電圧は、ＶＣＵが設けられない蓄電池の出力電圧となるが、この制約が不都合である場合には２ＶＣＵ方式を採用すれば良い。
【００２８】なお、コンバータは、大別すると昇圧型、降圧型、昇降圧型に分類されるが、第１ＶＣ 10Ｕ１３１、第２ＶＣＵ１３２は、いずれの型のコンバータも採用し得る。また、第１ＶＣＵ１３１、第２ＶＣＵ１３２に採用するコンバータの型を異ならせても良い。第１蓄電池１１１および第２蓄電池１２１とコンバータの型を適宜組み合わせることにより、要求仕様を満たす全体としてあたかも一つのバッテリとして利用することができる。
【００２９】第１スイッチ１１４と第２スイッチ１２４を閉状態、第３スイッチ１３３を開状態とした場合には、第１蓄電池１１１と第２蓄電池１２１の間で充放電が行われる。この蓄電池部間充放電は、電池ＥＣＵ１３０からの制御信号ＣＶ によって決定される第１ＶＣＵ１１３１の変換電圧値と、制御信号ＣＶ によって決定される第２ＶＣＵ１３２の変換電圧値２との差に応じて、電力の流れが定まる。したがって、電池ＥＣＵ１３０は、変換電圧値を 20指示する制御信号ＣＶ およびＣＶ をそれぞれのＶＣＵに送信することにより、どちら１ ２の蓄電池を電力の供給側とし、どちらの蓄電池を電力の受容側とするか制御することができる。なお、第１ＶＣＵ１３１と第２ＶＣＵ１３２の一方のハイサイドスイッチを「閉」かつローサイドスイッチを「開」に固定することで電圧変換を停止し、蓄電池の出力電圧をそのまま出力するいわゆる直結モードで制御して、他方の変換電圧値を変更するように制御しても良い。このとき、電池ＥＣＵ１３０は、Ｖ とＩ を監視すれば、第１蓄電池１ １１１１における充放電量を把握することができ、Ｖ とＩ を監視すれば、第２蓄電池１２ ２２１における充放電量を把握することができる。
【００３０】上記のように、本実施形態における蓄電装置１００は、互いに特性が異なる２つの蓄電 30池を備える。互いに特性が異なる複数の蓄電池を用いるシステムは、それぞれの蓄電池の特性や状態に応じて、要求される電力の供給に対してどのように応えるか、細かく制御する必要がある。そこでまず、単一の蓄電池を用いた場合による電力出力と、特性が異なる複数の蓄電池を用いた場合による電力出力の違いについて説明する。
【００３１】図２は、単一の蓄電池を用いた場合による電力出力と、特性が異なる２つの蓄電池を用いた場合による電力出力とを比較するための図である。横軸は時間経過を表わし、縦軸は電力出力を表わす。電力出力が負の領域は、例えば回生電力によって電力受容がなされることを表わす。
【００３２】 40実線で示されるＳＢは、蓄電装置が一つの蓄電池によって構成される場合の、出力電力の変化を表わす。蓄電装置が一つの蓄電池のみを備える場合には、負荷側から要求される電力をその能力の範囲において要求されるままに出力し、入力される電力をそのまま受け入れる。したがって、短時間で大きな出入力を行う場合もあり、蓄電池が急激に劣化するなどの問題もある。
【００３３】蓄電装置が特性の異なる２つの蓄電池によって構成される場合には、それぞれの特性に応じて出入力を分担することができる。点線で表わされるＯＢは、高出力型バッテリの出力電力の変化を表わし、二重線で表わされるＶＢは、高容量型バッテリの出力電力の変化を表わしている。各時間において、ＯＢの値とＶＢの値を足し合わせるとＳＢの値となる 50(9) JP 5980457 B1 2016.8.31。すなわち、負荷側から要求される電力を、高容量型バッテリと高容量型バッテリで分担している様子を表わしている。
【００３４】一般的に高容量型バッテリは、高出入力および出入力の瞬間的な変動に対して劣化が進行するので、劣化の進行が抑制される範囲で出入力が行われるように制御されることが好ましい。したがって、ＯＢとＶＢの変化からわかるように、負荷側から大きな出入力が要求される場合には、原則として高出力型バッテリ（ＯＢ）が担い、高出力型バッテリでも応えられない場合に、高容量型バッテリ（ＶＢ）が補助する制御が行われる。また、高容量型バッテリは、あまり高くない値で継続的に出力する場合に適しており、この場合は、高出力型バッテリの出力は抑えられる。また、高容量型バッテリは高いレートの充電に相 10当する回生電力を受け入れた場合に劣化しやすいという特性を有するので、回生電力はできる限り高出力型バッテリで受け入れる制御が行われる。なお、回生電力が高出力型バッテリで受け入れられる容量を上回る場合には、高容量型バッテリで受入れる以外に、ブレーキを動作させて回生電力の発生を低減しても良い。この場合、高容量型バッテリの劣化を抑制できる。
【００３５】また、高容量型バッテリと高出力型バッテリは、それぞれＳＯＣに基づく劣化影響度も大きく異なる。高容量型バッテリは、ＳＯＣが変動しても、劣化影響度が大きく変動することはない。換言すれば、ＳＯＣがいかなる値であっても劣化の進行に大きな影響を与えることはない。一方、高出力型バッテリは、ＳＯＣが変動すると、劣化影響度もその値に 20応じて大きく変動する。より詳述すると、ＳＯＣが３０〜７０％の中央域では、高出力型バッテリの劣化影響度は小さいが、この中央域から離れるに従って、劣化影響度は大きくなる。すなわち、中央域から離れるほど劣化が進む。したがって、高容量型バッテリのＳＯＣが、０〜３０％の低域や７０〜１００％の高域に属さないように、高容量型バッテリと高出力型バッテリの充放電量を調整することが好ましい。
【００３６】このように特性の異なる複数の蓄電池を利用することにより、それぞれの蓄電池の劣化を抑制しつつ、負荷側からのさまざまな出力要求に応えることができる。ただし、それぞれの蓄電池をどのように使い分け、どのような割合で出入力を混合させるかは、蓄電池の現在の状態を正確に把握して、その状態に応じて適宜変更、修正することが重要である。 30特に、刻々と変化するＳＯＣの正確な把握は、輸送機器の駆動制御に対して非常に重要である。
【００３７】そこで、蓄電池におけるＳＯＣとＯＣＶとの相関関係について説明する。図３は、ある電池のＳＯＣ−ＯＣＶカーブを示すグラフである。ＳＯＣ−ＯＣＶカーブは、ＳＯＣとＯＣＶの関係である相関情報の一例である。横軸は、ＳＯＣをパーセント（％）で表わし、縦軸は、ＯＣＶをボルト（Ｖ）で表わす。
【００３８】グラフ上に描かれる複数のカーブは、それぞれ異なる容量維持率に対するＳＯＣ−ＯＣＶカーブを表わしている。容量維持率は、使用が繰り返されることによる劣化や、経時に 40よる劣化の程度を示しており、具体的には、新品時において貯蔵できる電気量（１００％）に対して、満充電でどれだけの電気量を貯蔵できるかをパーセントで表したものである。例えば、使用を繰り返したある時点において満充電まで充電した場合に、初期の貯蔵電気量に対して８０％の電気量しか貯蔵できなくなった蓄電池は、容量維持率８０％の蓄電池である。換言すれば容量維持率がその蓄電池の劣化度合いを示していると言える。
【００３９】図３において、実線は容量維持率１００％の、点線は９０％の、一点鎖線は８０％の、二点鎖線は７０％の、破線は６０％のＳＯＣ−ＯＣＶカーブを表わす。なお、容量維持率が１００％でない場合のＳＯＣは、劣化が進んだ状態における満充電の貯蔵電気量を１００％とした場合の充電率である。劣化が進行すると、カーブが全体的に左上方向に遷移す 50(10) JP 5980457 B1 2016.8.31る様子がわかる。例えば、ＯＣＶが３．９Ｖである場合に、容量維持率が９０％の場合のＳＯＣは７０％であるのに対し、容量維持率が７０％の場合のＳＯＣは６０％であると読み取れる。多くの蓄電池が概してこのような傾向の性質を示す。
【００４０】すなわち、蓄電装置が搭載する蓄電池が現時点においてどれくらい劣化が進行しているかにより、同じＯＣＶから推定されるＳＯＣが大きく異なってしまうことになる。つまり、ＯＣＶを測定しても、蓄電池の劣化状態の考慮なしには、正確にＳＯＣを把握できないことになる。
【００４１】そこで、本実施形態における蓄電装置１００は、搭載する第１蓄電池１１１および第２ 10蓄電池１２１のそれぞれに対して、予め定められた条件を満たす時点ごとに、ＳＯＣ−ＯＣＶカーブを確定するための充放電制御を実行する。
【００４２】図４は、ある時点においてＳＯＣ−ＯＣＶカーブを確定するまでの手順を説明するための図である。図３と同じく、横軸は、ＳＯＣをパーセント（％）で表わし、縦軸は、ＯＣＶをボルト（Ｖ）で表わす。また、示されている複数のカーブはそれぞれ、図３で用いた線種に従って、モデル化された蓄電池の、各容量維持率に対するＳＯＣ−ＯＣＶカーブを表わす。
【００４３】出願人は、さまざまな蓄電池に対して検討を重ねた成果として、容量維持率が互いに異 20なるＳＯＣ−ＯＣＶカーブであっても、あるＯＣＶに対するＳＯＣのばらつきが一定の範囲に収まる領域が、多くの蓄電池において存在することを発見した。このような領域を「基準領域」と呼ぶこととする。基準領域は、例えば、ＳＯＣが１００％に近い範囲で見受けられる。これは、蓄電池の満充電電圧におけるＳＯＣを１００％として定義しているため、蓄電池の電圧を満充電電圧の近傍とすれば、容量維持率によらずＳＯＣは１００％の近傍となるからである。図４の例では、ＯＣＶがＶ の範囲（Ｏ ≦Ｖ ＜ＯＲ ｍｉｎ ０ ｍａｘ）において、いずれの容量維持率であっても、残容量がＳ （Ｓ ≦Ｓ ＜ＳＲ ｍｉｎ ０ ｍａｘ）の範囲に収まることを表わしている。Ｖ の範囲のＯＣＶを「基準ＯＣＶ」と呼び、ＳＲの範囲のＳＯＣを「基準ＳＯＣ」と呼ぶこととする。Ｒ
【００４４】 30基準領域の範囲としては、基準ＯＣＶの範囲として０．１Ｖ（Ｏ とＯ の差ｍａｘ ｍｉｎ）、基準ＳＯＣの範囲として３％（Ｓ とＳ の差）が好ましい。ここでいう基ｍａｘ ｍｉｎ準ＯＣＶの範囲は、単セルにおける電圧の範囲であって良い。基準ＯＣＶの範囲は、蓄電池の公称電圧の３％であって良い。基準領域の範囲は、対象とする蓄電池の特性や、要求される正確性等に応じて、適宜最適化すれば良い。
【００４５】本実施形態における蓄電装置１００は、上記の通り、第１蓄電池１１１と第２蓄電池１２１の間で蓄電池部間充放電を行うことができる。すなわち、一方の蓄電池の電力を他方に移すことができる。すると、蓄電池部間充放電を行うことにより、ＳＯＣ−ＯＣＶカーブを確定させたい側の蓄電池のＯＣＶを、その蓄電池における基準ＯＣＶの範囲に移動さ 40せることができる。基準ＯＣＶに対応するＳＯＣは、容量維持率に関わらず基準ＳＯＣであるので、その値を例えばＳ とＳ の平均値とすれば、ＳＯＣ−ＯＣＶの２次ｍｉｎ ｍａｘ元平面（ここでは、「ＳＯ平面」と呼ぶ）上の基準領域に、座標Ｓｐ （Ｓｔ ，Ｏｔ０ ０ ０）をプロットすることができる。
【００４６】その後、予め定められた条件、回数にしたがって、蓄電池部間充放電を繰り返す。このとき、例えばＳＯＣ−ＯＣＶカーブを確定させたい側の蓄電池が第１蓄電池１１１である場合には、第１電流センサ１１３の電流Ｉ を監視することにより、第１蓄電池１１１の１ＳＯＣの増減分を算出することができる。また、第１スイッチ１１４を開状態にすれば、そのときの第１蓄電池１１１のＯＣＶを検出することもできる。すると、１回の蓄電池部 50(11) JP 5980457 B1 2016.8.31間充放電を行うごとに、ＳＯ平面上に１つの座標Ｓｐをプロットすることができる。図４の例では、基準領域内の座標Ｓｐ を得た後に、蓄電池部間充放電を３回繰り返し、座標０Ｓｐ 、Ｓｐ 、Ｓｐ を得ている。１ ２ ３
【００４７】例えば電池メーカーによって、蓄電池の型番ごとに各容量維持率に対するＳＯＣ−ＯＣＶカーブが参照データとして予め準備されている。図４では、１００％、９０％、８０％、７０％、６０％のそれぞれにおけるＳＯＣ−ＯＣＶカーブが参照データである。参照データは、例えば５％刻み、あるいは１％刻みなどの、より細かい割合で準備されていると良い。または、容量維持率に対するＳＯＣ−ＯＣＶカーブの変動が大きい範囲では、小さい範囲より細かい割合で参照データを設けていても良く、データ量および参照データを準 10備に要する手間を削減できる。蓄電装置１００は、具体的には後述するが、この参照データを記憶部に記憶しており、電池ＥＣＵ１３０は、適宜参照することができる。
【００４８】蓄電池部間充放電を繰り返すことにより複数の座標Ｓｐを得たら、電池ＥＣＵ１３０は、これらの座標に対して最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データからマッチング処理により選ぶ。例えば、複数の座標Ｓｐとの偏差が最も小さいＳＯＣ−ＯＣＶカーブを選ぶ。このとき選んだＳＯＣ−ＯＣＶカーブが、その時点における最も確からしいＳＯＣ−ＯＣＶカーブとなる。このようにして、その時点における蓄電池のＳＯＣ−ＯＣＶカーブを推定する。図４の例においては、容量維持率が９０％のＳＯＣ−ＯＣＶカーブである。このＳＯＣ−ＯＣＶカーブを記憶しておくことにより、外部から要求されるＳＯＣ 20の確認に対して、ＯＣＶを計測すれば即座にその時点における高精度なＳＯＣを返すことができる。このように蓄電池部間充放電を行って適宜確定されるＳＯＣ−ＯＣＶカーブは、その時点における現実のＳＯＣ−ＯＣＶカーブをより忠実に表わしたものとなるので、現実のＳＯＣに対して非常に近いＳＯＣを外部からの確認要求に対して返すことができる。
【００４９】なお、上記の説明においては、まず基準領域内に座標Ｓｐ が得られるように蓄電池部０間充放電をおこなったが、座標Ｓｐを得る順番はこれに限らない。複数回の蓄電池部間充放電を行った結果、少なくとも１つの座標Ｓｐが基準領域内に含まれていれば、参照データとマッチング処理を行うことができる。一方の蓄電池のＳＯＣとＯＣＶを基準領域にす 30べく、過度な蓄電部間充放電を必要とする場合は、複数回の蓄電部間充放電によって、複数の座標を得ながらＳＯＣ−ＯＣＶカーブを生成する蓄電池の電圧とＳＯＣを基準領域に移すことが好ましい。そして、複数回の蓄電部間充放電によって得た座標を基準領域に基づいて修正することで、基準領域にＳＯＣ−ＯＣＶカーブを生成する蓄電部の電圧とＳＯＣを基準領域に属するためだけに、過度の蓄電部間充放電を必要としない、正確なＳＯＣ−ＯＣＶカーブを生成できる。
【００５０】また、上記の説明においては、最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データから選んだが、まずはそれぞれの座標の偏差が閾値以下となる複数のＳＯＣ−ＯＣＶカーブを選び、その中から他の基準に基づいて一つのＳＯＣ−ＯＣＶカーブを確定させても良い 40。他の基準としては、新しく取得した座標ほど偏差が小さいなどが挙げられる。この様な構成とすることで、何らかの事情によって途中で蓄電部間充放電を停止しなければならい状態でも、ＳＯＣ−ＯＣＶカーブを特定できる。
【００５１】なお、上記の説明においては、参照データの各ＳＯＣ−ＯＣＶカーブと複数の座標Ｓｐとのマッチング処理を行うことにより、ＳＯＣ−ＯＣＶカーブを推定している。しかし、広い範囲のＳＯＣで座標Ｓｐが取得できている場合には、参照データを参照することなく、複数の座標Ｓｐから近似曲線または近似直線を算出し、当該近似曲線または近似直線をＳＯＣ−ＯＣＶカーブとして推定しても良い。近似曲線または近似直線は、最小二乗法などに基づくフィッティングによって算出されて良い。ＳＯＣ−ＯＣＶ平面における座標Ｓ 50(12) JP 5980457 B1 2016.8.31ｐについて、隣接するＳＯＣ同士を直線で結ぶことによって各区間の近似直線を算出して良い。座標Ｓｐが３点以上の場合は、近似直線の集合としての折れ線が算出される。なお、参照データにおける各容量維持率のＳＯＣ−ＯＣＶカーブは、例えば電池メーカーが準備する、その型の蓄電池の代表データであるので、信頼性は高い。しかしながら、個々の製品のばらつきまでは対応していないので、そのばらつきは誤差となってしまう。しかし、実測された座標Ｓｐから近似曲線または近似直線を算出すれば、個々のばらつきまで吸収した、生のＳＯＣ−ＯＣＶカーブを得ることができる。したがって、より精度の高いＳＯＣ−ＯＣＶカーブとして利用できる可能性がある。また、蓄電池の種類によっては、基準領域が存在しない場合もあり得るが、このような場合であっては、実測された座標Ｓｐから算出された近似曲線または近似直線と参照データを併用して、ＳＯＣ−ＯＣＶカーブ 10を確定することができる。具体的には、参照データに含まれる各容量維持率のＳＯＣ−ＯＣＶカーブの中で、実測された座標Ｓｐから算出された近似曲線または近似直線と最も近い形状を有するものを、ＳＯＣ−ＯＣＶカーブとして確定する。また、近似曲線または近似直線によりＳＯＣ−ＯＣＶカーブを推定する場合において、蓄電池の現在の容量維持率を推定するときは、参照データのＳＯＣ−ＯＣＶカーブのうち近似曲線または近似直線と最も近い形状を有するＳＯＣ−ＯＣＶカーブに対応する容量維持率を、現在の容量維持率と推定してよい。
【００５２】ここで、蓄電池部間充放電をおこなって次の座標Ｓｐを確定させる手順について説明する。図５は、平面空間上で座標を確定させるための演算を説明する図である。一つ目の× 20印で表わされるＳｐ は、ｎ個目の座標としてＳＯ平面上にプロットされたものであり、ｎ座標値（Ｓｔ ，Ｏｔ ）で表わされる。この後に１回の蓄電池部間充放電を行ってプロｎ ｎットされたｎ＋１個目の座標が、二つ目の×印で表わされるＳｐ である。ｎ＋１
【００５３】それぞれの座標値の差は、ＯＣＶがΔＯＣＶ、ＳＯＣがΔＳＯＣと表わされ、それぞれ正の値の場合もあれば、負の値である場合もある。すなわち、（Ｓｔ ，Ｏｔ ）＝（Ｓｔ ＋ΔＳＯＣ，Ｏｔ ＋ΔＯＣＶ）ｎ＋１ ｎ＋１ ｎ ｎである。ここで、Ｏｔ もＯｔ も、ＯＣＶであるので、これらの値は実測して直ｎ ｎ＋１接得られる。一方ΔＳＯＣは、ΔＳＯＣ＝Ｓｔ −Ｓｔ であり、ｎ＋１ ｎΔＳＯＣ＝ΣＩ／Ｃ 30ｆｕｌｌあるいは、ΔＳＯＣ＝ΔＡｈ／Ｃｆｕｌｌによって算出される。ここで、ΣＩは、時刻ｔ からｔ までに電流センサが出力ｎ ｎ＋１する値の総和であり、ΔＡｈは、この間に変化した電気量を表わす。また、Ｃ はｆｕｌｌ、前回のＳＯＣ−ＯＣＶカーブの確定時点における満充電時の電気量である。Ｃｆｕｌｌは、ＳＯＣ−ＯＣＶカーブが確定されるごとにその値が記憶部に格納される。例えばＣｆは、ＳＯＣ−ＯＣＶカーブが確定されると、確定されたＳＯＣ−ＯＣＶカーブに対ｕｌｌ応する容量維持率と初期容量から定まる。
【００５４】なお、以上の説明では主として、ＳＯＣ−ＯＣＶカーブの確定処理を分かり易く説明す 40ることを目的として、二次元平面における座標ＳＰを用いて説明した。座標ＳＰをプロットする、または、座標ＳＰを特定することは、内部処理としては、（ＳＯＣ，ＯＣＶ）のデータを取得して格納することに対応する。また、以上の説明では主として、ＳＯＣ−ＯＣＶカーブの確定処理を分かり易く説明することを目的として、ＳＯＣ毎について１つのＯＣＶを取得する場合を取り上げて説明した。しかし、ＳＯＣ毎に１つまたは複数のＯＣＶを取得して良い。
【００５５】以上説明したＳＯＣ−ＯＣＶカーブの確定までを電池ＥＣＵ１３０がどのようにおこなっているのか、電池ＥＣＵ１３０を機能ブロックで表わして説明する。図６は、電池ＥＣＵ１３０の内部ブロック図を、電池ＥＣＵ１３０用のプログラムを格納する記録媒体２９ 50(13) JP 5980457 B1 2016.8.31０とともに示す。
【００５６】図示するように、電池ＥＣＵ１３０は、制御および演算の全体を担う制御演算部２３０、ΔＳＯＣ算出部２３１、計時部２３２、ＢＡＴＴ情報格納部２３３、確定ライン保持部２３４を有する。これらの機能ブロックによりＳＯＣ−ＯＣＶカーブを確定するまでの処理を行う。電池ＥＣＵ１３０は、この他にも主に、ＳＯＣ応答部２３５を有する。
【００５７】制御演算部２３０は、第１蓄電池１１１の充電率と開放端電圧である第１ＳＯＣと第１ＯＣＶの組合せである第１データと、第２蓄電池１２１の充電率と開放端電圧である第２ＳＯＣと第２ＯＣＶの組合せである第２データとを、第１蓄電池１１１と第２蓄電池１２ 10１の間の複数回の電荷移動のそれぞれの前後で取得する。なお、第１データとは、例えば第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データの集合である。第２データとは、例えば第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データの集合である。
【００５８】制御演算部２３０は、基準データを含む第１データの集合から、第１蓄電池１１１のＳＯＣとＯＣＶの相関情報である第１相関を生成する第１操作を実行する。制御演算部２３０は、電池ＥＣＵ１３０が記憶している複数の記憶済データと第２データの集合の比較に基づいて、第２蓄電池１２１のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行する。
【００５９】 20なお、複数の記憶済データは、ＢＡＴＴ情報格納部２３３に記憶されていてよい。また、基準データとは、第１蓄電池１１１の複数の劣化状態において同一のＯＣＶに対するＳＯＣの偏差が閾値以下である第１データであってよい。
【００６０】制御演算部２３０は、第２蓄電池１２１の劣化状態と記憶済データを対応付けて記憶してよい。例えば、記憶済データは、異なる容量維持率に対するＳＯＣ−ＯＣＶカーブであってよい。制御演算部２３０は、第２蓄電池１２１の現在の劣化状態を推定し、複数の記憶済データのうち現在の劣化状態より進行した劣化状態が対応付けられた記憶済データのみと第２データの集合を比較して良い。なお、制御演算部２３０は、推定した第２相関に基づいて現在の劣化状態を決定して良い。 30
【００６１】制御演算部２３０は、第２相関を前回推定した時刻から第２蓄電池１２１が充放電した電流の累積値に基づいて、複数の記憶済データのうち複数の第２データの集合と比較する記憶済データを選択して良い。例えば、制御演算部２３０は、電流の累積値に対応する劣化状態より、予め定められた値以上進行した劣化状態が対応付けられた記憶済データを除外して、複数の第２データの集合と比較する記憶済データを選択して良い。
【００６２】なお、制御演算部２３０は、第１データの集合に対する近似曲線または近似直線に基づき、第１相関を生成してよい。これに対し、第２相関を生成する場合には、制御演算部２３０は、複数の記憶済データのうち、第２データの集合に対する適合度がより高い記憶済 40データをより優先して選択して、第２相関を生成して良い。
【００６３】制御演算部２３０は、第１蓄電池１１１の複数の劣化状態において同一のＳＯＣに対するＯＣＶの差分が閾値以下となるＳＯＣである基準ＳＯＣの範囲に第１蓄電池１１１のＳＯＣが含まれるときからの第１蓄電池１１１への電荷移動量に基づいて、電荷移動の後の第１ＳＯＣを取得してよい。制御演算部２３０は、基準ＳＯＣに対応するＯＣＶである基準ＯＣＶの範囲に第１蓄電池１１１のＳＯＣが含まれるときからの第１蓄電池１１１への電荷移動量に基づいて、電荷移動の後の第１ＳＯＣを取得して良い。
【００６４】制御演算部２３０は、電荷移動を行う前の第１蓄電池１１１のＳＯＣが基準ＳＯＣの範 50(14) JP 5980457 B1 2016.8.31囲に含まれない場合、電荷移動に先立ち、第１蓄電池１１１のＳＯＣが基準ＳＯＣの範囲に含まれるよう、第１蓄電池１１１と第２蓄電池１２１との間の充放電を行ってよい。制御演算部２３０は、電荷移動を行う前の第１蓄電池１１１のＯＣＶが基準ＯＣＶの範囲に含まれない場合、電荷移動に先立ち、第１蓄電池１１１のＯＣＶが基準ＯＣＶの範囲に含まれるよう、第１蓄電池１１１と第２蓄電池１２１との間の充放電を行って良い。
【００６５】第１蓄電池１１１と第２蓄電池１２１の少なくとも一方は、モータジェネレータＭＧに電力を供給する。なお、モータジェネレータＭＧは駆動部の一例である。充放電回路モジュール１０３は、第１蓄電池１１１、第２蓄電池１２１、および駆動部の間の充放電を担ってよい。制御演算部２３０は、電荷移動を行う間、第１蓄電池１１１と第２蓄電池１２ 10１が、駆動部との間で充放電を行わないよう充放電回路を制御して良い。
【００６６】なお、電池ＥＣＵ１３０は一種のコンピュータである。制御演算部２３０は、例えばＭＰＵによって構成され、例えばＭＰＵの内部記憶部に格納されたプログラムを実行し、当該プログラムに従って蓄電装置１００の全体を制御する。電池ＥＣＵ１３０により実行されるプログラムは、記録媒体２９０から電池ＥＣＵ１３０に供給される。なお、記録媒体２９０は、コンピュータにより読み出し可能な媒体の一例である。電池ＥＣＵ１３０内においてプログラムまたはコンピュータ命令が格納される任意の媒体を、電池ＥＣＵ１３０用のプログラムを格納する媒体とみなすことができる。
【００６７】 20制御演算部２３０は、充放電回路モジュール１０３を制御する。また、制御演算部２３０は、第１スイッチ１１４、第２スイッチ１２４、第３スイッチ１３３を状況に応じて開閉すべく、開閉指示信号ＣＷ 、ＣＷ 、ＣＷ をそれぞれに向けて送信する。また、第１ ２ ３１ＶＣＵ１３１、第２ＶＣＵ１３２の変換電圧を調整すべく、ＰＷＭ信号である制御信号ＣＶ 、ＣＶ をそれぞれに向けて送信する。ΔＳＯＣ算出部２３１は、第１蓄電池１１１ ２１の（ＳＯＣ，ＯＣＶ）データの取得時には、第１電流センサ１１３からＩ を取得して１、ΔＳＯＣを算出する。同様に、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データの取得時には、第２電流センサ１２３からＩ を取得して、ΔＳＯＣを算出する。ΔＳＯＣ算出部２２３１は、算出したΔＳＯＣを制御演算部２３０へ引き渡す。
【００６８】 30計時部２３２は、蓄電池部間充放電を行った時刻を制御演算部２３０へ引き渡す。制御演算部２３０は、（ＳＯＣ，ＯＣＶ）データが取得された時刻を内部記憶部に記憶しておき、当該（ＳＯＣ，ＯＣＶ）データが取得された時刻から予め定められた経過時間を過ぎた場合に、マッチング処理の対象から除外する。
【００６９】ＢＡＴＴ情報格納部２３３は、上記の参照データを記憶する記憶部である。具体的には、不揮発性のフラッシュメモリ等により構成される。ＢＡＴＴ情報格納部２３３は、参照データを外部機器から取得する。なお、ＢＡＴＴ情報格納部２３３は、参照データを記憶するに限らず、蓄電池に関する様々な情報を記憶しており、必要に応じて制御演算部２３０へ提供する。ＢＡＴＴ情報格納部２３３は、第１蓄電池１１１の複数の劣化状態におけ 40るＳＯＣとＯＣＶの相関情報を予め記憶する。ＢＡＴＴ情報格納部２３３は、第２蓄電池１２１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報を予め記憶する。例えば、蓄電装置１００の製造時に、第１蓄電池１１１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報と、第２蓄電池１２１の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報とが、ＢＡＴＴ情報格納部２３３に格納される。なお、第１蓄電池１１１および第２蓄電池１２１のうち、ＳＯＣ−ＯＣＶカーブの推定対象とならない蓄電池については、ＢＡＴＴ情報格納部２３３に相関情報が格納されなくても良い。制御演算部２３０は、対象ＳＯＣと対象ＯＣＶを含む複数のデータに対する近似曲線または近似直線に基づき、相関情報を推定して良い。制御演算部２３０は、ＢＡＴＴ情報格納部２３３が記憶している対象蓄電池の複数の劣化状態におけるＳＯＣとＯＣＶの相関情報のうち、対象ＳＯＣと対象ＯＣＶを 50(15) JP 5980457 B1 2016.8.31含む複数の（ＳＯＣ，ＯＣＶ）データに対する適合度がより高い相関情報を、推定する相関情報として、より優先して選択して良い。
【００７０】確定ライン保持部２３４は、制御演算部２３０が確定したＳＯＣ−ＯＣＶカーブを記憶する記憶部である。具体的には、不揮発性のフラッシュメモリ等により構成される。記憶部としてＢＡＴＴ情報格納部２３３と一体的に構成されていても良い。
【００７１】ＳＯＣ応答部２３５は、確定ライン保持部２３４と接続されている。ＳＯＣ応答部２３５は、外部からＳＯＣの問合せを受けると、ＯＣＶとしてＶ 、Ｖ を取得し、確定ライ１ ２ン保持部２３４に記憶されたＳＯＣ−ＯＣＶカーブを参照して、ＳＯＣを返す。制御演算 10部２３０により第１蓄電池１１１の相関情報が推定されている場合、ＳＯＣ応答部２３５は、第１蓄電池１１１のＳＯＣの問合せを受けたとき、第１蓄電池１１１のＯＣＶと、制御演算部２３０により推定された相関情報とに基づいて、第１蓄電池１１１のＳＯＣを算出して応答する。制御演算部２３０により第２蓄電池１２１の相関情報が推定されている場合、ＳＯＣ応答部２３５は、第２蓄電池１２１のＳＯＣの問合せを受けたとき、第２蓄電池１２１のＯＣＶと、制御演算部２３０により推定された相関情報とに基づいて、第２蓄電池１２１のＳＯＣを算出して応答する。
【００７２】図７は、蓄電池部間充放電を行う毎に第１蓄電池１１１及び第２蓄電池１２１のそれぞれの（ＳＯＣ，ＯＣＶ）データが取得される様子を示す。図示されるように、制御演算部 20２３０は、時刻ｔ１において、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＣ ）データと、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データであるＰ１ Ｐ１（ＳＯＣ ，ＳＯＣ ）データとを取得する。Ｅ１ Ｅ１
【００７３】その後、制御演算部２３０は、次に（ＳＯＣ，ＯＣＶ）データを取得する第１蓄電池１１１のＳＯＣである取得対象ＳＯＣを決定する。制御演算部２３０は、蓄電池部間充放電を行って、第１蓄電池１１１のＳＯＣを当該取得対象ＳＯＣに変化させる。これにより、第２蓄電池１２１のＳＯＣも変化する。時刻ｔ２において、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＣ ）データと、第２蓄電池１２１の（ＳＰ２ Ｐ２ＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＣ ）データとを取得する。これによ 30Ｅ２ Ｅ２り、１回の蓄電池部間充放電によって、第１蓄電池１１１および第２蓄電池１２１のそれぞれの（ＳＯＣ，ＯＣＶ）データを取得できる。
【００７４】続いて、制御演算部２３０は、更なる次の（ＳＯＣ，ＯＣＶ）データを取得する第１蓄電池１１１のＳＯＣである取得対象ＳＯＣを決定する。ここで、取得対象ＳＯＣは、ＳＯＣ およびＳＯＣ のいずれとも異なる値である。そして、制御演算部２３０は、１Ｐ１ Ｐ２回の蓄電池部間充放電を行って、第１蓄電池１１１のＳＯＣを当該取得対象ＳＯＣに変化させる。これにより、第２蓄電池１２１のＳＯＣも変化する。そして、時刻ｔ３において、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＣ ）デーＰ３ Ｐ３タと、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＣ ） 40Ｅ３ Ｅ３データとを取得する。
【００７５】続いて、制御演算部２３０は、更なる次の（ＳＯＣ，ＯＣＶ）データを取得する第１蓄電池１１１のＳＯＣである取得対象ＳＯＣを決定する。ここで、取得対象ＳＯＣは、ＳＯＣ 、ＳＯＣ 、およびＳＯＣ いずれとも異なる値である。そして、制御演算部Ｐ１ Ｐ２ Ｐ３２３０は、１回の蓄電池部間充放電を行って、第１蓄電池１１１のＳＯＣを当該取得対象ＳＯＣに変化させる。これにより、第２蓄電池１２１のＳＯＣも変化する。そして、時刻ｔ４において、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，ＳＯＰ４Ｃ ）データと、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データである（ＳＯＣ ，Ｐ４ Ｅ４ＳＯＣ ）データとを取得する。 50Ｅ４(16) JP 5980457 B1 2016.8.31
【００７６】このように、制御演算部２３０は、３回の蓄電池部間充放電のそれぞれの前後で（ＳＯＣ，ＯＣＶ）データを取得することで、第１蓄電池１１１および第２蓄電池１２１のそれぞれについて、４個の（ＳＯＣ，ＯＣＶ）データを取得できる。これにより、第１蓄電池１１１および第２蓄電池１２１の両方の（ＳＯＣ，ＯＣＶ）データを効率的に取得することができる。このため、第１蓄電池１１１および第２蓄電池１２１の両方の（ＳＯＣ，ＯＣＶ）データを短時間で収集できる。また、第１蓄電池１１１と第２蓄電池１２１との間で移動させる電荷量を低減できる。そのため、第１蓄電池１１１および第２蓄電池１２１の劣化が進行することを抑制できる。
【００７７】 10図８は、収集した第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データから、第１蓄電池１１１の現在のＳＯＣ−ＯＣＶカーブを確定する処理を説明するための図である。図８において、ＳＯＣ−ＯＣＶカーブ８１０は、第１蓄電池１１１の容量維持率が１００％である場合のＳＯＣ−ＯＣＶカーブを示す。ＳＯＣ−ＯＣＶカーブ８０９、ＳＯＣ−ＯＣＶカーブ８０８、ＳＯＣ−ＯＣＶカーブ８０７およびＳＯＣ−ＯＣＶカーブ８０６は、それぞれ第１蓄電池１１１の容量維持率が９０％、８０％、７０％および６０％である場合のＳＯＣ−ＯＣＶカーブを示す。
【００７８】データ８５１、データ８５２、データ８５３およびデータ８５４は、図７に関連して説明した第１蓄電池１１１の４個の（ＳＯＣ，ＯＣＶ）データの集合を示す。制御演算部２ 20３０は、ＳＯＣ−ＯＣＶカーブ８１０、ＳＯＣ−ＯＣＶカーブ８０９、ＳＯＣ−ＯＣＶカーブ８０８、ＳＯＣ−ＯＣＶカーブ８０７およびＳＯＣ−ＯＣＶカーブ８０６のそれぞれと、４個の（ＳＯＣ，ＯＣＶ）データとを比較して、４個の（ＳＯＣ，ＯＣＶ）データに最も適合するＳＯＣ−ＯＣＶカーブ８０８を、現在のＳＯＣ−ＯＣＶカーブとして決定する。また、制御演算部２３０は、第１蓄電池１１１の現在の容量維持率として、ＳＯＣ−ＯＣＶカーブ８０８に対応づけられた８０％を決定する。このように、制御演算部２３０は、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定する場合に、全ての容量維持率に対応する全てのＳＯＣ−ＯＣＶカーブに対して、収集した（ＳＯＣ，ＯＣＶ）データをマッチングして、現在のＳＯＣ−ＯＣＶカーブを確定してよい。
【００７９】 30なお、図７及び図８の説明では、第１蓄電池１１１及び第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データを取得して第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定するまでの全体的な処理を分かり易く説明するために、４個の（ＳＯＣ，ＯＣＶ）データを取得して、４個の（ＳＯＣ，ＯＣＶ）データからＳＯＣ−ＯＣＶカーブを推定する処理を説明した。しかし、上述したように、（ＳＯＣ，ＯＣＶ）データから算出された近似曲線または近似直線をＳＯＣ−ＯＣＶカーブとして確定することにより、現在のＳＯＣ−ＯＣＶカーブを推定してもよい。取得する（ＳＯＣ，ＯＣＶ）データがより多いほど、（ＳＯＣ，ＯＣＶ）データから算出された近似曲線または近似直線の精度をより高めることができる。
【００８０】図７で説明したように、蓄電部間充放電は、第１蓄電池１１１のＳＯＣが取得対象ＳＯ 40Ｃとなるように行われるため、収集された第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データは、必ずしもマッチングに適したものとはならない。加えて、第２蓄電池１２１は第１蓄電池１１１より容量が大きいため、蓄電部間充放電では原理上、第２蓄電池１２１のＳＯＣの全てを収集できない。このような理由により、第２蓄電池１２１では複数のＳＯＣ−ＯＣＶカーブがマッチングしてしまう可能性がある。そこで、予めマッチング対象とするＳＯＣ−ＯＣＶカーブを取捨選択することで、マッチングの精度を向上させる。図９は、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データに対するマッチング対象のＳＯＣ−ＯＣＶカーブを選択する処理を説明する図である。ここでは、現在の容量維持率として８０％が確定されているとする。
【００８１】 50(17) JP 5980457 B1 2016.8.31制御演算部２３０は、現在の容量維持率である８０％より高い容量維持率に対応づけられたＳＯＣ−ＯＣＶカーブを、マッチング対象から除外する。同じ蓄電池の容量維持率が時間の経過とともに高くなることは、事実上考えられないためである。
【００８２】また、制御演算部２３０は、前回ＳＯＣ−ＯＣＶカーブを確定したときからの第２蓄電池１２１から流出した電流及び流入した電流の積算値に基づいて、容量維持率の下限値を決定する。例えば、制御演算部２３０は、電流の積算値に基づいて、容量維持率が低下し得る最大値を算出する。例えば、制御演算部２３０は、容量維持率の低下量の最大値と電流の積算値とを対応づけるマップと、前回ＳＯＣ−ＯＣＶカーブを確定したときからの電流の積算値とに基づいて、容量維持率の低下量の最大値を決定する。そして、制御演算部 10２３０は、現在の第２蓄電池１２１の容量維持率から、決定した容量維持率の低下量の最大値を減算することにより、容量維持率の下限値を決定する。なお、蓄電池の劣化が電流の積算値以外のパラメータにも依存する点や、蓄電池の特異劣化を考慮して、このように決定した容量維持率の下限値にさらにバッファを設けても良い。例えば、容量維持率の下限値より規定値だけ小さい容量維持率を、それ以上低下し得えない最大の容量維持率として決定して良い。
【００８３】例えば、図９において、容量維持率の下限値が６８％であると決定した場合、制御演算部２３０は、容量維持率６０％に対応づけられたＳＯＣ−ＯＣＶカーブをマッチング対象から除外する。これにより、制御演算部２３０は、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ 20）データとのマッチング対象のＳＯＣ−ＯＣＶカーブとして、容量維持率８０％に対応付けられたＳＯＣ−ＯＣＶカーブ９０８と、容量維持率７０％に対応付けられたＳＯＣ−ＯＣＶカーブ９０７とを選択する。なお、容量維持率の下限値に、さらに規定値１０％のバッファを設ける場合、制御演算部２３０は、低下し得る最小の容量維持率として５８％を決定して良い。この場合、制御演算部２３０は、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データとのマッチング対象のＳＯＣ−ＯＣＶカーブとして、５８％以下のＳＯＣが対応付けられたＳＯＣ−ＯＣＶカーブをマッチング対処から除外して、容量維持率８０％に対応付けられたＳＯＣ−ＯＣＶカーブ９０８と、容量維持率７０％に対応付けられたＳＯＣ−ＯＣＶカーブ９０７と、容量維持率６０％に対応付けられたＳＯＣ−ＯＣＶカーブ９０７とを選択して良い。 30
【００８４】図１０は、収集した第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データから、第２蓄電池１２１の現在のＳＯＣ−ＯＣＶカーブを確定する処理を説明するための図である。図１０において、ＳＯＣ−ＯＣＶカーブ９０８およびＳＯＣ−ＯＣＶカーブ９０７は、それぞれ第２蓄電池１２１の容量維持率が８０％および７０％である場合のＳＯＣ−ＯＣＶカーブを示す。
【００８５】データ１０４１、データ１０４２、データ１０４３およびデータ１０４４は、図７に関連して説明した第２蓄電池１２１の４個の（ＳＯＣ，ＯＣＶ）データの集合を示す。制御演算部２３０は、ＳＯＣ−ＯＣＶカーブ９０８およびＳＯＣ−ＯＣＶカーブ９０７のそれ 40ぞれと、４個の（ＳＯＣ，ＯＣＶ）データとを比較して、４個の（ＳＯＣ，ＯＣＶ）データに最も適合するＳＯＣ−ＯＣＶカーブ９０７を決定する。また、制御演算部２３０は、第２蓄電池１２１の現在の容量維持率として、ＳＯＣ−ＯＣＶカーブ９０７に対応づけられた７０％を決定する。このように、制御演算部２３０は、第２蓄電池１２１の現在ＳＯＣ−ＯＣＶカーブを確定する場合、現在の容量維持率に基づいて選択された一部の容量維持率に対応するＳＯＣ−ＯＣＶカーブに対して、収集した（ＳＯＣ，ＯＣＶ）データをマッチングして、現在のＳＯＣ−ＯＣＶカーブを確定する。
【００８６】図示されるように、第２蓄電池１２１については、収集された（ＳＯＣ，ＯＣＶ）データのＳＯＣの範囲は比較的に狭い。これは、第２蓄電池１２１の電池容量は第１蓄電池１ 50(18) JP 5980457 B1 2016.8.31１１の電池容量より大きいため、第１蓄電池１１１と第２蓄電池１２１との間の蓄電池部間充放電のみでは、広いＳＯＣ範囲にわたる（ＳＯＣ，ＯＣＶ）データを取得できないからである。また、そのために、基準ＳＯＣ付近の（ＳＯＣ，ＯＣＶ）データを取得できない場合が多い。これにより、第１蓄電池１１１のＳＯＣと比して、第２蓄電池１２１のＳＯＣの精度は低くなってしまう場合がある。そのため、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データが、現在の容量維持率とはかけ離れた容量維持率のＳＯＣ−ＯＣＶカーブにも適合してしまう可能性がある。したがって、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定した場合と同じように全ての容量維持率に対応する全てのＳＯＣ−ＯＣＶカーブに対して（ＳＯＣ，ＯＣＶ）データをマッチングしたとすると、適切な容量維持率のＳＯＣ−ＯＣＶカーブが選択されない可能性がある。 10
【００８７】これに対し、図９および図１０等に関連して説明したように、制御演算部２３０は、マッチング対象のＳＯＣ−ＯＣＶカーブを、現在の容量維持率と、第２蓄電池１２１への充放電量の積算値とに基づいて、一部のＳＯＣ−ＯＣＶカーブをマッチング対象から除外できる。そのため、現在の容量維持率とはかけ離れた容量維持率のＳＯＣ−ＯＣＶカーブが選択される可能性を低減できる。これにより、第２蓄電池１２１のＳＯＣ−ＯＣＶカーブの確度が高まる。なお、これらの方法を第１蓄電池１１１のマッチングの際に用いても良く、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブの確度をより一層高められる。
【００８８】図１１は、ＳＯＣ−ＯＣＶカーブを確定させるまでのフロー図である。フローは、電池 20ＥＣＵ１３０がＳＯＣ−ＯＣＶカーブを確定させる指示を輸送機器１０の制御部から受け取った時点から開始する。
【００８９】制御演算部２３０は、ステップＳ１０１において、第１蓄電池１１１のＯＣＶが取得可能か否かを判断する。例えば、ＰＤＵ１４１が電力の供給を要求している場合には、当該要求を優先して第１スイッチ１１４および第３スイッチ１３３を閉状態にするので、ＯＣＶの取得はできないと判断する。この場合は、取得できる状態になるまで待機する。
【００９０】第１蓄電池１１１のＯＣＶの取得が可能と判断したら、制御演算部２３０は、ステップＳ１０２へ進み、開閉指示信号ＣＷ を第１スイッチ１１４へ送信して開状態とする。そ 30１して、第１電圧センサ１１２からＶ を取得し、当該電圧値を初期ＯＣＶであるＯ とす１ ０る。制御演算部２３０は、ステップＳ１０３で、取得したＯ が、基準ＯＣＶの範囲に含０まれるか否かを判断する。具体的には、制御演算部２３０は、ＢＡＴＴ情報格納部２３３から第１蓄電池１１１の参照情報を取得し、基準ＯＣＶの範囲Ｏ 〜Ｏ を参照ｍｉｎ ｍａｘする。そして、Ｏ ≦Ｏ ＜Ｏ の関係を満たすか否かを判断する。ｍｉｎ ０ ｍａｘ
【００９１】取得したＯ が基準開放電圧の範囲に含まれないと判断したら、ステップＳ１０４へ進０み、制御演算部２３０は、蓄電池部間充放電を実行する。具体的には、制御演算部２３０は、開閉指示信号ＣＷ 、ＣＷ 、ＣＷ をそれぞれのスイッチに向けて送信して、第１１ ２ ３スイッチ１１４と第２スイッチ１２４を閉状態、第３スイッチ１３３を開状態とする。そ 40して、制御信号ＣＶ 、ＣＶ をそれぞれのＶＣＵに向けて送信して、第２ＶＣＵ１３２１ ２の変換電圧値を第１ＶＣＵ１３１の変換電圧値よりも高く設定する。すると、第２蓄電池１２１は放電状態となり、第１蓄電池１１１は充電状態となるので、一定の電荷が第２蓄電池１２１から第１蓄電池１１１へ移動する。制御演算部２３０は、移動させる電荷の電気量を、各スイッチの開閉時間を調整したり、各ＶＣＵの変換電圧値を調整したりすることによって変更し得る。また、制御演算部２３０は、取得したＯ と基準ＯＣＶの範囲Ｏ０〜Ｏ との差に応じて、移動させる電荷の電気量を決定しても良い。ｍｉｎ ｍａｘ
【００９２】なお、２つのＶＣＵを用いて蓄電池部間充放電を実行する場合には、一方のＶＣＵのみをＰＷＭ制御し、他方のＶＣＵは直結制御を行っても良い。直結制御は、ＤＣ／ＤＣコン 50(19) JP 5980457 B1 2016.8.31バータのハイサイドスイッチのみを閉状態とし、昇降圧せずに電流を通過させる制御である。直結制御を行う場合に制御信号ＣＶ 、ＣＶ は、変換電圧の指令値として「０」が１ ２指定される。
【００９３】ステップＳ１０４で蓄電池部間充放電が完了すると、再びステップＳ１０１へ戻り、ステップＳ１０３の条件を満たすまで、このループを繰り返す。ステップＳ１０３の条件を満たしたら、ステップＳ１０５へ進む。
【００９４】ステップＳ１０５では、制御演算部２３０は、（ＳＯＣ ，ＯＣＶ）のデータをｆｕｌｌ内部記憶部に格納する。ここで、ＳＯＣ は、１００％のＳＯＣに対応する値であ 10ｆｕｌｌる。ＳＯＣ を１００％として良い。また、ＳＯＣ を、Ｓ 以上Ｓｆｕｌｌ ｆｕｌｌ ｍｉｎ ｍ以下の値として良い。例えば、ＳＯＣ ＝（Ｓ ＋Ｓ ）／２としてａｘ ｆｕｌｌ ｍｉｎ ｍａｘ良い。
【００９５】ステップＳ１０７からは、蓄電池部間充放電を繰り返して（ＳＯＣ，ＯＣＶ）データを取得する処理である。制御演算部２３０は、ステップＳ１０７で、第１蓄電池１１１および第２蓄電池１２１の少なくとも一方のＯＣＶの取得が可能か否かを判断する。この判断は、ステップＳ１０１の判断と同様である。第１蓄電池１１１および第２蓄電池１２１の少なくとも一方のＯＣＶの取得が可能でない場合は、可能となるまで待機する。ＯＣＶの取得が可能であればステップＳ１０８において、第１蓄電池１１１および第２蓄電池１２ 20１の少なくとも一方の（ＳＯＣ，ＯＣＶ）データを取得する。なお、ステップＳ１０８における処理については後述する。
【００９６】制御演算部２３０は、ステップＳ１１０へ進み、第１蓄電池１１１および第２蓄電池１２１の少なくとも一方の取得対象の全ＳＯＣにおいて（ＳＯＣ，ＯＣＶ）データを取得したか否かを判断する。まだ取得していないと判断したら、ステップＳ１１１へ進む。
【００９７】ステップＳ１１１は、次の（ＳＯＣ，ＯＣＶ）データを取得する処理を開始する時点で実行される。ステップＳ１１１では、取得対象の全ＳＯＣにおけるデータを、決められた時間以内に取得できたか否かを判断する。例えば、制御演算部２３０は、ステップＳ１０ 30５で格納されたデータの取得時刻から、予め定められた規定時間が経過したか否かを判断する。規定時間は、例えば７日が設定される。規定時間は、走行距離、環境温度、ＳＯＣ−ＯＣＶカーブに要求される精度等に応じて変更し得る。制御演算部２３０は、規定時間が経過していないと判断したら、ステップＳ１０７へ戻り、取得対象のＳＯＣにおけるデータを順次に取得する。規定時間を経過したと判断したら、ステップＳ１０１間で戻る。この場合は、それまで取得した（ＳＯＣ，ＯＣＶ）データを破棄する。このように古いデータを破棄することで、異なる劣化状態で取得されたデータでＳＯＣ−ＯＣＶカーブが確定されなくなるので、確定されるＳＯＣ−ＯＣＶカーブの精度が向上する。
【００９８】ステップＳ１１０で、第１蓄電池１１１および第２蓄電池１２１の少なくとも一方の取 40得対象の全ＳＯＣにおいてデータを取得したと判断したら、ステップＳ１１２へ進み、制御演算部２３０は、取得した複数のデータからＳＯＣ−ＯＣＶカーブを確定する。ステップＳ１１２における処理については後述する。続いて、ステップＳ１１３において、第１蓄電池１１１及び第２蓄電池１２１の両方のＳＯＣ−ＯＣＶカーブを確定したか否かを判断する。第１蓄電池１１１または第２蓄電池１２１のＳＯＣ−ＯＣＶカーブを確定していない場合は、ステップＳ１０５とステップＳ１０７との間へ戻る。両方のＳＯＣ−ＯＣＶカーブが確定された場合は、一連の処理を終了する。
【００９９】図１２は、第１蓄電池１１１および第２蓄電池１２１の少なくとも一方の（ＳＯＣ，ＯＣＶ）データを取得するためのフロー図である。図１２に示すフローは、図１１のフロー 50(20) JP 5980457 B1 2016.8.31におけるステップＳ１０８に適用される。
【０１００】まず、制御演算部２３０は、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データを取得するべきと判断して、次に（ＳＯＣ，ＯＣＶ）データを取得するべき取得対象ＳＯＣを決定する（ステップＳ１２０３）。この場合、制御演算部２３０は、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを確定するために（ＳＯＣ，ＯＣＶ）データを取得することが必要な第１蓄電池１１１のＳＯＣのうち、既に取得済みの（ＳＯＣ，ＯＣＶ）データのＳＯＣに含まれていないＳＯＣを、取得対象ＳＯＣとして決定して良い。
【０１０１】そして、制御演算部２３０は、蓄電池部間充放電により、第１蓄電池１１１のＳＯＣを 10、ステップＳ１２０３で決定した取得対象ＳＯＣに変更する（ステップＳ１２０５）。続いて、制御演算部２３０は、第１蓄電池１１１のＯＣＶを取得する（ステップＳ１２０７）。また、制御演算部２３０は、第２蓄電池１２１のＯＣＶを取得する（ステップＳ１２０９）。そして、制御演算部２３０は、取得対象ＳＯＣとステップＳ１２０７で取得したＯＣＶとの組み合わせを、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データとして内部記憶部に格納する（ステップＳ１２１１）。また、制御演算部２３０は、ステップＳ１２０５の蓄電池部間充放電による電荷の移動量に基づいて第２蓄電池１２１のＳＯＣを算出して、算出したＳＯＣとステップＳ１２０９で取得したＯＣＶとの組み合わせを、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データとして内部記憶部に格納する（ステップＳ１２１３）。これにより、（ＳＯＣ，ＯＣＶ）データを取得するための一連の処理を終了する。 20
【０１０２】これにより、１回の蓄電池部間充放電によって、第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データだけでなく、第２蓄電池１２１の（ＳＯＣ，ＯＣＶ）データを取得することができる。これにより、少なくとも第１蓄電池１１１のＳＯＣ−ＯＣＶカーブの推定に必要な（ＳＯＣ，ＯＣＶ）データを速やかに取得できる。また、同時に、第２蓄電池１２１のＳＯＣ−ＯＣＶカーブを推定するために用いることができる（ＳＯＣ，ＯＣＶ）データも取得できる。なお、第１蓄電池１１１の現在のＳＯＣ−ＯＣＶカーブを現在より予め定められた時間内に確定できている場合、第２蓄電池１２１のＳＯＣ−ＯＣＶカーブ推定用の所定のＳＯＣにおける（ＳＯＣ，ＯＣＶ）データを取得するようにしてもよい。具体的には、ステップＳ１２０３の取得対象ＳＯＣとして第２蓄電池１２１のＳＯＣを決定し、ステ 30ップＳ１２０５において、蓄電池部間充放電により第２蓄電池１２１のＳＯＣを取得対象ＳＯＣに変更してよい。他にも、第１蓄電池１１１の現在のＳＯＣ−ＯＣＶカーブを現在より予め定められた時間内に確定できている場合、第１蓄電池１１１のＳＯＣを取得対象ＳＯＣとする処理と、第２蓄電池１２１のＳＯＣを取得対象ＳＯＣとする処理とを、交互に行ってもよい。
【０１０３】図１３は、複数の（ＳＯＣ，ＯＣＶ）データからＳＯＣ−ＯＣＶカーブを確定するためのフロー図である。図１３に示すフローは、図１１のフローにおけるステップＳ１１２に適用される。
【０１０４】 40ステップＳ１３０１において、制御演算部２３０は、第１蓄電池１１１の取得対象の全ＳＯＣにおいて（ＳＯＣ，ＯＣＶ）データを取得したか否かを判断する。Ｓ１３０１の判断が真の場合、（ＳＯＣ，ＯＣＶ）データから、ＳＯＣ−ＯＣＶカーブを推定する近似曲線または近似直線を算出し（ステップＳ１３０３）、算出した近似曲線または近似直線を、現在のＳＯＣ−ＯＣＶカーブとして確定する（Ｓ１３０５）。
【０１０５】続いて、ステップＳ１３１１において、制御演算部２３０は、第２蓄電池１２１の取得対象の全ＳＯＣにおいて（ＳＯＣ，ＯＣＶ）データを取得したか否かを判断する。Ｓ１３１１の判断が真の場合、マッチング対象から除外するＳＯＣ−ＯＣＶカーブを決定して、マッチング対象のＳＯＣ−ＯＣＶカーブを選択する（ステップＳ１３１２）。例えば、図 50(21) JP 5980457 B1 2016.8.31９に関連して説明したように、制御演算部２３０は、現在の容量維持率より高い容量維持率に対応づけられたＳＯＣ−ＯＣＶカーブを、マッチング対象から除外して良い。また、制御演算部２３０は、第２蓄電池１２１のＳＯＣ−ＯＣＶカーブを前回確定したときからの第２蓄電池１２１に流入した電流及び流出した電流の積算値に基づいて、現在予測される容量維持率の下限値を決定して、当該下限値より規定値以上小さい容量維持率に対応するＳＯＣ−ＯＣＶカーブを、マッチング対象から除外して良い。
【０１０６】そして、制御演算部２３０は、ステップＳ１３１２で選択した一以上のＳＯＣ−ＯＣＶカーブに対して、取得済みの（ＳＯＣ，ＯＣＶ）データとマッチングする（ステップＳ１３１３）。そして、収集済みの（ＳＯＣ，ＯＣＶ）データに最も適合するＳＯＣ−ＯＣＶ 10カーブを選択することにより、現在のＳＯＣ−ＯＣＶカーブを確定する（ステップＳ１３１５）。これにより、ＳＯＣ−ＯＣＶカーブを確定するための一連の処理を終了する。
【０１０７】なお、ステップＳ１３０３においては、（ＳＯＣ，ＯＣＶ）データからＳＯＣ−ＯＣＶカーブを推定する近似曲線または近似直線を算出する処理を行うとした。この処理に代えて、（ＳＯＣ，ＯＣＶ）データを、参照データのＳＯＣ−ＯＣＶカーブとマッチングする処理を行ってもよい。この場合、第１蓄電池１１１については全てのＳＯＣ−ＯＣＶカーブをマッチング対象としてよい。第１蓄電池１１１の（ＳＯＣ，ＯＣＶ）データには、基準ＳＯＣに対応する（ＳＯＣ，ＯＣＶ）データが存在しており、また、各（ＳＯＣ，ＯＣＶ）データのＳＯＣは、基準ＳＯＣにあるときからの電荷移動量から算出されたものであ 20る。また、第１蓄電池１１１については比較的に広いＳＯＣ範囲にわたって（ＳＯＣ，ＯＣＶ）データを取得できる。そのため、第１蓄電池１１１についての（ＳＯＣ，ＯＣＶ）データの精度は比較的に高いので、現在のＳＯＣ−ＯＣＶカーブを高い確度で確定できる。一方で、第２蓄電池１２１に対するＳ１３１２の処理と同様に、制御演算部２３０は、現在の容量維持率より高い容量維持率に対応づけられたＳＯＣ−ＯＣＶカーブを、マッチング対象から除外しても良い。また、制御演算部２３０は、第１蓄電池１１１のＳＯＣ−ＯＣＶカーブを前回確定したときからの第１蓄電池１１１に流入した電流及び流出した電流の積算値に基づいて、現在予測される容量維持率の下限値を決定して、当該下限値より規定値以上小さい容量維持率に対応するＳＯＣ−ＯＣＶカーブを、マッチング対象から除外しても良い。 30
【０１０８】上記の実施形態おいては、第１蓄電池１１１のＯＣＶが基準ＯＣＶに含まれるように調整して（ＳＯＣ，ＯＣＶ）データを取得したが、第１蓄電池１１１のＳＯＣが基準ＳＯＣ含まれるように調整して（ＳＯＣ，ＯＣＶ）データを取得しても良い。この場合は、ＳＯＣがＳ の範囲（Ｓ 〜Ｓ ）に収まるように、蓄電池部間充放電で移動する電Ｒ ｍｉｎ ｍａｘ荷の電気量をＣ に基づいて定めれば良い。ｆｕｌｌ
【０１０９】また、上記に実施形態おいては、第１蓄電池１１１について、基準領域に少なくとも一つの（ＳＯＣ，ＯＣＶ）データが含まれるように調整したが、そのような調整を行うことなく、基準領域に含まれない複数の（ＳＯＣ，ＯＣＶ）データを集めて、そのデータ群に 40最も一致度が高いＳＯＣ−ＯＣＶカーブを参照データから選択して確定しても良い。この場合は、基準領域に（ＳＯＣ，ＯＣＶ）データが含まれる場合に対して精度は落ちるが、より簡易にＳＯＣ−ＯＣＶカーブを確定させることができる。
【０１１０】参照データからＳＯＣ−ＯＣＶカーブを選択して確定する場合は、容量維持率と対応付けられているので、その時点における蓄電池の劣化進行度合を併せて把握することができる。実測した（ＳＯＣ，ＯＣＶ）データから近似曲線または近似直線を算出する場合は、参照データがなくても、ＳＯＣ−ＯＣＶカーブを推定できる。また、ＳＯＣ−ＯＣＶカーブの推定精度が上がる。参照データがあれば、近似曲線または近似直線と形状の一致度が高いＳＯＣ−ＯＣＶカーブを特定することで、劣化進行度合も把握できる。システムが要 50(22) JP 5980457 B1 2016.8.31求する事情に合わせて、ＳＯＣ−ＯＣＶカーブの確定方法を選択できるようにしても良い。また、例えば取得した（ＳＯＣ，ＯＣＶ）データのエラーチェックをおこなうために、両者を併用しても良い。
【０１１１】また、上記の実施形態においては、特に図１１に関連して説明したように、予め定められた座標数が決められた時間以内に取得できない場合は、すべての（ＳＯＣ，ＯＣＶ）データを破棄して最初から処理をしなおす手順を説明した。しかし、古い（ＳＯＣ，ＯＣＶ）データから個別に除外して、マッチング処理に利用する複数の（ＳＯＣ，ＯＣＶ）データを、一定時間以内に取得されたものに限るようにしても良い。また、マッチング処理に利用する（ＳＯＣ，ＯＣＶ）データを選択する基準は、その（ＳＯＣ，ＯＣＶ）データが 10取得された時刻に限らない。例えば、蓄電池部間充放電において、移動させる電荷の電気量の積算量が予め定められた電気量を超えた場合には、古い（ＳＯＣ，ＯＣＶ）データから順に除外しても良い。この場合、次の積算量は、２番目に古い（ＳＯＣ，ＯＣＶ）データを取得した時点からの積算量に更新する。なお、基準とする電気量は、走行距離、環境温度、ＳＯＣ−ＯＣＶカーブに要求される精度等に応じて変更しても良い。
【０１１２】なお、輸送機器は、電動自動車に限られない。輸送機器は、電源装置および内燃機関を備えるハイブリッド自動車、電車などの車両であってよい。輸送機器は、車両に限られず、電源装置を備える航空機や船舶など、陸上、空中、水上又は水中を移動して物体を輸送する様々な機器を含む。輸送機器とは、電源装置を備える様々な輸送用機器を含む概念で 20ある。
【０１１３】以上、本発明を実施の形態を用いて説明したが、本発明の技術的範囲は上記実施の形態に記載の範囲には限定されない。上記実施の形態に、多様な変更または改良を加えることが可能であることが当業者に明らかである。その様な変更または改良を加えた形態も本発明の技術的範囲に含まれ得ることが、特許請求の範囲の記載から明らかである。
【０１１４】特許請求の範囲、明細書、および図面中において示した装置、システム、プログラム、および方法における動作、手順、ステップ、および段階等の各処理の実行順序は、特段「より前に」、「先立って」等と明示しておらず、また、前の処理の出力を後の処理で用い 30るのでない限り、任意の順序で実現しうることに留意すべきである。特許請求の範囲、明細書、および図面中の動作フローに関して、便宜上「まず、」、「次に、」等を用いて説明したとしても、この順で実施することが必須であることを意味するものではない。
【符号の説明】
【０１１５】１０ 輸送機器、１００ 蓄電装置、１０１ 第１蓄電モジュール、１０２ 第２蓄電モジュール、１０３ 充放電回路モジュール、１１１ 第１蓄電池、１１２ 第１電圧センサ、１１３ 第１電流センサ、１１４ 第１スイッチ、１２１ 第２蓄電池、１２２ 第２電圧センサ、１２３ 第２電流センサ、１２４ 第２スイッチ、１３０ 電池ＥＣＵ、１３１ 第１ＶＣＵ、１３２ 第２ＶＣＵ、１３３ 第３スイッチ、１４２ 第３電圧セ 40ンサ、１４１ ＰＤＵ、１５１ 充電コンバータ、１５２ 受電部、１５３ 外部電源、２３０ 制御演算部、２３１ ΔＳＯＣ算出部、２３２ 計時部、２３３ ＢＡＴＴ情報格納部、２３４ 確定ライン保持部、２３５ ＳＯＣ応答部、２９０ 記録媒体、８０６ＳＯＣ−ＯＣＶカーブ、８０７ ＳＯＣ−ＯＣＶカーブ、８０８ ＳＯＣ−ＯＣＶカーブ、８０９ ＳＯＣ−ＯＣＶカーブ、８１０ ＳＯＣ−ＯＣＶカーブ、８５１ データ、８５２ データ、８５３ データ、８５４ データ、８５４ データ、９０７ ＳＯＣ−ＯＣＶカーブ、９０８ ＳＯＣ−ＯＣＶカーブ、１０４１ データ、１０４２ データ、１０４３ データ、１０４４ データ
【要約】
【課題】蓄電部のＳＯＣとＯＣＶの相関情報を効率的に推定すること。 50(23) JP 5980457 B1 2016.8.31
【解決手段】電源装置は、第１蓄電部と、第１蓄電部と比してエネルギー密度が優れ出力密度が劣る第２蓄電部と、第１蓄電部と第２蓄電部の間の充放電を担う充放電回路と、充放電回路を制御する制御部を有する回路モジュールを含み、制御部は、第１蓄電部の充電率と開放端電圧である第１ＳＯＣと第１ＯＣＶの組合せである第１データと、第２蓄電部の充電率と開放端電圧である第２ＳＯＣと第２ＯＣＶの組合せである第２データを第１蓄電部と第２蓄電部の間の複数回の電荷移動のそれぞれの前後で取得し、基準データを含む第１データの集合から、第１蓄電部のＳＯＣとＯＣＶの相関情報である第１相関を推定する第１操作を実行し、制御部が記憶している複数の記憶済データと第２データの集合の比較に基づいて、第２蓄電部のＳＯＣとＯＣＶの相関情報である第２相関を推定する第２操作を実行する。 10
【選択図】図７
【図１】 
【図２】
【図３】(24) JP 5980457 B1 2016.8.31
【図４】 
【図６】
【図５】
【図７】 
【図８】(25) JP 5980457 B1 2016.8.31
【図９】 
【図１０】
【図１１】 
【図１２】(26) JP 5980457 B1 2016.8.31
【図１３】(27) JP 5980457 B1 2016.8.31フロントページの続き(56)参考文献 特開２０１２−２３４７００（ＪＰ，Ａ）特開２００８−２２００８０（ＪＰ，Ａ）特開２０１０−１７８４３２（ＪＰ，Ａ）特開２００５−２６９７６０（ＪＰ，Ａ）特開２００９−５４５８（ＪＰ，Ａ）国際公開第２０１１／０９００２０（ＷＯ，Ａ１）(58)調査した分野(Int.Cl.，ＤＢ名) 10Ｇ０１Ｒ ３１／３６Ｂ６０Ｒ １６／０３３Ｈ０２Ｊ ７／００Ｈ０１Ｍ １０／４４Ｈ０１Ｍ １０／４８']