['JP 5852399 B2 2016.2.3(57)
【特許請求の範囲】
【請求項１】コンピュータの処理により、バッテリの劣化予測のための処理方法であって、異なるＳＯＣと異なる温度毎に経時劣化率を記録するための変数のテーブルを用意するステップと、異なるＳＯＣと異なる温度毎に通電劣化率を記録するための変数のテーブルを用意するステップと、所定期間における、異なるＳＯＣと異なる温度毎の前記バッテリの滞在時間と、異なるＳＯＣと異なる温度毎の前記バッテリの通電量と、前記所定期間の最初の容量維持率と、前記所定期間の最後の容量維持率を含むデータを受領するステップと、 10前記所定期間の最初の容量維持率と前記所定期間の最後の容量維持率のデータに、容量維持率を劣化速度係数と時間の関数として表す前記バッテリの所与のモデルの計算式を適用することにより、劣化速度係数を計算するステップと、前記経時劣化率を記録するための変数と前記バッテリの滞在時間との積を異なるＳＯＣと異なる温度毎に加えた値と、前記通電劣化率を記録するための変数と前記バッテリの通電量との積を異なるＳＯＣと異なる温度毎に加えた値との和である線形和モデル式により与えられる劣化速度係数と、前記所与のモデルの計算式を利用して計算された前記劣化速度係数との差を減少させるようにＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定して前記テーブルのデータを保存するステップを有し、前記経時劣化率の配列と、前記通電劣化率の配列が、後にバッテリの劣化予測に使用さ 20(2) JP 5852399 B2 2016.2.3れるようにする、バッテリの劣化予測のための処理方法。
【請求項２】前記バッテリがリチウム・イオン・バッテリであり、前記劣化速度係数を計算する計算式がルート則モデルに基づく、請求項１に記載の方法。
【請求項３】前記ＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定するステップが、ソルバによって解かれる、請求項１に記載の方法。
【請求項４】請求項１の方法で作成された前記テーブルのデータを読み込むステップと、 10将来の劣化環境のデータを読み込むステップと、前記テーブルのデータと、前記将来の劣化環境のデータを使用して、前記線形和モデル式により、容量維持率劣化量を計算するステップと、前記計算された容量維持率劣化量を前記モデルの計算式に適用することにより、劣化予測値を求めるステップを有する、バッテリの劣化予測方法。
【請求項５】コンピュータの処理により、バッテリの劣化予測のための処理プログラムであって、前記コンピュータに、異なるＳＯＣと異なる温度毎に経時劣化率を記録するための変数のテーブルを用意する 20ステップと、異なるＳＯＣと異なる温度毎に通電劣化率を記録するための変数のテーブルを用意するステップと、所定期間における、異なるＳＯＣと異なる温度毎の前記バッテリの滞在時間と、異なるＳＯＣと異なる温度毎の前記バッテリの通電量と、前記所定期間の最初の容量維持率と、前記所定期間の最後の容量維持率を含むデータを受領するステップと、前記所定期間の最初の容量維持率と前記所定期間の最後の容量維持率のデータに、容量維持率を劣化速度係数と時間の関数として表す前記バッテリの所与のモデルの計算式を適用することにより、劣化速度係数を計算するステップと、前記経時劣化率を記録するための変数と前記バッテリの滞在時間との積を異なるＳＯＣ 30と異なる温度毎に加えた値と、前記通電劣化率を記録するための変数と前記バッテリの通電量との積を異なるＳＯＣと異なる温度毎に加えた値との和である線形和モデル式により与えられる劣化速度係数と、前記所与のモデルの計算式を利用して計算された前記劣化速度係数との差を減少させるようにＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定して前記テーブルのデータを保存するステップを実行させ、前記経時劣化率の配列と、前記通電劣化率の配列が、後にバッテリの劣化予測に使用されるようにする、バッテリの劣化予測のための処理プログラム。
【請求項６】前記バッテリがリチウム・イオン・バッテリであり、前記劣化速度係数を計算する計算 40式がルート則モデルに基づく、請求項５に記載のプログラム。
【請求項７】前記ＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定するステップが、ソルバによって解かれる、請求項５に記載のプログラム。
【請求項８】請求項５のプログラムで作成された前記テーブルのデータを読み込むステップと、将来の劣化環境のデータを読み込むステップと、前記テーブルのデータと、前記将来の劣化環境のデータを使用して、前記線形和モデル式により、容量維持率劣化量を計算するステップと、前記計算された容量維持率劣化量を前記モデルの計算式に適用することにより、劣化予 50(3) JP 5852399 B2 2016.2.3測値を求めるステップを有する、バッテリの劣化予測プログラム。
【請求項９】コンピュータの処理により、バッテリの劣化予測を行うためのシステムであって、記憶手段と、前記記憶手段中に用意された異なるＳＯＣと異なる温度毎に経時劣化率を記録するための変数のテーブル及び、異なるＳＯＣと異なる温度毎に通電劣化率を記録するための変数のテーブルと、所定期間における、異なるＳＯＣと異なる温度毎の前記バッテリの滞在時間と、異なるＳＯＣと異なる温度毎の前記バッテリの通電量と、前記所定期間の最初の容量維持率と、 10前記所定期間の最後の容量維持率を含むデータを保持する手段と、前記所定期間の最初の容量維持率と前記所定期間の最後の容量維持率のデータに、容量維持率を劣化速度係数と時間の関数として表す前記バッテリの所与のモデルの計算式を適用することにより、劣化速度係数を計算する手段と、前記経時劣化率を記録するための変数と前記バッテリの滞在時間との積を異なるＳＯＣと異なる温度毎に加えた値と、前記通電劣化率を記録するための変数と前記バッテリの通電量との積を異なるＳＯＣと異なる温度毎に加えた値との和である線形和モデル式により与えられる劣化速度係数と、前記所与のモデルの計算式を利用して計算された前記劣化速度係数との差を減少させるようにＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定して前記テーブルのデータを保存する手段を実行させ、 20前記経時劣化率の配列と、前記通電劣化率の配列が、後にバッテリの劣化予測に使用されるようにする、バッテリの劣化予測のためのシステム。
【請求項１０】前記バッテリがリチウム・イオン・バッテリであり、前記劣化速度係数を計算する計算式がルート則モデルに基づく、請求項９に記載のシステム。
【請求項１１】前記ＳＯＣと温度の値毎に経時劣化率の値と通電劣化率の値を決定する手段が、ソルバによって解かれる、請求項９に記載のシステム。
【請求項１２】 30請求項９のシステムで作成された前記テーブルのデータを読み込む手段と、将来の劣化環境のデータを読み込む手段と、前記テーブルのデータと、前記将来の劣化環境のデータを使用して、前記線形和モデル式により、容量維持率劣化量を計算する手段と、前記計算された容量維持率劣化量を前記モデルの計算式に適用することにより、劣化予測値を求める手段を有する、バッテリの劣化予測システム。
【発明の詳細な説明】
【技術分野】
【０００１】 40この発明は、様々な電子機器・電動機器などに利用される二次電池の状態を推定するためのシステム、方法及びプログラムに関するものである。
【背景技術】
【０００２】近年、地球温暖化や石油資源枯渇の懸念から、低炭素社会への移行が望まれている。その活動の一環として、電力グリッドにおける二次電池を用いた電力取引、工場内での二次電池を用いたピークシフト、石油エネルギーを用いる内燃機関から電力エネルギーを用いる電気モーターへの動力システムの変化など、各産業エリアにおいて二次電池の重要性が増しつつある。
【０００３】 50(4) JP 5852399 B2 2016.2.3しかし、二次電池は、充放電を繰り返すと、次第に充電率が低下していく、という問題がある。二次電池の性能低下は、二次電池を駆動源として使用する自動車において、航続距離の低下やその他の走行機能につながり、安全上の問題になる。このため、従来技術において、二次電池の状態を推定するさまざまな技術が提案されている。
【０００４】特開平９−２１５２０７号公報は、放電／充電サイクルを有するバッテリを監視するシステムにおいて、ニューラルネットワークを用いて、予め設定されたバッテリ放電電圧のしきい値に到達する瞬時に関する予測情報を提供する技術を開示する。
【０００５】特開平１１−３２４４２号公報は、モータなどの負荷と蓄電池の充放電電圧と電流をデ 10ジタル処理可能とするために、電圧と電流をＡ／Ｄ変換器５とＡ／Ｄ変換器６でデジタル信号に変換し、さらに、電圧の周波数変換器と電流の周波数変換器で電流と電圧を複素スペクトルに変換し、求めた蓄電池使用時の電圧Ｖと電流Ｉの複素スペクトルから、インピーダンスをインピーダンス計算部で計算し、動作中の蓄電池からインピーダンスの特徴量である半径ｒｊを求め、この半径ｒjと、予め求めて電池残容量計算部に記憶しておいた半径ｒiとを比較し、相互の関係から蓄電池残容量を推定する技術を開示する。
【０００６】特開２００２−３１９４３８号公報は、バッテリーパックを組み込んだ車両のハイブリッド伝導機構等を首尾良く作動させて、バッテリー充電状態を正確且つ再現性良く推定するために、バッテリーの状態を記述する状態ベクトルを生成し、状態ベクトルの応答を予 20測し、バッテリーの応答を測定し、バッテリーの状態を決定するため、予測された応答及び測定された応答の間の差異に基づいて状態ベクトルを修正する技術を開示する。
【０００７】特開２０１１−３８８５７号公報は、バッテリの完全な充放電を行うことなく短時間で精度よく容量維持率の判定を行うことが可能な容量維持率判定装置に関し、容量維持率判定装置が、インピーダンス測定部および容量推定部を含み、信号発生部からバッテリに交流信号が与えられ、交流信号に対するバッテリからの応答信号に基づいてインピーダンス測定部により交流インピーダンスの周波数特性が算出され、算出された周波数特性から特徴周波数が決定され、容量推定部はメモリおよび判定部を備えており、メモリにはバッテリの温度と特徴周波数と容量維持率との関係が記憶されており、判定部は、温度検出部に 30より検出されるバッテリの温度、決定された特徴周波数、メモリに記憶された関係に基づいてバッテリ１０の容量維持率を判定する技術を開示する。
【０００８】上記従来技術は、動作中のバッテリのインピーダンスの特徴量、バッテリからの応答信号に基づいて測定された交流インピーダンスの周波数特性、バッテリの温度などに基づいてバッテリの性能を推定する技術は開示するが、電池内部状態を考慮したバッテリの性能推定技術でなく、バッテリの利用履歴も考慮したものでないため、バッテリの劣化予測としては、正確性に欠けるという問題があった。
【０００９】ところで、スマートグリッド、工場、電気自動車などの実運用下では、電池は様々な使 40われ方をする。そのような全ての使用パターンに対して事前に劣化試験を行うことは不可能なため、限られた劣化試験結果を組み合わせて、多様な使われ方をする電池の劣化を予測しなくてはならない。
【００１０】そのために、多くの場合、実運用下で電池の状態（容量維持率・温度・導電量）をモニタリングする必要がある。
【００１１】一方特に、リチウムイオン電池などで、劣化のモデルとしてルート則モデルが知られている。しかし、従来のルート則の使い方は、保証という観点から、事前に保証しよう条件内で電池にとって最も過酷な劣化環境で一定期間の間、電池劣化試験を行い、この結果を 50(5) JP 5852399 B2 2016.2.3ルート則でノイズ除去、外挿するなどの使い方がメインであった。
【００１２】しかし、従来の技法は、様々な劣化環境に対して予測可能ではないし、様々な劣化環境での使用履歴を用いて、モデルをアップデートすることが困難であった。
【先行技術文献】
【特許文献】
【００１３】
【特許文献１】特開平９−２１５２０７号公報
【特許文献２】特開平１１−３２４４２号公報
【特許文献３】特開２００２−３１９４３８号公報 10
【特許文献４】特開２０１１−３８８５７号公報
【発明の概要】
【発明が解決しようとする課題】
【００１４】従って、この発明の目的は、様々な劣化環境に対して予測可能であり、さらに様々な劣化環境での使用履歴を用いて、モデルをアップデートすることが可能であるようなバッテリの状態予測技法を提供することにある。
【００１５】この発明の他の目的は、市場に出回っている大量の電気自動車から収集した実走行下での電池履歴データを用いて、モデルをアップデートし精緻化可能なバッテリの状態予測技 20法を提供することにある。
【課題を解決するための手段】
【００１６】本発明の基本的な着想は、バッテリの経時部分と通電部分を分けてモデル化することである。すなわち、各温度・ＳＯＣの滞在頻度（滞在時の通電量）の線形和で容量維持率劣化量が決まるというモデルである。各温度・ＳＯＣでの劣化成分に分解しておくことで、様々な劣化環境下で劣化予測ができる。
【００１７】この目的のため、本発明によれば、Tを温度、SをＳＯＣとして、放電係数h (T,S)、通a電係数a (T,S)のテーブルが用意される。 30c
【００１８】一方、バッテリの別のモデルにおいて、容量維持率yは、y = f(z,t)と記述される。ここでzは劣化速度係数、tは時間である。特に、リチウム・イオン電池においては、下記の式のルート則モデルであらわされることが知られている。
【数１】この式を時間tで微分して変形すると、', "z = 2y'(y-1)になる。ここでyは特に、時刻tの容量維持率と時刻t+1の容量維持率の平均", "であり、y'はyの時間微分であり、時刻t〜時刻t+1の間の劣化速度である。時刻t〜時刻t+ 40", '1の間隔は、好適には１週間である。
【００１９】本発明のモデルによれば、一方で、劣化速度係数のモデルの式は次のように与えられる。
【数２】ここで、Vh(T,S)は、時刻t〜時刻t+1の間にT,Sに滞在した時間、', "Vc(T,S)は、時刻t〜時刻t+1の間にT,Sに滞在中に通電した通電量である。y、y'、Vh(T, 50"],['(6) JP 5852399 B2 2016.2.3S)、Vc(T,S)は、予め測定されたものであり、学習データとして与えられる。
【００２０】このモデルの式を用いた目的関数
【数３】を、a (T,S) ≦ a (T+1,S)h ha (T,S) ≦ a (T+1,S) 10c ca (T,S) ≦ a (T,S+1)h hという制約の下で解く。これは、線形制約付き２次計画問題なので、既存のソルバで解くことができる。
【００２１】このようにしてa (T,S)、a (T,S)が求まると、個別の環境でVh(T,S),Vc(T,S)を与えるh cことで、ルート則モデルの式を利用するなどして、容量維持率の予測値を計算することができる。
【００２２】本発明の他の側面によれば、サンプル数が少ない場合に、平滑化パラメータλと、a (Th,S)、a (T,S)の隣接する要素の値を考慮した、上記目的関数に追加の項を付与した目的関 20c数を解くことによって、調整された精度で、a (T,S)、a (T,S)が求められる。h c
【発明の効果】
【００２３】以上のように、この発明によれば、様々な劣化環境において、様々な劣化環境での使用履歴を用いてモデルをアップデートすることができる、バッテリの劣化予測技法が提供される。
【図面の簡単な説明】
【００２４】
【図１】本発明を実施するためのシナリオの一例を実施するための構成を示す概要図である。 30
【図２】本発明を実施するためのシナリオにおけるサーバのハードウェアのブロック図である。
【図３】本発明を実施するためのサーバの機能ブロック図である。
【図４】放置係数テーブルを示す図である。
【図５】通電係数テーブルを示す図である。
【図６】放置係数テーブルと通電係数テーブルを計算する処理のフローチャートを示す図である。
【図７】バッテリの劣化の予測を計算する処理のフローチャートを示す図である。
【図８】自動車におけるバッテリとそのＥＣＵの構成を示すブロック図である。
【図９】本発明に関連して、バッテリ関連のＥＣＵで実行される機能のブロック図である 40。
【発明を実施するための形態】
【００２５】以下、図面を参照して、本発明の実施例を説明する。特に断わらない限り、同一の参照番号は、図面を通して、同一の対象を指すものとする。また、以下で説明するのは、本発明の一実施形態であり、この発明を、この実施例で説明する内容に限定する意図はないことに留意されたい。
【００２６】図１は、本発明を実施するための一例の全体構成を示す概要図である。サーバ１０２は、パケット通信網１０４を介して複数の自動車１０６及び１０８等から情報を収集する、 50(7) JP 5852399 B2 2016.2.3いわゆるプローブカー通信システムを構成する。図１では例示的に２台しか示されていていないが、実際は多数の自動車がプローブカーの役目を果たす。ここで自動車１０６及び１０８は、駆動用の２次電池であるバッテリを搭載する電気自動車（ＥＶ）または、ハイブリッドカー（ＨＥＶ）であるとする。プローブカー通信システムは、これには限定されないが、例えば特開２００５−４３５９号公報に開示されている技術を利用して構築される。
【００２７】サーバ１０２はまた、インターネット１１０を介して、カーディーラのオフィスにあるクライアント・コンピュータ１１４に接続されている。
【００２８】 10サーバ１０２には、本発明に従い構成されたバッテリ劣化予測システムが搭載されている。このバッテリ劣化予測システムの詳細は、後述する。
【００２９】図１に示す構成の例示的なシナリオは次のとおりである。(1) プローブカーである自動車１０６及び１０８等からサーバ１０２に、バッテリの劣化環境（容量維持率、ＳＯＣ、温度、負荷）のデータを送信する。(2) サーバ１０２は、プローブカーから収集した、特定のバッテリに関する劣化環境のデータが所定の数に達した段階で、当該バッテリに関する放置係数のテーブルと通電係数のテーブルの値を計算し、ハードディスクなどの不揮発記憶装置に保存する。(3) サーバ１０２は、当該バッテリに関する放置係数のテーブルと通電係数のテーブル 20の値を利用して、プローブカーに、バッテリ寿命推定結果や、推奨の運転・充電スケジュールを計算して、送信する。(4) 一方サーバ１０２は、プローブカーのディーラのオフィス１１２に設置されているクライアント・コンピュータ１１４に、プローブカーのバッテリの寿命推定結果を送信する。ディーラーは、各車両の寿命予測結果を参考にして、バッテリ交換時期をスケジュールし、車両の所有者に通知するなどして、適切なアフターサービスを行う。
【００３０】次に図２のブロック図を参照して、サーバ１０２のハードウェア構成を説明する。図２において、システム・パス２０２には、ＣＰＵ２０４と、主記憶（ＲＡＭ）２０６と、ハードディスク・ドライブ（ＨＤＤ）２０８と、キーボード２１０と、マウス２１２と、デ 30ィスプレイ２１４が接続されている。ＣＰＵ２０４は、好適には、３２ビットまたは６４ビットのアーキテクチャに基づくものであり、例えば、インテル社のＰｅｎｔｉｕｍ（商標） ４、Ｃｏｒｅ（商標）２ Ｄｕｏ、Ｘｅｏｎ（商標）、ＡＭＤ社のＡｔｈｌｏｎ（商標）などを使用することができる。主記憶２０６は、好適には、４ＧＢ以上の容量をもつものである。ハードディスク・ドライブ２０８は、好適には例えば、５００ＧＢ以上の容量をもつものである。
【００３１】ハードディスク・ドライブ２０８には、個々に図示しないが、オペレーティング・システムが、予め格納されている。オペレーティング・システムは、Ｌｉｎｕｘ（商標）、マイクロソフト社のＷｉｎｄｏｗｓ（商標）７、Ｗｉｎｄｏｗｓ ＸＰ（商標）、アップル 40コンピュータのＭａｃ ＯＳ（商標）などの、ＣＰＵ２０４に適合する任意のものでよい。
【００３２】ハードディスク・ドライブ２０８にはさらに、図３に関連して後述するプローブ・データ３０２、劣化試験データ３０４、係数計算ルーチン３０６、平滑化パラメータ設定ルーチン３０８、ソルバ３１０、予測ルーチン３１４、将来の劣化環境データ提供ルーチン３１６が格納されている。これらのルーチンは、Ｃ、Ｃ＋＋、Ｃ＃、Ｊａｖａ(R)などの既存のプログラミング言語処理系で作成することができ、オペレーティング・システムの働きで、これらのモジュールは適宜主記憶２０６にロードされて実行される。これらのモジュールの動作の詳細は、図３の機能ブロック図を参照して、後で詳細に説明する。 50(8) JP 5852399 B2 2016.2.3
【００３３】キーボード２１０及びマウス２１２は、例えば平滑化パラメータ設定ルーチン３０８のために、所定のＧＵＩ画面（図示しない）を操作して、上述のルーチンなどを起動したり、文字や数字を打ち込んだりするために使用される。
【００３４】ディスプレイ２１４は、好適には、液晶ディスプレイであり、例えば、ＸＧＡ（１０２４×７６８の解像度）、またはＵＸＧＡ（１６００×１２００の解像度）などの任意の解像度のものを使用することができる。ディスプレイ２１４は、生成された結果の予測データを表示するために使用される。
【００３５】 10図２のシステムは更に、バス２０２に接続された通信インターフェース２１６を介して、ＬＡＮ、ＷＡＮなどの外部ネットワークに接続されている。通信インターフェース２１６は、イーサネット（商標）などの仕組みにより、外部ネットワーク上にあるサーバ、クライアント・コンピュータ、プローブ・カーなどのシステムとデータのやりとりを行う。
【００３６】次に図３のブロック図を参照して、本発明の処理を実行するための機能構成について説明する。プローブ・データ３０２は、通信インターフェース２１６とネットワークを介してプローブ・カーから収集したデータを含むハードディスク・ドライブ２０８に保存されたファイルであり、バッテリの容量維持率、温度とＳＯＣ毎の滞在時間、温度のＳＯＣ毎の通電量などの計測データを、バッテリの種類毎に保存する。尚、プローブ・カーにおい 20て、容量維持率は例えば、特開２０１１−３８８５７号公報に記載されている技術などを使用して測定することができる。ＳＯＣは例えば、特開２００５−３７２３０号公報、特開２００５−８３９７０号公報に記載されている技術などを使用して測定することができる。
【００３７】劣化試験データ３０４は、プローブカーから収集したデータとは別に、事前に別途バッテリについて性能劣化試験を行い計測したデータ含むハードディスク・ドライブ２０８に保存されたファイルであり、プローブ・データ３０２と同一の形式のデータを含む。
【００３８】係数計算ルーチン３０６は、プローブ・データ３０２または劣化試験データ３０４も適 30宜使用することにより、温度とＳＯＣ毎の放置係数のテーブルa (T,S)と、通電係数のテhーブルa (T,S)の値を計算する機能をもつ。特にこの実施例では、ユーザーの操作によりc平滑化パラメータλを設定するためのルーチン３０８を設け、係数計算ルーチン３０６に平滑化パラメータλを設定する。平滑化パラメータλは、プローブ・カーから収集されたサンプルデータの数が少ない場合に精度を保つために使用される。平滑化パラメータλは例えば、計算結果の精度に応じてユーザーが調整する。ある程度サンプルデータが集まっているときは、サンプルデータを学習データとテストデータに分け、様々なλに対して学習データでモデル構築し、テストデータで精度を求め、テストデータで最も精度が良かったλを採用するようにする。
【００３９】 40なお、サンプルデータの数が十分あるときは、λ = 0としても十分な精度が得られる。
【００４０】係数計算ルーチン３０６は、プローブ・データ３０２または劣化試験データ３０４と、平滑化パラメータλを用いて目的関数と制約条件を設定して、ソルバ３１０で計算させることにより、温度とＳＯＣ毎の放置係数のテーブルa (T,S)と通電係数のテーブルa (T,S)h cの要素の値を計算する。ソルバ３１０は、これには限定されないが、例えばIBM(R) ILOG(R) CPLEXを使用することができる。ソルバ３１０による計算処理の詳細は後で説明する。
【００４１】図４と図５はそれぞれ、テーブルa (T,S)とテーブルa (T,S)の温度とＳＯＣ毎の要素をh c示す。係数計算ルーチン３０６による計算の結果、各要素に数値が埋まる。こうして計算 50(9) JP 5852399 B2 2016.2.3された放置係数のテーブルa (T,S)と通電係数のテーブルa (T,S)は、係数テーブル３１２h cとして好適にはハードディスク・ドライブ２０８に保存される。
【００４２】予測ルーチン３１４は、係数計算ルーチン３０６によって計算された係数テーブル３１２の値と、将来の劣化環境データ３１６を用いて、容量維持率の予測値を計算する。予測ルーチン３１４による計算処理の詳細は後で説明する。
【００４３】なお、係数テーブル３１２のデータと、予測ルーチン３１４によって計算された予測値は、必要に応じて通信インターフェース２１６及びネットワークを介して、プローブ・カーあるいはカーディーラーなどに送信することができる。 10
【００４４】次に、図６のフローチャートを参照して、係数計算ルーチン３０６の処理について説明する。図６において、ステップ６０２において、係数計算ルーチン３０６は、λ設定ルーチン３０８から、平滑化パラメータλを入力として受け取る。
【００４５】ステップ６０４において、係数計算ルーチン３０６は、劣化試験データ３０４またはプローブ・データ３０２から、N個(i=1,..,N)のVh (T,S)、Vc (T,S)、ystart ,yend を入力i i i iとして受け取る。ここで、Vh (T,S)は、i番目の、ある一週間の温度、ＳＯＣ毎の滞在時間、iVc (T,S)は、i番目の、ある一週間の温度、ＳＯＣ毎の通電量、 20iystart は、i番目の、ある一週間の最初の容量維持率、iyend は、i番目の、ある一週間の最後の容量維持率である。i尚ここで、一週間は、一例の期間であって、目的応じて、一日、一ヶ月、など様々な期間が使用される。
【００４６】ステップ６０６からステップ６１０までは、i = 1からNまでのループである。ステップ６０８で係数計算ルーチン３０６は、下記の計算を行う。yave = (ystart + yend )/2i i id = yend - ystarti i iz = 2*d *(yave - 1) 30i i i
【００４７】こうしてステップ６０８の処理が、i = 1からNまで完了すると、z (i=1,..,N)が揃う。iそこでステップ６１２では係数計算ルーチン３０６は、z (i=1,..,N)を横に並べてN次元iベクトルzを作る。また、Vh (T,S)、Vc (T,S)を横に並べて、400次元のベクトルを作る。より具体的にはi i次のように行う。すなわち、この実施例では、Tは20個の成分をもち、Sは10個の成分をもつので、Vh (T,S)自体は200次元である。そこで、Sが0から9まで動き、Tが0から19まで動iくとして、添字をjとして、Vh (T,S)については、j = S*20 + TiVc (T,S)については、j = 200 + S*20 + Tとする。 40iこのようにして、添字j = 0,...,399について、Vh (T,S)とVc (T,S)を並べて、i番目のi i400次元のベクトルが作られる。そしてこのようなベクトルをi = 1からNまで順に縦に並べると、縦Nで横400のサイズの行列が生成される。この行列をWと呼ぶことにする。
【００４８】尚、Tを20個に区分することと、Sを10個に区分することは一例であり、区分の幅及び区分の間隔は目的に応じて様々な値を使用することができる。
【００４９】ステップ６１２では係数計算ルーチン３０６は、縦Nで横400の近傍行列Dを次のようにして作る。 50(10) JP 5852399 B2 2016.2.3すなわち、Dの非対角成分d は、上記の添え字の変換規則により、pとqのそれぞれをap,q(T,S)あるいはa (T,S)の位置に対応させ、それらが隣り合っているときDの非対角成分dh c pに-1を入れ、そうでないとき0を入れる。Dの対角成分d は、p行の-1の数を入れる。,q p,p
【００５０】p,qに関する添え字の変換規則について補足すると、0 ≦ p ≦ 199なら、a (T,S)に対h応してpを20で割った商がS、pを20で割った余りがTであり、200 ≦ p ≦ 399なら、a (T,cS)に対応して(p-200)を20で割った商がS、(p-200)を20で割った余りがTとなる。
【００５１】ステップ６１２では係数計算ルーチン３０６は、要素が実数である、400次元のベクトルuを用意して、ソルバ３１０を呼び出して、下記の式を解く。下記の式で、Wuが、経時 10劣化成分と通電劣化成分の線形和で表される、本発明に従う容量維持率劣化量をあらわす項である。
【数４】20ここで、制約条件は、上記で説明した添字の変換規則に従い、ソルバ３１０に入力される。
【００５２】そして、この結果得られた400次元のベクトルuの成分u[j]について、0 ≦ j ≦ 199の場合、jを20で割った商がS、pを20で割った余りがTであるとするとa (T,S) = u[j]、200h≦ j ≦ 399の場合、(j-200)を20で割った商がS、(j-200)を20で割った余りがTであるとするとa (T,S) = u[j]とする。c
【００５３】 30この結果、係数計算ルーチン３０６は、係数テーブル３１２としてa (T,S)とa (T,S)をh cハードディスク・ドライブ２０８に書き出す。実際上、使用された劣化試験データ３０４またはプローブ・データ３０２は、特定のバッテリのタイプに対応するものであるので、係数テーブル３１２は、バッテリのタイプ毎にa (T,S)とa (T,S)を保存する。h c
【００５４】次に、図７のフローチャートを参照して、予測ルーチン３１４の処理について説明する。
【００５５】ステップ７０２で予測ルーチン３１４は、係数テーブル３１２から、使用されているバッテリのタイプに対応するモデルパラメータa (T,S)、a (T,S)を入力として受け取る。 40h c
【００５６】予測ルーチン３１４は次に、ステップ７０４で、将来のN個分(t = 1,..,N)の劣化環境Vh (T,S)、Vc (T,S)、現在の容量維持率yを入力として受け取る。将来のN個分(t = 1,..,Nt t)の劣化環境Vh (T,S)、Vc (T,S)は、将来の劣化環境データ３１６から受け取る。将来のt t劣化環境データ３１６は、将来の運転計画や運転習慣などから、予め決定される。例えば、通勤に自動車を使うなら、月曜日から金曜日までの通勤距離や、土日の使用プランなどに基づき、将来の劣化環境の時系列を決定することができる。一方、現在の容量維持率yは、例えば、プローブ・データ３０２から受け取る。
【００５７】ステップ７０６からステップ７１４まではt=1,..Nのループである。このループ内で使 50(11) JP 5852399 B2 2016.2.3用される計算式を下記のとおり示す。
【数５】
【００５８】予測ルーチン３１４はステップ７０８で、上記式(1)を用いてVh (T,S)、Vc (T,S)から 10t t、
【数６】を計算する。
【００５９】ステップ７１０では、予測ルーチン３１４は、
【数７】20が0なら、d = 0とする。一方、t
【数８】が0より大きければ、式（２）を、d を変数とする２次方程式として解く。t
【数９】30がゼロより大きいことから、式（２）から２つの実数解が得られ、この一方は正、他方は負になるので、正しい実数解をd として採用する。t
【００６０】ステップ７１２では、予測ルーチン３１４は、y ← y + d によりyを更新する。t
【００６１】ステップ７０６からステップ７１４まででt=1,..Nのループを完了すると、予測ルーチン３１４は、ステップ７１６で、yを予測値として出力して終わる。
【００６２】 40上記実施例では、放置係数のテーブルと放電係数のテーブル作成のための計算と、放置係数のテーブルと放電係数のテーブルを使用した予測計算をサーバ側で行うようにしているが、少なくとも予測計算を、自動車側で行うようにすることができる。以下、その実施例を説明する。
【００６３】図８は、この実施するためのハードウェア構成のブロック図である。特に図８は、車載システムにおいて、本発明に関連がある箇所のみを図示していることに留意されたい。
【００６４】図８に示されているのは、バッテリ用ＥＣＵ８１０と、バッテリ８３０と、ＣＡＮ(control area network)などの車載ネットワーク８５０である。 50(12) JP 5852399 B2 2016.2.3
【００６５】バッテリ用ＥＣＵ８１０は、ＣＰＵをもつ演算部８１２と、ＲＡＭ、ＲＯＭ及びフラッシュ・メモリなどの不揮発性メモリをもつメモリ８１４と、車載ネットワーク８５０との間でデータフレームなどの情報をやりとりする通信部８１６と、バッテリ８３０の状態をセンシングするセンサ機能部８１８を有する。
【００６６】メモリ８１４における不揮発性メモリには、後述する係数テーブル９０２、予測モジュール９０４、及び将来の劣化環境データ９０６などが保存されている。
【００６７】バッテリ８３０は、好適には、電気自動車やハイブリッドカーに使用可能な２次電池で 10ある。
【００６８】センサ機能部８１８は、バッテリ８３０の電圧、電流、温度、絶縁抵抗などをそれぞれ測定するための素子をもつ。演算部８１２は、後述する予測ルーチン９０４を実行する機能をもつ。
【００６９】メモリ８１４は、ＥＣＵ８１０全体の動作を制御する、オペレーティング・システムに相当するプログラムを含む。
【００７０】次に、図９の機能ブロック図を参照して、この実施例の処理機能について説明する。図 20９において、係数テーブル９０２は、図３の係数テーブル３１２と同様の形式のものであり、予測ルーチン９０４は、図３の予測ルーチン３１４と同様の機能を有するものであり、将来の劣化環境データ９０６は、図３の将来の劣化環境データ３１６と同様の形式のものであるので、詳細な説明は省略する。
【００７１】図９の機能ブロック図では、係数テーブル９０２は、電気自動車のＥＣＵで計算して求めるのではなく、図２及び図３に関連して説明したようなサーバで計算して求め、ネットワークと通信部８１６を介して電気自動車に送信してセットされる。このようにするのは、係数テーブル９０２は既存の自動車のＥＣＵの演算能力では、典型的にはソルバを駆使する係数テーブル９０２の計算が重過ぎるからである。しかし、ＥＣＵの演算能力が十分 30高いなら、係数テーブル９０２を自動車でローカルに計算して求めることも可能である。
【００７２】また、係数テーブル９０２のデータは、通信機能でサーバから受けとるのではなく、自動車の製造時に書き込まれ、定期点線などのメンテナンス時にサービス担当者が、多くのプローブ・データに従い更新された係数テーブルの値に書き換えてもよい。
【００７３】また、上記実施例では、特にリチウムイオン電池によく適合するルート則を想定して計算する例で説明してきたが、より一般に、y = f(z,t)で、fがtについての単調減少関数となるような劣化モデルで、z = g(y,t)のように変形して、ソルバによる最適化計算に持ち込むことができる。 40
【００７４】本発明は、上記特定の実施例に限定されず、２次電池の様々な種類や、システム構成の変形例に対応可能である。すなわち、鉛蓄電池、ニッケルカドミウム電池、ニッケル水素電池、ナトリウム硫黄電池、リチウム硫黄電池、リチウム空気電池、リチウム銅２次電池など、適切な劣化モデルの存在で適用可能であり、また、自動車用のバッテリに限定されず、スマートグリッドや、パソコン、ハンディ掃除機など、２次電池が内蔵された各種家電製品にも適用可能であることを、この分野の当業者なら理解するであろう。
【符号の説明】
【００７５】１０２・・・サーバ 50(13) JP 5852399 B2 2016.2.3３０２・・・プローブ・データ３０６・・・係数計算ルーチン３１０・・・ソルバ３１２・・・係数テーブル３１４・・・予測ルーチン
【図１】 
【図２】(14) JP 5852399 B2 2016.2.3
【図３】 
【図４】
【図５】 
【図６】(15) JP 5852399 B2 2016.2.3
【図７】 
【図８】
【図９】(16) JP 5852399 B2 2016.2.3フロントページの続き(74)代理人 100112690弁理士 太佐 種一(74)代理人 100091568弁理士 市位 嘉宏(72)発明者 ▲高▼橋 俊博神奈川県大和市下鶴間１６２３番地１４ 日本アイ・ビー・エム株式会社 東京基礎研究所内(72)発明者 天野 正己東京都中央区日本橋箱崎町１９番地２１ 日本アイ・ビー・エム株式会社内 10(72)発明者 恐神 貴行神奈川県大和市下鶴間１６２３番地１４ 日本アイ・ビー・エム株式会社 東京基礎研究所内(72)発明者 井手 剛神奈川県大和市下鶴間１６２３番地１４ 日本アイ・ビー・エム株式会社 東京基礎研究所内審査官 馬場 慎(56)参考文献 特開２００５−９３２４０（ＪＰ，Ａ）特開２０００−２２８２２７（ＪＰ，Ａ）特開２００８−２４１２４６（ＪＰ，Ａ） 20特開２０１３−４４５９８（ＪＰ，Ａ）(58)調査した分野(Int.Cl.，ＤＢ名)Ｈ０１Ｍ １０／４２ − １０／４８Ｇ０１Ｒ ３１／３６']